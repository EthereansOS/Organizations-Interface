"use strict";function _typeof(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(t){return typeof t}:_typeof=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){function o(e,t){try{var n=s[e](t),o=n.value}catch(f){i(f);return}n.done?r(o):Promise.resolve(o).then(u,a)}function u(e){o("next",e)}function a(e){o("throw",e)}var s=e.apply(t,n);u()})}}window.exports=window.exports||{};!window.preloadedScripts && (window.preloadedScripts=[]);Array.prototype.push.apply(window.preloadedScripts,['spa/asyncValue.jsx','spa/bigLoader.jsx','spa/dapp/controller.jsx','spa/dapp/style.min.css','spa/dapp/view.jsx','spa/defi/controller.jsx','spa/defi/style.min.css','spa/defi/view.jsx','spa/deploy/controller.jsx','spa/deploy/deployDFO.jsx','spa/deploy/deployDFOMetadata.jsx','spa/deploy/governanceRulesData.jsx','spa/deploy/style.min.css','spa/deploy/subdomain.jsx','spa/deploy/view.jsx','spa/deploy/votingTokenData.jsx','spa/dFOElement/controller.jsx','spa/dFOElement/style.min.css','spa/dFOElement/view.jsx','spa/dFOList/controller.jsx','spa/dFOList/style.min.css','spa/dFOList/view.jsx','spa/dFOMetadata/controller.jsx','spa/dFOMetadata/edit.jsx','spa/dFOMetadata/style.min.css','spa/dFOMetadata/view.jsx','spa/drafts/controller.jsx','spa/drafts/style.min.css','spa/drafts/view.jsx','spa/editor/controller.jsx','spa/editor/style.min.css','spa/editor/view.jsx','spa/farming/controller.jsx','spa/farming/fixedInflation/edit.jsx','spa/farming/fixedInflation/view.jsx','spa/farming/fixedInflation/viewWrapped.jsx','spa/farming/staking/edit.jsx','spa/farming/staking/edit_old.jsx','spa/farming/staking/view.jsx','spa/farming/style.min.css','spa/farming/view.jsx','spa/functions/controller.jsx','spa/functions/style.min.css','spa/functions/view.jsx','spa/ghostLoader.jsx','spa/globalCatcher.jsx','spa/governance/controller.jsx','spa/governance/style.min.css','spa/governance/view.jsx','spa/imported/farm/Create.jsx','spa/imported/farm/CreateOrEditFarmingSetup.jsx','spa/imported/farm/CreateOrEditFarmingSetups.jsx','spa/imported/farm/Explore.jsx','spa/imported/farm/ExploreFarmingContract.jsx','spa/imported/farm/FarmingComponent.jsx','spa/imported/farm/Hosted.jsx','spa/imported/farm/LockedPositionComponent.jsx','spa/imported/farm/Positions.jsx','spa/imported/farm/SetupComponent.jsx','spa/imported/inflation/CreateOrEditFixedInflation.jsx','spa/imported/inflation/CreateOrEditFixedInflationEntry.jsx','spa/imported/inflation/CreateOrEditFixedInflationEntryOperation.jsx','spa/imported/inflation/Explore.jsx','spa/imported/inflation/ExploreInflationContract.jsx','spa/imported/inflation/FixedInflationComponent.jsx','spa/imported/ReactImporter.jsx','spa/imported/shared/ApproveButton.jsx','spa/imported/shared/Coin.jsx','spa/imported/shared/Input.jsx','spa/imported/shared/Link.jsx','spa/imported/shared/Loading.jsx','spa/imported/shared/TokenInput.jsx','spa/index/controller.jsx','spa/index/style.min.css','spa/index/view.jsx','spa/loader.jsx','spa/loaderMini.jsx','spa/loaderMinimino.jsx','spa/messages.jsx','spa/newProposal/controller.jsx','spa/newProposal/style.min.css','spa/newProposal/view.jsx','spa/noWeb3Loader.jsx','spa/okBoomer.jsx','spa/overview/controller.jsx','spa/overview/style.min.css','spa/overview/view.jsx','spa/proposal/controller.jsx','spa/proposal/style.min.css','spa/proposal/view.jsx','spa/proposals/controller.jsx','spa/proposals/style.min.css','spa/proposals/view.jsx','spa/rules/controller.jsx','spa/rules/style.min.css','spa/rules/view.jsx','spa/sequentialOps.jsx','spa/stake/controller.jsx','spa/stake/style.min.css','spa/stake/view.jsx','spa/stake_old/controller.jsx','spa/stake_old/style.min.css','spa/stake_old/view.jsx','spa/stakingInfo/controller.jsx','spa/stakingInfo/style.min.css','spa/stakingInfo/view.jsx','spa/state/controller.jsx','spa/state/style.min.css','spa/state/view.jsx','spa/token/controller.jsx','spa/token/style.min.css','spa/token/view.jsx','spa/tokenPicker/controller.jsx','spa/tokenPicker/style.min.css','spa/tokenPicker/view.jsx','spa/uniswapTokenPicker.jsx','spa/wallet/controller.jsx','spa/wallet/style.min.css','spa/wallet/view.jsx','spa/walletEnablerButton.jsx']);var AsyncValue=React.createClass({displayName:"AsyncValue",requiredScripts:["spa/loaderMinimino.jsx"],render:function(){if(!this.props.children)return React.createElement(LoaderMinimino,null);try{var t=_typeof(this.props.children).toLowerCase();if(t==="number"||t==="string")return React.createElement("span",null,this.props.children);if(this.props.children.props.children)return this.props.children;if(this.props.children.props.src)return this.props.children}catch(n){return React.createElement(LoaderMinimino,null)}return React.createElement(LoaderMinimino,null)}});var BigLoader=React.createClass({displayName:"BigLoader",getDefaultSubscriptions:function(){var t=this;return{"loader/show":function(){return t.setState({propagate:!1,transaction:0,chunks:0},function(){return t.domRoot.css("display","block")})},"loader/propagate":this.propagate,"loader/hide":this.hideLoader,"loader/transaction":this.transaction,"loader/chunks":function(n){return t.setState({propagate:!1,transaction:0,chunks:n},function(){return t.domRoot.css("display","block")})}}},getInitialState:function(){return{counter:60}},propagate:function(t,n){var r=this;t&&t.forEach(function(e){return window.AJAXRequest(e.split("ipfs://").join("//gateway.ipfs.io/"))});var i=function(){if(r.state.counter===0)return r.interval&&clearInterval(r.interval),n&&n();r.setState({counter:r.state.counter-1,chunks:0})};r.interval&&clearInterval(r.interval),r.setState({counter:60,propagate:!0,transaction:0,chunks:0},function(){r.domRoot.css("display","block"),r.interval=setInterval(i,1e3)})},hideLoader:function(){this.interval&&clearInterval(this.interval),this.domRoot.css("display","none"),this.setState({propagate:!1,transaction:0,chunks:0})},transaction:function(t,n){this.interval&&clearInterval(this.interval),this.setState({transaction:t,transactions:n,propagate:!1,chunks:0})},render:function(){return React.createElement("section",{className:"UPLOADBANNER"},this.state.chunks&&React.createElement("h1",null,"Generating ",this.state.chunks," chunks..."),!this.state.chunks&&!this.state.propagate&&!this.state.transaction&&React.createElement("h1",null,this.props.message!==undefined&&this.props.message!==null?this.props.message:"Loading..."),!this.state.chunks&&this.state.propagate&&React.createElement("h1",null,this.state.counter),!this.state.chunks&&this.state.propagate&&React.createElement("h2",null,"Waiting for Propagation"),!this.state.chunks&&this.state.transaction&&React.createElement("h2",null,"Transaction ",this.state.transaction," ",this.state.transactions>1&&React.createElement("span",null,"of ",this.state.transactions)),React.createElement("div",{"class":"loadingio-spinner-disk-bluuznaj8"},React.createElement("div",{"class":"ldio-2w6250r221a"},React.createElement("div",null,React.createElement("div",null),React.createElement("div",null)))))}});var DappController=function(t){var n=this;n.view=t};var Dapp=React.createClass({displayName:"Dapp",requiredModules:["spa/functions"],getInitialState:function(){return{section:"Functions",voices:["Functions","State"]}},onClick:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.sectionChange(t.target.innerHTML)},sectionChange:function(t,n){this.domRoot.children().find("a").each(function(e,n){((n=$(n).removeClass("selected")).html()===t||n.data("alternatives")&&n.data("alternatives").indexOf(t)!==-1)&&n.addClass("selected")});var r=t.split(" ").join(""),i=this;ReactModuleLoader.load({modules:["spa/"+r.firstLetterToLowerCase()],callback:function(){return i.setState({section:r,props:n||null})}})},render:function(){var t=this,n={};return this.props&&Object.entries(this.props).forEach(function(e){return n[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return n[e[0]]=e[1]}),n.section=n.subSection||n.section,React.createElement("section",{className:"DFOOpened"},React.createElement("ul",{className:"DFONavigator DFOSubNavigator DFONavigatorAfter"},n.voices.map(function(e){return React.createElement("li",{key:e},React.createElement("a",{href:"javascript:;",onClick:t.onClick,className:n.section===e?"selected":""},e))})),React.createElement(window[n.section],n))}});var DeFiController=function(t){var n=this;n.view=t};var DeFi=React.createClass({displayName:"DeFi",requiredModules:["spa/wallet"],getInitialState:function(){return{section:"Wallet"}},onClick:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.sectionChange(t.target.innerHTML)},sectionChange:function(t,n){this.domRoot.children().find("a").each(function(e,n){((n=$(n).removeClass("selected")).html()===t||n.data("alternatives")&&n.data("alternatives").indexOf(t)!==-1)&&n.addClass("selected")});var r=t.split(" ").join(""),i=this;ReactModuleLoader.load({modules:["spa/"+r.firstLetterToLowerCase()],callback:function(){return i.setState({section:r,props:n||null})}})},render:function(){var t={};return this.props&&Object.entries(this.props).forEach(function(e){return t[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return t[e[0]]=e[1]}),t.section=t.subSection||t.section,React.createElement("section",{className:"DFOOpened"},React.createElement("ul",{className:"DFONavigator DFOSubNavigator DFONavigatorAfter"},React.createElement("li",null,React.createElement("a",{href:"javascript:;",onClick:this.onClick,className:"selected"},"Wallet")),React.createElement("li",null,React.createElement("a",{href:"javascript:;",onClick:this.onClick},"Token")),React.createElement("li",null,React.createElement("a",{href:"javascript:;",onClick:this.onClick},"Farming"))),React.createElement(window[t.section],t))}});var DeployController=function(t){var n=this;n.view=t,n.retrieveCurrentStepData=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0),n.view.emit("message"),s.prev=2,i=n.view.currentElement.getData&&n.view.currentElement.getData()||{},s.t0=i.then;if(!s.t0){s.next=9;break}return s.next=8,i;case 8:i=s.sent;case 9:return s.abrupt("return",n.view.data[n.view.state.step]=i||{});case 12:s.prev=12,s.t1=s["catch"](2);if(!t){s.next=16;break}return s.abrupt("return");case 16:n.view.emit("message",s.t1,"error");case 17:case"end":return s.stop()}},r,this,[[2,12]])}));return t}(),n.getData=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.retrieveCurrentStepData(e,t);case 2:if(s.sent){s.next=4;break}return s.abrupt("return");case 4:return i={},n.view.data.map(function(e){return e&&Object.keys(e).map(function(t){return i[t]=e[t]})}),s.abrupt("return",i);case 7:case"end":return s.stop()}},r,this)}));return t}(),n.next=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.getData(e);case 2:t=i.sent;if(n.view.state.step!==n.view.steps.length&&!!t){i.next=5;break}return i.abrupt("return");case 5:n.view.setState({allData:t,step:++n.view.state.step});case 6:case"end":return i.stop()}},r,this)}));return t}(),n.back=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.view.state.step!==0){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,n.retrieveCurrentStepData(e,!0);case 4:n.view.setState({step:--n.view.state.step});case 5:case"end":return r.stop()}},r,this)}));return t}()};var DeployDFO=React.createClass({displayName:"DeployDFO",requiredScripts:["spa/sequentialOps.jsx"],render:function(){var t=this,n=this;return React.createElement("span",null,React.createElement(SequentialOps,{ref:function(n){return t.sequentialOps=n},initialContext:n.props.allData,auto:"true"},[{name:"Data Integrity Validation",call:function(t){return new Promise(function(e,r){var i=[];!t.tokenName&&i.push("Insert a valid Token Name"),!t.tokenSymbol&&i.push("Insert a valid Token Symbol"),(isNaN(t.tokenTotalSupply)||t.tokenTotalSupply<=0)&&i.push("Token Total Supply must be greater than 0"),!t.ensDomain&&i.push("ENS Domain is mandatory"),(isNaN(t.surveyLength)||t.surveyLength<=0)&&i.push("Survey Length must be a number greater than 0"),(isNaN(t.emergencySurveyLength)||t.emergencySurveyLength<=0)&&i.push("Emergency Survey Length must be a number greater than 0");var s=parseFloat(window.fromDecimals(t.availableSupply,18).split(",").join("")),o=function(t,r,i,s,o,u){if(!t[s+"Check"]&&!u)return;var a=parseFloat(t[s].split(",").join("")),f=u?a<0:a<=0;(isNaN(a)||f||a>r)&&i.push((o||n[s+"Label"].innerHTML.split(":").join(""))+" must be a valid, positive number "+(u?"between 0 and":"less than")+" "+window.formatMoney(r))};return o(t,s,i,"emergencySurveyStaking","Penalty Fee",!0),o(t,s,i,"surveyQuorum","Survey Quorum"),o(t,s,i,"surveyMaxCap","Max Cap"),o(t,s,i,"surveyMinStake","Min Staking"),o(t,s,i,"surveyCommunityStake","DFO Locked Supply"),o(t,s,i,"surveySingleReward","Activity Reward"),i.length>0?r(i):e()})}},{name:"Deploy Voting Token | "+n.props.allData.tokenTotalSupply+" "+n.props.allData.tokenSymbol,call:function(t){var n=window.web3.eth.abi.encodeParameters(["address","uint256","string","string","uint256","uint256"],[window.voidEthereumAddress,0,t.tokenName,t.tokenSymbol,t.tokenTotalSupply,t.surveyCommunityStake?window.toDecimals(t.surveyCommunityStake,18):0]);return window.blockchainCall(window.dfoHub.dFO.methods.submit,"deployVotingToken",n).then(function(e){e=window.formatDFOLogs(e.events.Event,"DFOCollateralContractsCloned(address_indexed,address,address,address)").raw.data,t.votingToken=e[0],t.stateHolder=e[1],t.functionaltyModelsManagerAddress=e[2]})},onTransaction:function(t,n){return new Promise(function(e){var r=window.formatDFOLogs(n.logs,"DFOCollateralContractsCloned(address_indexed,address,address,address)")[0].data;t.votingToken=r[0],t.stateHolder=r[1],t.functionaltyModelsManagerAddress=r[2],e()})}},{name:"Deploy Proposals Manager",call:function(t){var n=window.web3.eth.abi.encodeParameters(["address","uint256"],[window.voidEthereumAddress,0]);return window.blockchainCall(window.dfoHub.dFO.methods.submit,"deployProposalsManager",n).then(function(e){e=window.formatDFOLogs(e.events.Event,"DFOCollateralContractsCloned(address_indexed,address,address,address)").raw.data,t.mvdFunctionalityProposalManagerAddress=e[0],t.mvdWalletAddress=e[1],t.doubleProxyAddress=e[2]})},onTransaction:function(t,n){return new Promise(function(e){var r=window.formatDFOLogs(n.logs,"DFOCollateralContractsCloned(address_indexed,address,address,address)")[0].data;t.mvdFunctionalityProposalManagerAddress=r[0],t.mvdWalletAddress=r[1],t.doubleProxyAddress=r[2],e()})}},{name:"Deploy Governance Rules",call:function(t){var n=["address","uint256","uint256","uint256","uint256","uint256","uint256","uint256","uint256"],r=[window.voidEthereumAddress,0,t.surveyLength,t.emergencySurveyLength,window.toDecimals(t.emergencySurveyStaking,18),t.surveyQuorum?window.toDecimals(t.surveyQuorum,18):0,t.surveyMaxCap?window.toDecimals(t.surveyMaxCap,18):0,t.surveyMinStake?window.toDecimals(t.surveyMinStake,18):0,t.surveySingleReward?window.toDecimals(t.surveySingleReward,18):0],i=window.web3.eth.abi.encodeParameters(n,r);return window.blockchainCall(window.dfoHub.dFO.methods.submit,"deployGovernanceRules",i).then(function(e){t.functionalitiesManagerAddress=window.formatDFOLogs(e.events.Event,"DFOCollateralContractsCloned(address_indexed,address)").raw.data[0]})},onTransaction:function(t,n){return new Promise(function(e){e(t.functionalitiesManagerAddress=window.formatDFOLogs(n.logs,"DFOCollateralContractsCloned(address_indexed,address)")[0].data[0])})}},{name:"Deploy Metadata",call:function(t){var n={};return Object.entries(t.metadata).forEach(function(e){return n[e[0]]=e[1]}),window.deployMetadataLink(n,t.functionalitiesManagerAddress)}},{name:"Deploy New DFO",call:function(t){var r=window.web3.eth.abi.encodeParameters(["address","uint256","address","address","address","address","address","address","address","string"],[window.voidEthereumAddress,0,t.votingToken,t.mvdFunctionalityProposalManagerAddress,t.stateHolder,t.functionaltyModelsManagerAddress,t.functionalitiesManagerAddress,t.mvdWalletAddress,t.doubleProxyAddress,t.ensDomain.toLowerCase()]);return window.blockchainCall(window.dfoHub.dFO.methods.submit,"deployDFO",r).then(function(e){t.response=window.formatDFOLogs(e.events.Event,"DFODeployed(address_indexed,address_indexed,address,address)").raw.data[0]}).then(function(){return n.emit("dfo/deploy",window.newContract(window.context.proxyAbi,t.response))})},actionName:"Deploy"}]))}});var DeployDFOMetadata=React.createClass({displayName:"DeployDFOMetadata",requiredScripts:["spa/dFOMetadata/edit.jsx"],getData:function(){return this.dFOMetadataEdit.getData().then(function(e){return{metadata:e}})},setData:function(t){var n=this;t&&setTimeout(function(){return n.dFOMetadataEdit.setData(t.metadata)},250)},render:function(){var t=this;return React.createElement("section",null,React.createElement("p",null,React.createElement("span",null,"2 of 4 | Metadata"),React.createElement("br",null),"What this brand new DFO is about?"),React.createElement(DFOMetadataEdit,{ref:function(n){return t.dFOMetadataEdit=n}}))}});var GovernanceRulesData=React.createClass({displayName:"GovernanceRulesData",requiredScripts:["spa/okBoomer.jsx"],getData:function(){var t=this,n=window.getData(this.domRoot),r=[];(isNaN(n.surveyLength)||n.surveyLength<=0)&&r.push("Survey Length must be a number greater than 0"),(isNaN(n.emergencySurveyLength)||n.emergencySurveyLength<=0)&&r.push("Emergency Survey Length must be a number greater than 0");var i=parseFloat(window.fromDecimals(this.props.allData.availableSupply,18).split(",").join("")),s=function(n,r,i,s,o,u){if(!n[s+"Check"]&&!u)return;var a=parseFloat(n[s].split(",").join("")),f=u?a<0:a<=0;(isNaN(a)||f||a>r)&&i.push((o||t[s+"Label"].innerHTML.split(":").join(""))+" must be a valid, positive number "+(u?"between 0 and":"less than")+" "+window.formatMoney(r))};s(n,i,r,"emergencySurveyStaking",undefined,!0),s(n,i,r,"surveyQuorum"),s(n,i,r,"surveyMaxCap"),s(n,i,r,"surveyMinStake"),s(n,i,r,"surveyCommunityStake"),s(n,i,r,"surveySingleReward");if(r.length>0)throw r;return n},renderSurveyLength:function(){return this.renderInput("InsertSurveyLength","","surveyLength","Survey Length","","number","Blocks",!1,"Every survey has a length expressed in Blocks. Here you can set the duration of Surveys for this DFO.")},renderSurveyEmergencyLength:function(){return this.renderInput("InsertSurveyEmergencyLength","","emergencySurveyLength","Emergency Length","","number","Blocks",!1,"Emergency Proposals are designed as a Faster Proposal System for bug fixing. To ensure that users have economic disincentives to use it to fraud the community, we advise setting a High Penalty Fee, because if the Proposal Fails, the Proposer will lose it.")},renderSurveyEmergencyPenalty:function(){return this.renderInput("InsertSurveyEmergencyPenalty","","emergencySurveyStaking","Penalty Fee","","text",this.props.allData.tokenSymbol,!0,"The Fee that Emergency Proposal Issuer must stake to propose it and lost if the Proposal fails.")},renderSurveyQuorum:function(){return this.renderInput("InsertSurveyQuorum","SurveyQuorumYN","surveyQuorum","Survey Quorum","SurveyQuorumHow","text",this.props.allData.tokenSymbol,!0,"The Quorum is minimum token Staken by voters in a survey to reach the success status.")},renderSurveyMaxCap:function(){return this.renderInput("InsertSurveyQuorum","SurveyQuorumYN","surveyMaxCap","Max Cap","SurveyQuorumHow","text",this.props.allData.tokenSymbol,!0,"Reaching the Max Cap, the proposal passes independently from the Survey Lenght.")},renderSurveyMinStake:function(){return this.renderInput("InsertSurveyQuorum","SurveyQuorumYN","surveyMinStake","Min Staking","","text",this.props.allData.tokenSymbol+" to Propose Updates",!0,"The minimum of Token Staked needed to create a new Proposal.")},renderSurveyCommunityStake:function(){return this.renderInput("InsertSurveyQuorum","SurveyQuorumYN","surveyCommunityStake","DFO Locked Supply","","text",this.props.allData.tokenSymbol,!0,"The amount of Voting Tokens locked in the DFO wallet (For Fixed Inflation, Liquidity Mining, Rewards and other Community Features).")},renderSurveySingleReward:function(){return this.renderInput("InsertSurveyQuorum","SurveyQuorumYN","surveySingleReward","Activity Reward","","text",this.props.allData.tokenSymbol+" of staked tokens",!0,"The amount of Voting Tokens set as a reward to the issuer for every Accepted Proposal paid automatically by the DFO Wallet.")},onCheck:function(t){var n=t.currentTarget.dataset.id,r=t.currentTarget.dataset.type;this[n].value=t.currentTarget.checked?"0":"",t.target.checked&&r==="text"&&(this[n].value+=".00"),this[n].disabled=!t.target.checked,this.calculatePercentage({currentTarget:this[n]}),t.target.checked&&this[n].focus()},inputRef:function(t,n,r,i){this[n]=t;if(!t)return;var s=this.props.allData||{};t.disabled=r?!s[n+"Check"]:!1,t.value=s[n]||"",i&&(t.onkeyup=this.calculatePercentage)},percentageRef:function(t,n){this[n+"Percentage"]=t;if(!t)return;this.calculatePercentage({currentTarget:{id:n,value:this.props&&this.props.allData&&this.props.allData[n]||""}})},calculatePercentage:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this[t.currentTarget.id+"Percentage"].innerHTML="";var n=t.currentTarget.value.split(",").join("").trim();if(n==="")return;var n=parseFloat(n);n=isNaN(n)?0:n,n=n*100/parseFloat(window.fromDecimals(this.props.allData.availableSupply,18).split(",").join("")),n=window.formatMoney(n),this[t.currentTarget.id+"Percentage"].innerHTML="("+n+"% of total "+this.props.allData.tokenSymbol+" supply)"},renderInput:function(t,n,r,i,s,o,u,a,f){var l=this,c=this;return React.createElement("div",{className:t+" GovernSelectorPage"},n&&React.createElement("input",{className:n,id:r+"Check","data-id":r,"data-type":o||"text",type:"checkbox",onChange:this.onCheck}),React.createElement("label",{htmlFor:r,ref:function(t){return c[r+"Label"]=t}},i,":"),React.createElement("input",{id:r,className:s||"GigiImputabene",ref:function(t){return c.inputRef(t,r,n,a)},type:o||"text",placeholder:"Amount",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$",min:"0"}),u&&React.createElement("span",null,u),a&&React.createElement("span",{ref:function(t){return l.percentageRef(t,r)}}),React.createElement("p",{className:"OkBoomer"},f," ",React.createElement("div",{className:"BoomerTriangle"})))},renderSuite:function(t){var n=[React.createElement("p",{className:"WOWDescription"},t)];if(arguments.length>1)for(var r=1;r<arguments.length;r++)n.push(this["render"+arguments[r].firstLetterToUpperCase()]());return n},renderBasicSuite:function(){return this.renderSuite("Basic Governance Rules","surveyLength","surveyMinStake","surveyCommunityStake")},renderAdvancedSuite:function(){return this.renderSuite("Advanced Governance Rules","surveyQuorum","surveyMaxCap","surveySingleReward")},renderEmergencySuite:function(){return this.renderSuite("Emergency Governance Rules","surveyEmergencyLength","surveyEmergencyPenalty")},render:function(){return React.createElement("section",null,React.createElement("p",null,React.createElement("span",null,"3 of 3 | Governance"),React.createElement("br",null),"Its time to choose the Governance Rules! All Governance Rules can be changed anytime via proposals."),React.createElement("section",{className:"DFOGovernanceSelector"},React.createElement("ul",{className:"DFOGovernanceType"},React.createElement("section",{className:"DeployNewWhat"},this.renderBasicSuite(),this.renderAdvancedSuite(),this.renderEmergencySuite()))))}});var Subdomain=React.createClass({displayName:"Subdomain",getData:function(){var t=this;return(new Promise(function(e,n){var r=window.getData(t.domRoot),i=[];return!r.ensDomain&&i.push("ENS Domain is mandatory"),i.length>0?n(i):e(r)})).then(t.checkENS)},checkENS:function(t){var n=this;t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var r=t.target,i=(r?r.value:t.ensDomain).toLowerCase();t.ensDomain&&(t.ensDomain=i);var s=function(){return new Promise(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function s(e,o){var u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return u=!1,a.prev=1,a.next=4,window.blockchainCall(window.ENSController.methods.recordExists,nameHash.hash(nameHash.normalize(i+".dfohub.eth")));case 4:u=a.sent,a.next=9;break;case 7:a.prev=7,a.t0=a["catch"](1);case 9:if(!n.ensCheck){a.next=14;break}r&&(r.value=i),n.ensCheck.innerHTML="&#"+(u?"9940":"9989")+";";if(!!t.preventDefault||!u){a.next=14;break}return a.abrupt("return",o(["ENS Name already taken"]));case 14:return a.abrupt("return",e(t));case 15:case"end":return a.stop()}},s,this,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}())};if(!r)return s();this.checkTimeout&&window.clearTimeout(this.checkTimeout),this.checkTimeout=window.setTimeout(s,700)},render:function(){var t=this;return React.createElement("section",null,React.createElement("p",null,React.createElement("span",null,"1 of 4 | Subdomain"),React.createElement("br",null),"Fist of all, Redeem your ENS subdomain. The .dfohub.eth subdomain will redirect users to the DFO's front-end persistently as long as the ethereum network exists."),React.createElement("section",{className:"DeployNewWhat"},React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"ensDomain"},"Subdomain:"),React.createElement("input",{id:"ensDomain",type:"text",onChange:this.checkENS})," ",React.createElement("span",null,".dfohub.eth")," ",React.createElement("span",{className:"SubDomainFree",ref:function(n){return t.ensCheck=n}}))))}});var Deploy=React.createClass({displayName:"Deploy",requiredScripts:["spa/deploy/subdomain.jsx","spa/deploy/votingTokenData.jsx","spa/deploy/governanceRulesData.jsx","spa/deploy/deployDFOMetadata.jsx","spa/deploy/deployDFO.jsx"],steps:["Subdomain","VotingTokenData","GovernanceRulesData","DeployDFOMetadata","DeployDFO"],getInitialState:function(){return{step:0}},deploy:function(t){this.currentElement.sequentialOps.go(t)},render:function(){var t=this;return this.data=this.data||this.steps.map(function(){}),React.createElement("section",{className:"Nav"},React.createElement("div",{className:"NavAll"},React.createElement("div",{className:"NavDeploy"},React.createElement("h2",null,"Incorporate a new ",React.createElement("b",null,"Decentralized Flexible Organization")),React.createElement(window[this.steps[this.state.step]],{allData:this.state&&this.state.allData||{},data:this.data[this.state.step],ref:function(n){return(t.currentElement=n)&&(n.setData?n.setData(t.data[t.state.step]):window.setData(n.domRoot,t.data[t.state.step]))}}),React.createElement("div",{className:"DeployActions"},this.state.step!==0&&React.createElement("a",{className:"DeployNextPrev DeployOLNYPrev",href:"javascript:;",onClick:this.controller.back},"Back"),this.state.step<this.steps.length-1&&React.createElement("a",{className:"DeployNextPrev",href:"javascript:;",onClick:this.controller.next},"Next")))))}});var VotingTokenData=React.createClass({displayName:"VotingTokenData",getData:function(){var t=this,n=window.getData(t.domRoot);return new Promise(function(e,r){var i=[];!n.tokenName&&i.push("Insert a valid Token Name"),!n.tokenSymbol&&i.push("Insert a valid Token Symbol"),(isNaN(n.tokenTotalSupply)||n.tokenTotalSupply<=0)&&i.push("Token Total Supply must be greater than 0");if(i.length>0)return r(i);n.totalSupplyWei=window.toDecimals(n.tokenTotalSupply,18),t.retrieveVotingTokensAmountForHub(n.tokenTotalSupply).then(function(t){return n.availableSupply=t.available,e(n)})})},retrieveVotingTokensAmountForHub:function(t){var n=window.toDecimals(t,18);return window.blockchainCall(window.dfoHub.dFO.methods.read,"getVotingTokenAmountForHub",window.web3.eth.abi.encodeParameter("uint256",n)).then(function(e){return e=window.web3.eth.abi.decodeParameter("uint256",e),{result:e,available:window.web3.utils.toBN(n).sub(window.web3.utils.toBN(e)).toString()}})},onChange:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this;n.tokenSymbolLabel.innerHTML=n.tokenSymbol.value;var r=parseFloat(n.totalSupply.value.split(",").join(""));r=isNaN(r)?0:r,n.retrieveVotingTokensAmountForHub(r).then(function(e){n.amountForHub.innerHTML=window.fromDecimals(e.result,18)})},retrieveAmountPercentage:function(t){t&&this.retrieveVotingTokensAmountForHub(100).then(function(e){return t.innerHTML=window.fromDecimals(e.result,18)})},render:function(){var t=this;return React.createElement("section",null,React.createElement("p",null,React.createElement("span",null,"2 of 3 | Voting Token"),React.createElement("br",null),"The Voting Token of a DFO is an ERC20 Token. The Voting Token is the key to rule the DFO functionalities and its assets. If you lose your voting tokens, there is no way to be part of the future DFO's decisions."),React.createElement("section",{className:"DeployNewWhat"},React.createElement("div",{className:"InsertDfoName"},React.createElement("label",{htmlFor:"tokenName"},"Name:"),React.createElement("input",{autocomplete:"off",id:"tokenName",type:"text"})),React.createElement("div",{className:"InsertTokenName"},React.createElement("label",{htmlFor:"tokenSymbol"},"Symbol:"),React.createElement("input",{ref:function(n){return t.tokenSymbol=n},autocomplete:"off",id:"tokenSymbol",type:"text",onChange:this.onChange})),React.createElement("div",{className:"InsertTokenSupply"},React.createElement("label",{htmlFor:"tokenTotalSupply"},"Supply:"),React.createElement("input",{id:"tokenTotalSupply",type:"number",min:"1",ref:function(n){return t.totalSupply=n},onChange:this.onChange}),React.createElement("aside",null,React.createElement("b",null,"Generation Fee:")," ",React.createElement("span",{ref:this.retrieveAmountPercentage}),"% ",React.createElement("span",null,"(",React.createElement("span",{ref:function(n){return t.amountForHub=n}},"0")," ",React.createElement("span",{ref:function(n){return t.tokenSymbolLabel=n}}),")")))))}});var DFOElementController=function(t){var n=this;n.view=t,n.loadMenu=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,fetch("data/menuOrganization.json");case 2:return o.next=4,o.sent.json();case 4:e=o.sent,t={},s=function u(e,n){n=_typeof(n).toLowerCase()==="number"?null:n,i=i||!e.organization&&e.name,t[e.name]={parent:n,organization:e.organization,name:e.name,element:e.element||e.name.split(" ").join(""),scripts:e.scripts,modules:e.modules||["spa/"+(e.element||e.name).split(" ").join("").firstLetterToLowerCase()]},e.organization&&e.organization.forEach(function(t){return u(t,e)})},e.forEach(s),n.view.setState({menu:e,sections:t},function(){n.view.sectionChange(i)});case 9:case"end":return o.stop()}},r,this)}));return t}(),n.buildMenu=function(t,r){r=r||[];var i=t.parent||n.view.state.menu;return r.unshift((i.organization||i).map(function(e){return{name:e.name,selected:e.name===t.name}})),i.organization?n.buildMenu(i,r):r},n.getVoiceOrOrganizationFirstVoice=function(t){return t.organization?n.getVoiceOrOrganizationFirstVoice(n.view.state.sections[t.organization[0].name]):t}};var DFOElement=React.createClass({displayName:"DFOElement",requiredScripts:["spa/loaderMinimino.jsx"],getDefaultSubscriptions:function(){return{"section/change":this.sectionChange}},onClick:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.sectionChange(t.target.innerHTML)},sectionChange:function(t,n){var r=this.controller.getVoiceOrOrganizationFirstVoice(this.state.sections[t]),i=this;ReactModuleLoader.load({modules:r.modules,scripts:r.scripts,callback:function(){return i.setState({section:r.element,props:n||null,builtMenu:i.controller.buildMenu(r)},function(){i.forceUpdate()})}})},componentDidMount:function(){this.controller.loadMenu(),window.setHomepageLink("?addr="+this.props.element.dFO.options.address)},componentWillUnmount:function(){window.setHomepageLink()},render:function(){var t=this,n={};return this.props&&Object.entries(this.props).forEach(function(e){return n[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return n[e[0]]=e[1]}),n.props&&Object.entries(n.props).forEach(function(e){return n[e[0]]=e[1]}),delete n.props,React.createElement("section",{className:"DFOOpened"},n.builtMenu&&n.builtMenu.map(function(e,n){return React.createElement("ul",{key:n,className:"DFONavigator DFONavigatorAfter"+(n==0?"":" DFOSubNavigator")},e.map(function(e){return React.createElement("li",{key:e.name},React.createElement("a",{href:"javascript:;",onClick:t.onClick,className:e.selected?"selected":null},e.name))}))}),n.section&&React.createElement(window[n.section],n),!n.section&&React.createElement(LoaderMinimino,null))}});var DFOListController=function(t){var n=this;n.view=t,n.blockSearchSize=4e4,n.dfoDeployedEvent="DFODeployed(address_indexed,address)",n.newDfoDeployedEvent="DFODeployed(address_indexed,address_indexed,address,address)",n.loadList=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.alreadyLoaded={},t.next=3,n.loadTestDFOs();case 3:t.t0=n.running=t.sent;if(!t.t0){t.next=6;break}n.loadEvents();case 6:case"end":return t.stop()}},r,this)}));return t}(),n.loadTestDFOs=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return window.context.testDFOs&&window.context.testDFOs.length>0&&(e=window.getNetworkElement("deploySearchStart"),window.context.testDFOs.forEach(function(t){return n.loadDFO(t,t,e)})),r.abrupt("return",!0);case 2:case"end":return r.stop()}},r,this)}));return t}(),n.loadEvents=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!window.context.bypassLoadDFOs){u.next=3;break}return delete n.running,u.abrupt("return",n.view.forceUpdate());case 3:if(!!n.running&&t!==window.getNetworkElement("deploySearchStart")){u.next=6;break}return delete n.running,u.abrupt("return",n.view.mounted&&n.view.forceUpdate());case 6:u.t0=i;if(u.t0){u.next=11;break}return u.next=10,web3.eth.getBlockNumber();case 10:u.t0=u.sent;case 11:i=u.t0,t=t||i,s=t-n.blockSearchSize,o=window.getNetworkElement("deploySearchStart"),s=s>o?o:t,n.getLogs(s,t,n.newDfoDeployedEvent),n.getLogs(s,t,n.dfoDeployedEvent),setTimeout(function(){return n.loadEvents(e,s,i)});case 19:case"end":return u.stop()}},r,this)}));return t}(),n.getLogs=function(){function t(t,n,r,i){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i,s){var o,u,a,f,l,c,h;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!!window.dfoHub&&!!window.dfoHub.dFO){p.next=2;break}return p.abrupt("return",setTimeout(function(){return n.getLogs(e,t,i,s)},300));case 2:return p.next=4,window.getDFOLogs({address:window.dfoHub.dFO.options.allAddresses,topics:s,event:i,fromBlock:""+e,toBlock:""+t});case 4:o=p.sent,u=o,a=Array.isArray(u),f=0,u=a?u:u[Symbol.iterator]();case 6:if(!a){p.next=12;break}if(!(f>=u.length)){p.next=9;break}return p.abrupt("break",24);case 9:l=u[f++],p.next=16;break;case 12:f=u.next();if(!f.done){p.next=15;break}return p.abrupt("break",24);case 15:l=f.value;case 16:c=l;if(!n.alreadyLoaded[c.data[0].toLowerCase()]){p.next=19;break}return p.abrupt("continue",22);case 19:n.alreadyLoaded[c.data[0].toLowerCase()]=!0,h=c.blockNumber+"_"+c.id,!n.isInList(h)&&n.loadDFO(c.data[0],h,c.blockNumber);case 22:p.next=6;break;case 24:return p.abrupt("return",o);case 25:case"end":return p.stop()}},r,this)}));return t}(),n.getLatestSearchBlock=function(){return window.list&&Object.keys(window.list).length>0&&Math.max.apply(Math,Object.keys(window.list).map(function(e){return parseInt(e.split("_")[0])}))||window.getNetworkElement("deploySearchStart")},n.isInList=function(t){if(window.list[t])return!0;if(!t.dFO){try{t=window.web3.utils.toChecksumAddress(t)}catch(n){return!1}if(Object.values(window.list).filter(function(e){return e.dFO.options.allAddresses.filter(function(e){return window.web3.utils.toChecksumAddress(e)===t}).length>0}).length>0)return!0}else{var r=t.dFO.options.allAddresses.map(function(e){return window.web3.utils.toChecksumAddress(e)}),i=Object.values(window.list).map(function(e){return e.dFO.options.allAddresses.map(function(e){return window.web3.utils.toChecksumAddress(e)})});for(var s=i,o=Array.isArray(s),u=0,s=o?s:s[Symbol.iterator]();;){var a;if(o){if(u>=s.length)break;a=s[u++]}else{u=s.next();if(u.done)break;a=u.value}var f=a;for(var l=f,c=Array.isArray(l),h=0,l=c?l:l[Symbol.iterator]();;){var p;if(c){if(h>=l.length)break;p=l[h++]}else{h=l.next();if(h.done)break;p=h.value}var d=p;if(r.indexOf(d)!=-1)return!0}}}return!1},n.loadDFO=function(t,r,i){window.loadDFO(t).then(function(e){!n.isInList(r)&&(window.list[r]={key:r,startBlock:i,dFO:e})&&n.view.mounted&&n.view.forceUpdate()})}};var DFOList=React.createClass({displayName:"DFOList",requiredModules:["spa/dFOElement"],requiredScripts:["spa/loaderMini.jsx","spa/asyncValue.jsx"],getDefaultSubscriptions:function(){var t=this,n=this;return{"ethereum/update":function(){return t.forceUpdate(t.controller.loadList)},"ethereum/ping":this.refreshUserBalance,search:function(n){return t.setState({search:n,key:null})},"element/update":this.updateElement,"balances/refresh":function(){return window.refreshBalances(t,t.props.element)},"okBommer/toggle":this.toggleOkBoomer,"edit/toggle":function(r,i){return t.dfoElement.setState({edit:r},n.forceUpdate(i))}}},getInitialState:function(){return{orderByMetadata:window.localStorage.dfoListOrderByMetadata==="false"?!1:!0,order:window.localStorage.dfoListOrderMode||"sortByUnlockedMarketCap",orders:{sortByUnlockedMarketCap:"Circ. Supply",sortByLockedMarketCap:"Locked Supply",sortByTotalMarketCap:"Market Cap",sortFromLast:"Newest",sortFromFirst:"Oldest"}}},setOrder:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),window.localStorage.setItem("dfoListOrderMode",t.currentTarget.value),this.setState({order:window.localStorage.dfoListOrderMode})},setCheckOrderByMetadata:function(t){window.localStorage.setItem("dfoListOrderByMetadata",t.currentTarget.checked),this.setState({orderByMetadata:t.currentTarget.checked})},toggleOkBoomer:function(){var t=this;this.dfoElement.setState({okBoomer:!this.dfoElement.state||!this.dfoElement.state.okBoomer},function(){return t.forceUpdate()})},updateElement:function(t){delete t.updating,window.updateInfo(this,t)},componentDidMount:function(){this.controller.loadList()},componentDidUnmount:function(){this.controller.running=!1},getList:function(){try{var t=Object.keys(window.list).reverse().map(function(e){return window.list[e]}),n=0;while(n<t.length){var r=t[n];r.updating?n++:(t.splice(n,1),window.updateInfo(this,r,!0))}t.length>1&&t.unshift(t.splice(t.length-1,1)[0]);if(this.state&&this.state.search){var i=this.state.search.toLowerCase().trim();for(var n=0;n<t.length;n++){var r=t[n];r.name&&r.name.toLowerCase().indexOf(i)===0||r.dFO.options.address.toLowerCase().indexOf(i)===0||(t.splice(n,1),n--)}t.length===1&&window.isEthereumAddress(i)&&this.setState({search:null,key:t[0].key})}return this.sortList(t)}catch(s){return[]}},sortList:function(t){var n=this[this.state.order](t);if(this.state.orderByMetadata){var r=n.filter(function(e){return e.dFO.metadataLink!==undefined&&e.dFO.metadataLink!==null});r.push.apply(r,n.filter(function(e){return e.dFO.metadataLink===undefined||e.dFO.metadataLink===null})),n=r}return n},sortFromLast:function(t){var n=Object.values(t).sort(function(e,t){var n=parseInt(e.key.substring(0,e.key.indexOf("_"))),r=t?parseInt(t.key.substring(0,t.key.indexOf("_"))):0;return n<r?1:n>r?-1:0}),r=n.indexOf(window.dfoHub);return n.splice(r,1),n.push(window.dfoHub),n},sortFromFirst:function(t){return Object.values(t).sort(function(e,t){var n=parseInt(e.key.substring(0,e.key.indexOf("_"))),r=t?parseInt(t.key.substring(0,t.key.indexOf("_"))):0;return n<r?-1:n>r?1:0})},sortByUnlockedMarketCap:function(t){return this.sortByMarketCap(t,"unlockedMarketCapDollar")},sortByLockedMarketCap:function(t){return this.sortByMarketCap(t,"lockedMarketCapDollar")},sortByTotalMarketCap:function(t){return this.sortByMarketCap(t,"totalMarketCapDollar")},sortByMarketCap:function(t,n){var r=function(t,r){var i=t[n],s=r?r[n]:0;return i<s?1:i>s?-1:0};return Object.values(t).sort(r)},componentDidUpdate:function(){this.emit("index/fullscreen",this.state&&this.state.key!==undefined&&this.state.key!==null)},refreshUserBalance:function(){var t=this;t.state&&t.state.key&&window.refreshBalances(undefined,window.list[t.state.key],!0).then(function(){return t.forceUpdate()})},render:function(){var t=this,n=this,r=this.getList();return React.createElement("section",{className:"DFOList"+(this.state&&this.state.key?" DFOListOpenAfter":"")},(!this.state||!this.state.key)&&React.createElement("section",{className:"ListOrderPanel"},React.createElement("label",{className:"ORDERINFOOOOOO"},React.createElement("p",null,"Sort by"),React.createElement("select",{onChange:this.setOrder},Object.entries(this.state.orders).map(function(e){return React.createElement("option",{key:e[0],value:e[0],selected:n.state.order===e[0]},e[1])}))),React.createElement("label",{className:"METADATAINFOOOOOO"},React.createElement("span",null,"Metadata First"),React.createElement("input",{type:"checkbox",checked:this.state.orderByMetadata,onChange:this.setCheckOrderByMetadata})),React.createElement("br",null)),React.createElement("ul",{className:"DFOLister"},r.map(function(e){return(!n.state||!n.state.key||n.state.key===e.key)&&React.createElement("li",{key:e.key,className:"DFOInfo"},React.createElement("section",{className:"DFOMAinNav"+(t.state&&t.state.key?" DFOMAinNavAfter":"")},React.createElement("section",{className:"DFOMAinNavBox"},React.createElement("a",{href:"javascript:;",onClick:function(){delete e.functionalities,n.setState({key:n.state&&n.state.key===e.key?null:e.key},n.refreshUserBalance)},className:"DFOOpener"},React.createElement("section",{className:"DFOIcon"},React.createElement(AsyncValue,null,React.createElement("img",{src:e.brandUri?window.formatLink(e.brandUri):e.icon}))),React.createElement("section",{className:"DFOName"},React.createElement(AsyncValue,null,React.createElement("h5",null,e.name))),React.createElement("section",{className:"DFOMinInfo DFOMinInfoOp"},React.createElement("h6",null,"Functions"),React.createElement(AsyncValue,null,React.createElement("h5",null,e.functionalitiesAmount))),React.createElement("section",{className:"DFOMinInfo DFOMinInfoOp"},React.createElement("h6",null,"Start Block"),React.createElement(AsyncValue,null,React.createElement("h5",null,e.startBlock))),n.state&&n.state.key===e.key&&window.walletAddress&&React.createElement("section",{className:"DFOMinInfo"},React.createElement("figure",null,React.createElement("img",{src:window.walletAvatar})),React.createElement("section",null,React.createElement("h6",null,window.walletAddress.substring(0,20),"..."),React.createElement("h5",null,React.createElement("aside",null,"Balance: ",React.createElement(AsyncValue,null,window.fromDecimals(e.myBalanceOf,e.decimals))," ",e.symbol))))),React.createElement("a",{className:"DFOENSOpener",target:"_blank",href:"https://"+(e.ens&&e.ens.toLowerCase()+"."||"")+"dfohub.eth?ensd="+(e.ens&&e.ens.toLowerCase()+"."||"")+"dfohub.eth"},React.createElement("section",{className:"DFOMinInfo"},React.createElement("h6",null,"ENS"),React.createElement(AsyncValue,null,e.ens!==undefined&&React.createElement("h5",null,e.ens&&e.ens.toLowerCase()+"."||"","dfohub.eth")))),React.createElement("a",{className:"DFOAddressOpener"},React.createElement("section",{className:"DFOMinInfo"},React.createElement("h6",null,"Token"),React.createElement(AsyncValue,null,React.createElement("h5",null,e.symbol)))),React.createElement("a",{className:"DFOAddressOpener DFOAddressOpener2",href:window.getNetworkElement("etherscanURL")+"address/"+e.dFO.options.address,target:"_blank"},React.createElement("section",{className:"DFOMinInfo"},React.createElement("h6",null,"Address"),React.createElement(AsyncValue,null,React.createElement("h5",null,e.dFO.options.address.substring(0,9)+"...")))),n.state&&n.state.key===e.key&&React.createElement("section",{className:"DFOEditKill"},React.createElement(WalletEnablerButton,{href:"javascript:;",className:"EditDFOYo"+(n.dfoElement&&n.dfoElement.state&&n.dfoElement.state.edit?" Editing":""),onClick:function(){return n.dfoElement.setState({edit:!n.dfoElement.state||!n.dfoElement.state.edit},function(){return n.forceUpdate()})}},"Edit"),React.createElement("a",{href:"javascript:;",className:"CloseDFOYo",onClick:function(){delete e.functionalities,n.setState({key:null})}},"☒")))),n.state&&n.state.key===e.key&&React.createElement(DFOElement,{element:e,ref:function(t){return n.dfoElement=t}}))}),r.length===1&&(!n.controller||n.controller.running)&&React.createElement(LoaderMini,{message:"Loading DFOs"})))}});var DFOMetadataController=function(t){var n=this;n.view=t};var DFOMetadataEdit=React.createClass({displayName:"DFOMetadataEdit",extractData:function(){var t=window.getData(this.domRoot);return t},getData:function(){return window.validateDFOMetadata(this.extractData(),!0)},setData:function(t){if(!t)return;var n={};Object.entries(t).forEach(function(e){return n[e[0]]=e[1]}),window.setData(this.domRoot,n)},proposeChange:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this;n.setState({performing:"propose"},function(){window.proposeNewMetadataLink(n.props.element,n.extractData()).then(function(){return n.emit("metadata/edit/close")}).catch(function(e){return n.emit("message",e.message||e,"error")}).finally(function(){n.setState({performing:null})})})},back:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.emit("metadata/edit/close")},componentDidMount:function(){this.setData(this.props.data)},render:function(){return React.createElement("section",{className:"DeployNewWhat "+this.props.className},React.createElement("section",{className:"DeployNewWhat3"},React.createElement("h2",{className:"METADATACHANGE"},"Propose Metadata Change"),React.createElement("a",{className:"METADATACHANGECLOSE",href:"javascript:;",onClick:this.back},"Back"),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{className:"LabelSPEC",htmlFor:"shortDescription"},"BIO:"),React.createElement("textarea",{className:"LabelSPECWRITE",id:"shortDescription",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A brief description of the organization ",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoName"},React.createElement("label",{htmlFor:"name"},"DFO Name:"),React.createElement("input",{autocomplete:"off",id:"name",type:"text"})),React.createElement("p",{className:"OkBoomer"},"The name of the organization",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"brandUri"},"DFO Logo:"),React.createElement("input",{id:"brandUri",type:"text"})),React.createElement("p",{className:"OkBoomer"},"IPFS link to the logo of the organization (must be a .png 320 x 320 pixels)",React.createElement("a",{href:"https://docs.ipfs.io/",target:"_blank"},"IPFS Guide"),React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"logoUri"},"Token Logo:"),React.createElement("input",{id:"logoUri",type:"text"})),React.createElement("p",{className:"OkBoomer"},"IPFS link to the logo of the Voting Token (must be a .png 320 x 320 pixels)",React.createElement("a",{href:"https://docs.ipfs.io/",target:"_blank"},"IPFS Guide"),React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"discussionUri"},"Chat Link:"),React.createElement("input",{id:"discussionUri",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A link to the official community of the organization (ex. Riot, Discord, Telegram)",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"repoUri"},"Repo link:"),React.createElement("input",{id:"repoUri",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A link to the official R&D repository",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"wpUri"},"Explainer link:"),React.createElement("input",{id:"wpUri",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A link to an external source that explain the plan of the organization",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"roadmapUri"},"Roadmap link:"),React.createElement("input",{id:"roadmapUri",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A link to an external source that provide the roadmap of the project",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"externalDNS"},"External link:"),React.createElement("input",{id:"externalDNS",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A link to an external webpage to use the application (if any).",React.createElement("div",{className:"BoomerTriangle"})),React.createElement("div",{className:"InsertDfoSubdomain"},React.createElement("label",{htmlFor:"externalENS"},"External ENS link:"),React.createElement("input",{id:"externalENS",type:"text"})),React.createElement("p",{className:"OkBoomer"},"A link to an external ENS webpage to use the application (if any).",React.createElement("div",{className:"BoomerTriangle"}))),this.props.showCommands&&React.createElement("section",{className:"PROPOSEmetadata"},React.createElement("br",null),(!this.state||this.state.performing!=="propose")&&React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB",href:"javascript:;",onClick:this.proposeChange},"Propose"),this.state&&this.state.performing==="propose"&&React.createElement("section",{className:"loaderMinimino"})))}});var DFOMetadata=React.createClass({displayName:"DFOMetadata",requiredScripts:["spa/dFOMetadata/edit.jsx"],getDefaultSubscriptions:function(){var t=this;return{"metadata/edit/close":function(){return t.setState({change:null})}}},renderBio:function(t){if(!t)return;var n=this,r=this.state&&this.state.more,i=window.shortenWord(n.props.element.shortDescription,300),s=r?n.props.element.shortDescription:i;t.innerHTML=s.split("\n").join("<br/>"),i.length!==n.props.element.shortDescription.length&&$(t).append($('<a href="javascript:;" class="MOREINFOSOON">'+(r?"Less":"More")+"</a>").click(function(){n.setState({more:r?!1:!0},function(){n.renderBio(t)})}))},render:function(){var t=this;return t.state&&t.state.change==="edit"?React.createElement(DFOMetadataEdit,{className:"DeployNewWhat2",element:t.props.element,data:t.props.element.metadata,showCommands:!0}):t.props.element.metadataLink?React.createElement("ul",{className:"DFOHosting"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Organization Info ",t.props.edit&&React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB"+(t.state&&t.state.change===name?" Editing":""),href:"javascript:;",onClick:function(){return t.setState({change:t.state&&t.state.change==="edit"?null:"edit"})}},"Change"))),React.createElement("li",{className:"TheDappInfo05 TheDappInfo1B"},t.props.element.brandUri&&React.createElement("img",{className:"DFObrandICON",src:window.formatLink(t.props.element.brandUri)})),t.props.element.shortDescription&&React.createElement("li",{className:"TheDappInfo2"},React.createElement("h5",{className:"DFOHostingTitle"},"BIO"),React.createElement("section",{className:"DFOTitleSection"},React.createElement("p",{className:"DFOLabelTitleInfo DFOLabelTitleInfo4",ref:this.renderBio}))),React.createElement("li",{className:"TheDappInfo1 TheDappInfo1B"},React.createElement("h5",{className:"DFOHostingTitle"},"More"),React.createElement("section",{className:"DFOTitleSection DFOTitleSectionB"},t.props.element.wpUri&&React.createElement("a",{href:window.formatLink(t.props.element.wpUri),target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"Explainer"),t.props.element.roadmapUri&&React.createElement("a",{href:window.formatLink(t.props.element.roadmapUri),target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"Roadmap"),t.props.element.repoUri&&React.createElement("a",{href:window.formatLink(t.props.element.repoUri),target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"Ext. Repo"),t.props.element.discussionUri&&React.createElement("a",{href:window.formatLink(t.props.element.discussionUri),target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"Discussion"),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleB"},"Secure Domain"),React.createElement(AsyncValue,null,t.props.element.ens!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan LinkVisualEthscam",target:"_blank",href:"https://"+(t.props.element.ens&&t.props.element.ens.toLowerCase()+"."||"")+"dfohub.eth?ensd="+(t.props.element.ens&&t.props.element.ens.toLowerCase()+"."||"")+"dfohub.eth"},t.props.element.ens&&t.props.element.ens.toLowerCase()+"."||"","dfohub.eth"))),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleB"},"External Domains"),t.props.element.externalDNS&&React.createElement("a",{href:window.formatLink(t.props.element.externalDNS),target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"DNS Link"),t.props.element.externalENS&&React.createElement("a",{href:window.formatLink(t.props.element.externalENS),target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"ENS Link")))):React.createElement("ul",{className:"DFOHosting"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Organization Info")),React.createElement("section",{className:"HostingCategoryTitle HostingCategoryTitle25"},React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB SpecialMetadataBTN"+(t.state&&t.state.change===name?" Editing":""),href:"javascript:;",onClick:function(){return t.setState({change:t.state&&t.state.change==="edit"?null:"edit"})}},"Add Metadata")))}});var DraftsController=function(t){var n=this;n.view=t};var Drafts=React.createClass({displayName:"Drafts",requiredModules:["spa/editor"],render:function(){return React.createElement("section",{className:"DraftsIndex"},React.createElement("section",{className:"DraftsActiveIndex"},React.createElement("h4",null,"Active Drafts"),React.createElement("ul",null,React.createElement("li",null,React.createElement("section",{className:"DraftBio"},React.createElement("h5",null,"Add New | ",React.createElement("span",null,"DAI Ceck Information")),React.createElement("p",null,"Deploy, BUIDL and Govern Decentralized Flexible Organizations, for a new Censorship-Resilient wave of Unstoppable dapps. DFOs are based on a new Microservices Style Developing, upgradable by voting, without needs to fork it. Basically, without points of failure and an entity to trust")),React.createElement("section",{className:"DraftAction"},React.createElement("a",{href:"javascript:;",className:"LinkVisualButton DraftActionTransaction"},"Deprecate"),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton DraftActionTransaction"},"Update"),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton DraftActionTransaction"},"Propose")),React.createElement("section",{className:"DraftAction"},React.createElement("a",{className:"LinkVisualButton",href:"javascript:;"},"Discussion"),React.createElement("a",{className:"LinkVisualButton",href:"javascript:;"},"Code"))))),React.createElement("section",{className:"DraftsOldIndex"},React.createElement("h4",null,"Deprecated Drafts"),React.createElement("ul",null,React.createElement("li",null,React.createElement("section",{className:"DraftBio"},React.createElement("h5",null,"Add New | ",React.createElement("span",null,"DAI Ceck Information")),React.createElement("p",null,"Deploy, BUIDL and Govern Decentralized Flexible Organizations, for a new Censorship-Resilient wave of Unstoppable dapps. DFOs are based on a new Microservices Style Developing, upgradable by voting, without needs to fork it. Basically, without points of failure and an entity to trust")),React.createElement("section",{className:"DraftAction"},React.createElement("p",null,"Deprecated Block:",React.createElement("br",null),"43865295"),React.createElement("a",{className:"LinkVisualButton",href:"javascript:;"},"Code"))))))}});var EditorController=function(t){var n=this;n.view=t,n.loadContent=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,n.view.emit("message","Retrieving Content Token..."),u.next=4,window.loadContent(e,t);case 4:s=u.sent,!n.view.props.secondCode&&!n.view.props.second&&n.view.editor.setValue(s);if(n.view.props.secondCode||n.view.props.second)o=n.view.editor.getModel(),o[i?"modified":"original"]=monaco.editor.createModel(s,"sol"),n.view.editor.setModel(o);n.view.contentTokenInput&&setTimeout(function(){return n.view.contentTokenInput.value=e}),n.view.emit("message"),u.next=14;break;case 11:u.prev=11,u.t0=u["catch"](0),n.view.emit("message",u.t0.message||u.t0,"error");case 14:case"end":return u.stop()}},r,this,[[0,11]])}));return t}(),n.tryCompile=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n.view.emit("smartContract/compilation",undefined),n.view.emit("smartContract/compiling"),a.prev=2,i=n.view.editor.getValue(),s=window.extractComment(i),Object.keys(s).map(function(e){return n.view.emit("comment/changed",s[e],e)});if(i){a.next=15;break}if(!window.isEthereumAddress(n.view.functionalityAddressValue)){a.next=13;break}return t!==!0&&n.view.emit("message","Retrieving Solidity version..."),a.next=11,window.SolidityUtilities.getSolcVersion(n.view.functionalityAddressValue);case 11:n.view.solidityVersion.value=a.sent,t!==!0&&n.view.emit("message");case 13:return n.view.emit("smartContract/compilation",undefined),a.abrupt("return");case 15:if(!window.getCompleteCode){a.next=21;break}return a.next=18,window.getCompleteCode(i);case 18:a.t0=a.sent,a.next=22;break;case 21:a.t0=i;case 22:i=a.t0;if(window.isEthereumAddress(n.view.functionalityAddressValue)){a.next=31;break}return t!==!0&&n.view.emit("message","Compiling SmartContract..."),a.next=27,SolidityUtilities.compile(i,n.view.solidityVersion.value,e);case 27:return o=a.sent,t!==!0&&n.view.emit("message"),n.view.emit("smartContract/compilation",o),a.abrupt("return",o);case 31:return t!==!0&&n.view.emit("message","Comparing SmartContracts..."),a.next=34,window.SolidityUtilities.compare(n.view.functionalityAddressValue,i);case 34:return u=a.sent,u&&(n.view.solidityVersion.value=u.solcVersion),t!==!0&&n.view.emit("message"),n.view.emit("smartContract/compilation",u),a.abrupt("return",u);case 41:a.prev=41,a.t1=a["catch"](2),n.view.emit("smartContract/compilation",undefined),t!==!0&&n.view.emit("message",a.t1.message||a.t1,"error");case 45:case"end":return a.stop()}},r,this,[[2,41]])}));return t}()};var Editor=React.createClass({displayName:"Editor",requiredScripts:["assets/plugins/monaco.editor/monaco.editor.min.js"],getDefaultSubscriptions:function(){return{"solc/version/change":this.changeSolcVersion,"editor/compile":this.tryCompile}},onEditor:function(t){var n=this,r=this;if(!window.monaco)return setTimeout(function(){return r.onEditor(t)},300);t&&(r.props.secondCode===undefined||r.props.secondCode===null)&&(r.props.second===undefined||r.props.second===null)&&(r.editor=window.monaco.editor.create(t,{language:r.props.lang||"sol",theme:"vs-dark",minimap:{enabled:!1},readOnly:r.props.readonly==="true"||r.props.firstCode!==undefined&&r.props.firstCode!==null||r.props.first!==undefined&&r.props.first!==null||r.props.link!==undefined&&r.props.link!==null,value:r.props.firstCode||""})).onDidChangeModelContent(function(){try{r.contentTokenInput&&(r.contentTokenInput.value=""),delete r.contentTokenValue}catch(e){}r.loadContentButton&&$(r.loadContentButton).removeClass("disabled");if(r.oneWay){delete r.oneWay;return}n.emit("smartContract/compilation",undefined)}),t&&(r.props.secondCode!==undefined&&r.props.secondCode!==null||r.props.second!==undefined&&r.props.second!==null)&&(r.editor=window.monaco.editor.createDiffEditor(t,{language:r.props.lang||"sol",theme:"vs-dark",minimap:{enabled:!1},readOnly:!0})).setModel({original:monaco.editor.createModel(r.props.firstCode||"","sol"),modified:monaco.editor.createModel(r.props.secondCode||"","sol")}),t&&r.props.link&&window.fetch(r.props.link,{mode:"no-cors"}).then(function(e){return e.text()}).then(function(e){return r.editor&&r.editor.setValue(e)}).catch(function(){return r.editor.setValue("Unable to show the code... Something shady is happening here.")}),t&&r.props.compileAtStart&&r.enqueue(r.tryCompile,500),t&&r.props.sourceLocationId&&r.loadContent(r.props.sourceLocationId,r.props.sourceLocation)},commentChanged:function(t,n){var r=window.putComment(this.editor.getValue(),n,t);r=window.putComment(r);var i=this;i.oneWay=!0,i.editor.setValue(r),setTimeout(function(){delete i.oneWay},300)},uploadFile:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);var n=t.target.files[0],r=this,i=new FileReader;i.addEventListener("load",function(){r.editor.setValue(Base64.decode(i.result.substring(i.result.indexOf(","))))},!1),i.readAsDataURL(n)},onChange:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);var n=t.target;n.dataset.change==="loadContent"&&delete this.contentTokenValue,n.dataset.change==="loadContent"&&this.loadContentButton&&$(this.loadContentButton).removeClass("disabled")},onKeyUp:function(t){if(!t||t.keyCode!==13)return this.onChange(t);t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if($(this[t.currentTarget.dataset.change+"Button"]).hasClass("disabled"))return;this[t.currentTarget.dataset.change]&&this[t.currentTarget.dataset.change](t),this.emit("editor/compile")},loadContent:function(t,n){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(t&&t.target&&$(t.target).hasClass("disabled"))return;delete this.contentTokenValue;var r=!t||t.target?this.contentTokenInput:t,i=isNaN(r)?parseInt(r.value):r;if(isNaN(i))return;var s=this;s.controller.loadContent(i,n).then(function(){s.contentTokenValue=i,s.loadContentButton&&$(s.loadContentButton).addClass("disabled"),s.contentTokenInput&&!isNaN(r)&&s.enqueue(function(){return s.contentTokenInput.value=""}),s.tryCompile()})},tryCompile:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.controller.tryCompile(200,t)},onSolidityVersion:function(t){var n=this;if(!(n.solidityVersion=t))return;window.SolidityUtilities.getCompilers().then(function(e){return n.solidityVersion&&(n.solidityVersion.innerHTML=Object.keys(e.releases).map(function(t){return'<option value="'+e.releases[t]+'">'+t+"</option>"}).join(""))})},changeSolcVersion:function(t){this.solidityVersion.value=t},recoverData:function(){var t=this;return new Promise(function(e,n){var r=parseInt(t.contentTokenInput&&t.contentTokenInput.value||0),i=function s(){var i=t.functionalityAddress.value;if(window.isEthereumAddress(i))return e([r,i]);t.controller.deploy().then(s).catch(n)};return isNaN(r)?i():t.controller.mint().then(i).catch(n)})},componentDidMount:function(){window.editorShortcut=window.editorShortcut||$(window).bind("keydown",function(e){if(e.ctrlKey||e.metaKey)switch(String.fromCharCode(e.which).toLowerCase()){case"s":e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0),$.publish("editor/compile")}}),!this.props.firstCode&&this.props.first&&this.controller.loadContent(this.props.first,this.props.firstLocation),!this.props.secondCode&&this.props.second&&this.controller.loadContent(this.props.second,this.props.secondLocation,!0)},render:function(){return React.createElement("section",{className:this.props.className},!this.props.readonly&&!this.props.firstCode&&!this.props.first&&!this.props.secondCode&&!this.props.second&&React.createElement("div",{className:"CodeEditorOptionsFrom"},React.createElement("p",{className:"CodeEditorOptionsWhat"},"Load from File: "),React.createElement("input",{className:"CodeEditorOptionsLoad",type:"file",onChange:this.uploadFile,accept:this.props.lang&&"."+this.props.lang||".sol"})),(this.props.readonly&&this.props.compileAtStart||!this.props.readonly&&!this.props.firstCode&&!this.props.first&&!this.props.secondCode&&!this.props.second)&&React.createElement("div",{className:"CodeEditorOptionsCoding"},React.createElement("p",{className:"CodeEditorOptionsWhat"},"Solidity: "),React.createElement("select",{id:"selectedSolidityVersion",className:"CodeEditorOptionsSelect",ref:this.onSolidityVersion})),React.createElement("section",{className:"NewProposaleditor",ref:this.onEditor}))}});var FarmingController=function(t){var n=this;n.view=t,n.loadFixedInflationData=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a,f,l,c,h;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return n.view.setState({fixedInflationData:null}),e={},t={loadDeployedFixedInflationContracts:function(){return _asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)}))()},deployedFixedInflationContracts:[]},p.next=5,window.blockchainCall(n.view.props.element.stateHolder.methods.toJSON);case 5:i=p.sent,i=JSON.parse(i.endsWith(",]")?i.substring(0,i.lastIndexOf(",]"))+"]":i),s=i.map(function(e){return e.name}).filter(function(e){return e.startsWith("fixedinflation.authorized.")}).map(function(e){return window.web3.utils.toChecksumAddress(e.split("fixedinflation.authorized.").join(""))}),o=s,u=Array.isArray(o),a=0,o=u?o:o[Symbol.iterator]();case 9:if(!u){p.next=15;break}if(!(a>=o.length)){p.next=12;break}return p.abrupt("break",27);case 12:f=o[a++],p.next=19;break;case 15:a=o.next();if(!a.done){p.next=18;break}return p.abrupt("break",27);case 18:f=a.value;case 19:return l=f,c=window.newContract(window.context.FixedInflationExtensionABI,l),p.next=23,window.blockchainCall(c.methods.data);case 23:h=p.sent,t.deployedFixedInflationContracts.push({address:h[0]});case 25:p.next=9;break;case 27:n.view.setState({fixedInflationData:e,dfoCore:t});case 28:case"end":return p.stop()}},r,this)}));return t}(),n.loadFixedInflationDataOld=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n.view.setState({fixedInflationData:null}),e={},t=window.newContract(window.context.uniSwapV2FactoryAbi,window.context.uniSwapV2FactoryAddress),a.prev=3,a.t0=parseInt,a.next=7,window.blockchainCall(n.view.props.element.stateHolder.methods.getUint256,"fixedInflation.blockLimit");case 7:return a.t1=a.sent,e.blockLimit=(0,a.t0)(a.t1),a.t2=parseInt,a.next=12,window.blockchainCall(n.view.props.element.stateHolder.methods.getUint256,"fixedInflation.lastBlock");case 12:return a.t3=a.sent,e.lastBlock=(0,a.t2)(a.t3),e.nextBlock=e.blockLimit+e.lastBlock,a.t4=parseInt,a.next=18,window.web3.eth.getBlockNumber();case 18:return a.t5=a.sent,i=(0,a.t4)(a.t5),e.canRun=i>=e.nextBlock,e.swapCouples=[],a.t6=parseInt,a.next=25,window.blockchainCall(n.view.props.element.stateHolder.methods.getUint256,"fixedInflation.swapCouples.length");case 25:a.t7=a.sent,s=(0,a.t6)(a.t7),o=[];for(u=0;u<s;u++)o.push(n.loadSwapCouple(t,u));return a.next=31,Promise.all(o);case 31:e.swapCouples=a.sent,a.next=37;break;case 34:a.prev=34,a.t8=a["catch"](3),console.error(a.t8);case 37:n.view.setState({fixedInflationData:e});case 38:case"end":return a.stop()}},r,this,[[3,34]])}));return t}(),n.loadSwapCouple=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.t0=window.web3.utils,s.next=3,window.blockchainCall(n.view.props.element.stateHolder.methods.getAddress,"fixedInflation.swapCouples["+t+"].from");case 3:return s.t1=s.sent,s.t2=s.t0.toChecksumAddress.call(s.t0,s.t1),s.t3=window.web3.utils,s.next=8,window.blockchainCall(n.view.props.element.stateHolder.methods.getAddress,"fixedInflation.swapCouples["+t+"].to");case 8:return s.t4=s.sent,s.t5=s.t3.toChecksumAddress.call(s.t3,s.t4),s.next=12,window.blockchainCall(n.view.props.element.stateHolder.methods.getUint256,"fixedInflation.swapCouples["+t+"].amount");case 12:return s.t6=s.sent,i={from:s.t2,to:s.t5,amount:s.t6},s.next=16,window.blockchainCall(e.methods.getPair,i.from,i.to);case 16:return i.pairAddress=s.sent,s.t7=i.from,s.t8=window.newContract(window.context.votingTokenAbi,i.from),s.next=21,window.loadLogo(i.from===window.wethAddress?window.voidEthereumAddress:i.from);case 21:s.t9=s.sent,i.from={address:s.t7,token:s.t8,logo:s.t9};if(i.from.address!==window.wethAddress){s.next=27;break}s.t10=18,s.next=30;break;case 27:return s.next=29,window.blockchainCall(i.from.token.methods.decimals);case 29:s.t10=s.sent;case 30:i.from.decimals=s.t10;if(i.from.address!==window.wethAddress){s.next=35;break}s.t11="Ethereum",s.next=38;break;case 35:return s.next=37,window.blockchainCall(i.from.token.methods.name);case 37:s.t11=s.sent;case 38:i.from.name=s.t11;if(i.from.address!==window.wethAddress){s.next=43;break}s.t12="ETH",s.next=46;break;case 43:return s.next=45,window.blockchainCall(i.from.token.methods.symbol);case 45:s.t12=s.sent;case 46:return i.from.symbol=s.t12,s.t13=i.to,s.t14=window.newContract(window.context.votingTokenAbi,i.to),s.next=51,window.loadLogo(i.to===window.wethAddress?window.voidEthereumAddress:i.to);case 51:s.t15=s.sent,i.to={address:s.t13,token:s.t14,logo:s.t15};if(i.to.address!==window.wethAddress){s.next=57;break}s.t16=18,s.next=60;break;case 57:return s.next=59,window.blockchainCall(i.to.token.methods.decimals);case 59:s.t16=s.sent;case 60:i.to.decimals=s.t16;if(i.to.address!==window.wethAddress){s.next=65;break}s.t17="Ethereum",s.next=68;break;case 65:return s.next=67,window.blockchainCall(i.to.token.methods.name);case 67:s.t17=s.sent;case 68:i.to.name=s.t17;if(i.to.address!==window.wethAddress){s.next=73;break}s.t18="ETH",s.next=76;break;case 73:return s.next=75,window.blockchainCall(i.to.token.methods.symbol);case 75:s.t18=s.sent;case 76:return i.to.symbol=s.t18,s.abrupt("return",i);case 78:case"end":return s.stop()}},r,this)}));return t}(),n.loadStakingData=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.view.setState({stakingData:null}),t.t0=n.view,t.next=4,window.loadStakingData(n.view.props.element,!0);case 4:t.t1=t.sent,t.t0.setState.call(t.t0,t.t1);case 6:case"end":return t.stop()}},r,this)}));return t}(),n.loadOldStakingData=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.view.setState({loadingOldStakingData:!0}),r.next=3,window.loadStakingData(n.view.props.element,!1);case 3:e=r.sent,e.loadingOldStakingData=null,e.oldStakingData=e.stakingData,delete e.stakingData,n.view.setState(e);case 8:case"end":return r.stop()}},r,this)}));return t}()};ImportReact({name:"FixedInflationEdit",requiredScripts:["spa/imported/shared/Input.jsx","spa/imported/shared/Coin.jsx","spa/imported/shared/TokenInput.jsx","spa/imported/shared/Loading.jsx","spa/imported/inflation/CreateOrEditFixedInflation.jsx","spa/imported/inflation/CreateOrEditFixedInflationEntry.jsx","spa/imported/inflation/CreateOrEditFixedInflationEntryOperation.jsx"],className:"DappBox",render:"CreateOrEditFixedInflation"});function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}var FixedInflationView=React.createClass({displayName:"FixedInflationView",requiredScripts:["spa/loaderMinimino.jsx","spa/farming/fixedInflation/edit.jsx","spa/farming/fixedInflation/viewWrapped.jsx"],getDefaultSubscriptions:function(){var t=this;return{"fixedInflation/edit/open":function(n){t.emit("edit/toggle",!0,function(){return t.setState({edit:!0,fixedInflationContractAddress:n})})}}},cancelEdit:function(){this.setState({edit:!1,fixedInflationContractAddress:null,cancelEdit:null})},calculateTimeTier:function(){return!this.props||!this.props.fixedInflationData||!this.props.fixedInflationData.blockLimit?"":window.calculateTimeTier(this.props.fixedInflationData.blockLimit)},runFixedInflation:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this;this.emit("message"),window.blockchainCall(this.props.element.dFO.methods.submit,"fixedInflation","0x").then(function(){return n.emit("fixedInflation/refresh")}).catch(function(e){return n.emit("message",e.message||e,"error")})},componentDidUpdate:function(){this.state&&this.state.edit&&!this.props.edit&&this.setState({edit:!1})},render:function(){var t=this,n={};return this.props&&Object.entries(this.props).forEach(function(e){return n[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return n[e[0]]=e[1]}),delete n.props,React.createElement("ul",{className:"DFOHosting DFOHostingBBBB"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Inflation"),this.props.edit&&!n.fixedInflationContractAddress&&React.createElement("a",{href:"javascript:;",onClick:function(){return t.setState({edit:!t.state||!t.state.edit})},className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"+(t.state&&t.state.edit?"EditDFOYo Editing":"")},"Create")),(!this.state||!this.state.edit)&&(!this.props||!this.props.fixedInflationData)&&React.createElement(LoaderMinimino,null),(!this.state||!this.state.edit)&&n.dfoCore&&n.dfoCore.deployedFixedInflationContracts&&n.dfoCore.deployedFixedInflationContracts.length===0&&React.createElement("h4",null,"No Fixed inflation data"),(!this.state||!this.state.edit)&&n.dfoCore&&React.createElement(FixedInflationViewWrapped,_extends({},n,{edit:this.props.edit})),this.props&&this.props.edit&&this.state&&this.state.edit&&React.createElement(FixedInflationEdit,_extends({},n,{cancelEdit:this.cancelEdit})))}});ImportReact({name:"FixedInflationViewWrapped",requiredScripts:["spa/imported/shared/Input.jsx","spa/imported/shared/Coin.jsx","spa/imported/shared/TokenInput.jsx","spa/imported/shared/Loading.jsx","spa/imported/shared/Link.jsx","spa/imported/inflation/Explore.jsx","spa/imported/inflation/ExploreInflationContract.jsx","spa/imported/inflation/FixedInflationComponent.jsx"],className:"DappBox",render:"Explore"});ImportReact({name:"StakingEdit",requiredScripts:["spa/imported/shared/Input.jsx","spa/imported/shared/Coin.jsx","spa/imported/shared/TokenInput.jsx","spa/imported/farm/Create.jsx"],getInitialState:function(){var t=this;return{farmingContract:t.props.farmingContract,farmingSetups:t.props.farmingSetups,creationStep:t.props.creationStep,setFarmingContractStep:function(n){t.setState({creationStep:n})},updateFarmingContract:function(n){t.setState({farmingContract:n})},addFarmingSetup:function(n){var r=t.state.farmingSetups.map(function(e){return e});r.push(n),t.setState({farmingSetups:r})},removeFarmingSetup:function(n){var r=t.state.farmingSetups.map(function(e){return e});r.splice(n,1),t.setState({farmingSetups:r})},dfoCore:{loadDeployedFarmingContracts:function(){return _asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[]);case 1:case"end":return t.stop()}},t,this)}))()}}}},className:"DappBox",render:"Create"});var StakingEditOld=React.createClass({displayName:"StakingEditOld",requiredScripts:["spa/loaderMinimino.jsx","spa/uniswapTokenPicker.jsx"],getInitialState:function(){var t={tiers:[],pairs:[],blockNumber:this.props.blockTiers&&Object.values(this.props.blockTiers)[0].averages[1]||null};return t},deleteTier:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=parseInt(t.currentTarget.dataset.index),r=this.state.tiers[n];this.state.tiers.splice(n,1);var i=this;this.setState({tiers:this.state.tiers,tier:r.tierKey,blockNumber:r.tierKey==="Custom"?r.blockNumber:null},function(){i.customBlockNumber&&(i.customBlockNumber.value=r.blockNumber),i.rewardSplitTranchesInput&&(i.rewardSplitTranchesInput.value=r.rewardSplitTranche),!i.customBlockNumber&&(i.domRoot.children().find('input[type="radio"][data-value="'+r.blockNumber+'"]')[0].checked=!0),i.hardCapInput.value=window.fromDecimals(r.hardCap,i.props.element.decimals),i.minCapInput.value=window.fromDecimals(r.minCap,i.props.element.decimals),i.rewardPercentageInput.value=window.formatMoney(r.percentage)})},addTier:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.emit("message");var n="0";try{n=window.toDecimals(this.hardCapInput.value.split(",").join(""),this.props.element.decimals)}catch(t){}if(isNaN(parseInt(n))||parseInt(n)<=0)return this.emit("message","Hard Cap must be a valid positive number","error");var r="0";try{r=window.toDecimals(this.minCapInput.value.split(",").join(""),this.props.element.decimals)}catch(t){}if(isNaN(parseInt(r))||parseInt(r)<=0)return this.emit("message","Min Cap must be a valid positive number","error");var i="0";try{i=(this.customBlockNumber?this.customBlockNumber.value:this.domRoot.children().find('input[type="radio"]:checked')[0].dataset.value).split(",").join("")}catch(t){}if(isNaN(parseInt(i))||parseInt(i)<=0)return this.emit("message","Block Limit must be a valid positive number","error");var s=0;try{s=this.rewardSplitTranchesInput?this.rewardSplitTranchesInput.value:this.props.blockTiers[this.state.tier].weeks}catch(t){}if(this.rewardSplitTranchesInput&&(isNaN(parseInt(s))||parseInt(s)<=0))return this.emit("message","Split amount must be a valid positive number","error");var o=0;try{o=parseFloat(this.rewardPercentageInput.value.split(",").join(""))}catch(t){}if(isNaN(o)||o<=0)return this.emit("message","Percentage must be a positive number","error");var u;try{u=this.rewardTokenPicker&&this.rewardTokenPicker.state&&!isNaN(this.rewardTokenPicker.state.selected)&&this.state.tokensList[this.rewardTokenPicker.state.key][this.rewardTokenPicker.state.selected].address}catch(t){}if(!u)return this.emit("message","Reward Token is mandatory","error");var a;try{a=this.mainTokenPicker&&this.mainTokenPicker.state&&!isNaN(this.mainTokenPicker.state.selected)&&this.state.tokensList[this.mainTokenPicker.state.key][this.mainTokenPicker.state.selected].address}catch(t){}if(!a)return this.emit("message","Main Token is mandatory","error");if(!this.state||!this.state.pairs||this.state.pairs.length===0)return this.emit("message","You must choose at least a pair","error");var f=this.state&&this.state.tiers||[];f.push({hardCap:n,minCap:r,blockNumber:i,percentage:o,time:window.calculateTimeTier(i),tierKey:window.getTierKey(i),rewardSplitTranche:s});var l=this;this.setState({tiers:f,blockNumber:null,tier:null},function(){l.customBlockNumber&&(l.customBlockNumber.value=""),l.rewardSplitTranchesInput&&(l.rewardSplitTranchesInput.value=""),l.hardCapInput.value="",l.minCapInput.value="",l.rewardPercentageInput.value="",l.onTierChange({currentTarget:{value:Object.keys(l.props.blockTiers)[0]}})})},onTierChange:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this.props.blockTiers[t.currentTarget.value];n=n?n.averages[1]:null,this.setState({blockNumber:n,tier:t.currentTarget.value})},onBlockLimitChange:function(t){this.setState({blockNumber:parseInt(t.currentTarget.dataset.value)})},onNewPair:function(t){if(!t)return;this.pairPicker&&this.pairPicker.setState({selected:null});var n=this.mainTokenPicker&&this.mainTokenPicker.state&&!isNaN(this.mainTokenPicker.state.selected)&&this.state.tokensList[this.mainTokenPicker.state.key][this.mainTokenPicker.state.selected].address;t.address===n&&this.mainTokenPicker.setState({selected:null});var r=this.state&&this.state.pairs||[];for(var i=r,s=Array.isArray(i),o=0,i=s?i:i[Symbol.iterator]();;){var u;if(s){if(o>=i.length)break;u=i[o++]}else{o=i.next();if(o.done)break;u=o.value}var a=u;if(a.address===t.address)return}r.push(t),this.setState({pairs:r})},onNewMainToken:function(t){if(!t)return;var n=this.state&&this.state.pairs||[],r;for(var i=0;i<n.length;i++){var s=n[i];if(s.address===t.address){r=i;break}}!isNaN(r)&&n.splice(r,1),this.setState({pairs:n})},deletePair:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.state.pairs.splice(parseInt(t.currentTarget.dataset.index),1),this.setState({pairs:this.state.pairs})},proposeNewStaking:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.emit("message");var n=parseInt(this.startBlockInput.value);if(isNaN(n)||n<0)return this.emit("message","Start Block must be a number greater than 0","error");var r=parseInt(this.endBlockInput.value);if(isNaN(r)||r<0)return this.emit("message","End Block must be a number greater than 0","error");var i=this.state&&this.state.pairs||[];if(i.length===0)return this.emit("message","Please select at least a pair","error");var s=this.state&&this.state.tiers||[];if(s.length===0)return this.emit("message","You must add at least a tier","error");for(var o=s,u=Array.isArray(o),a=0,o=u?o:o[Symbol.iterator]();;){var f;if(u){if(a>=o.length)break;f=o[a++]}else{a=o.next();if(a.done)break;f=a.value}var l=f;l.timeWindow=l.blockNumber;var c=window.calculateMultiplierAndDivider(l.percentage);l.rewardMultiplier=c[0],l.rewardDivider=c[1]}var h=this.mainTokenPicker&&this.mainTokenPicker.state&&!isNaN(this.mainTokenPicker.state.selected)&&this.state.tokensList[this.mainTokenPicker.state.key][this.mainTokenPicker.state.selected].address;if(!h)return this.emit("message","Main Token is mandatory","error");for(var p=i,d=Array.isArray(p),v=0,p=d?p:p[Symbol.iterator]();;){var m;if(d){if(v>=p.length)break;m=p[v++]}else{v=p.next();if(v.done)break;m=v.value}var g=m;if(g.address===h)return this.emit("message","Main Token cannot be in the pair list","error")}var y=this.rewardTokenPicker&&this.rewardTokenPicker.state&&!isNaN(this.rewardTokenPicker.state.selected)&&this.state.tokensList[this.rewardTokenPicker.state.key][this.rewardTokenPicker.state.selected].address;if(!y)return this.emit("message","Reward Token is mandatory","error");window.stake(this,n,r,h,y,i.map(function(e){return e.address}),s)},onHardCapChange:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.hardCapChangeTimeout&&window.clearTimeout(this.hardCapChangeTimeout);var n=this;this.hardCapChangeTimeout=window.setTimeout(function(){var e=window.formatMoney(parseFloat(n.hardCapInput.value.split(",").join())/1e3);isNaN(parseFloat(e.split(",").join("")))&&(e="0.00"),n.minCapInput.value=e},300)},componentDidMount:function(){var t=this;window.loadOffChainWallets().then(function(e){return t.setState({tokensList:e})}),this.onTierChange({currentTarget:{value:Object.keys(this.props.blockTiers)[0]}})},render:function(){var t=this,n=this;if(!n.props.stakingData)return React.createElement(LoaderMinimino,null);var r;try{r=this.rewardTokenPicker&&this.rewardTokenPicker.state&&!isNaN(this.rewardTokenPicker.state.selected)&&this.state.tokensList[this.rewardTokenPicker.state.key][this.rewardTokenPicker.state.selected]}catch(i){}var s;try{s=this.mainTokenPicker&&this.mainTokenPicker.state&&!isNaN(this.mainTokenPicker.state.selected)&&this.state.tokensList[this.mainTokenPicker.state.key][this.mainTokenPicker.state.selected]}catch(i){}return React.createElement("section",null,React.createElement("p",{className:"WOWDescription2"},'Before creating a Liquidity Mining Mechanism, be sure there are already existing Uniswap V2 Liquidity pools for the DFO Voting Token. Be also assured that the DFO wallet has enough funds to cover the rewards. The min Stake is a critical feature to ensure that the maximum number of open positions are supported by the Ethereum Virtual Machine without receiving a general "Out Of Gas" error and makes it impossible for stakers to redeem their funds.'),React.createElement("section",{className:"TheDappInfo1"},React.createElement("section",{className:"DFOTitleSection BravPicciot"},React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"Start Block:")),React.createElement("input",{type:"number",ref:function(r){return(t.startBlockInput=r)&&!n.firstTime&&(n.firstTime=!0)&&(r.value="0")},min:"0"}),React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"End Block:")),React.createElement("input",{type:"number",ref:function(r){return(t.endBlockInput=r)&&!n.firstTime&&(n.firstTime=!0)&&(r.value="0")},min:"0"}),React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"Reward With:")),React.createElement(UniswapTokenPicker,{readOnly:this.state&&this.state.tiers&&this.state.tiers.length>0,ref:function(n){return t.rewardTokenPicker=n},tokensList:this.state.tokensList,exceptFor:window.wethAddress,onChange:function(){return n.forceUpdate()}}),React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"Main Token:")),React.createElement(UniswapTokenPicker,{readOnly:this.state&&this.state.tiers&&this.state.tiers.length>0,ref:function(n){return t.mainTokenPicker=n},tokensList:this.state.tokensList,exceptFor:window.wethAddress,onChange:this.onNewMainToken}),React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"Pairs:")),this.state.pairs.map(function(e,r){return React.createElement("a",{key:e.address,href:"javascript:;",className:"DFOHostingTag"},React.createElement("img",{src:e.logo}),e.symbol,(!t.state||!t.state.tiers||t.state.tiers.length===0)&&React.createElement("a",{className:"ChiudiQuella ChiudiQuellaGigi",href:"javascript:;","data-index":r,onClick:n.deletePair},"X"))}),!1,React.createElement(UniswapTokenPicker,{readOnly:this.state&&this.state.tiers&&this.state.tiers.length>0,ref:function(n){return t.pairPicker=n},tokensList:this.state.tokensList,onChange:this.onNewPair}))),React.createElement("section",{className:"TheDappInfo2"},React.createElement("section",{className:"DFOTitleSection BravPicciot"},React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"Tiers:")),React.createElement("section",{className:"OVaglio"},React.createElement("p",null,"Locking Period:"),React.createElement("select",{onChange:this.onTierChange},Object.keys(n.props.blockTiers).map(function(e){return React.createElement("option",{key:e,value:e,selected:n.state.tier===e},e)}),React.createElement("option",{value:"Custom",selected:n.state.tier==="Custom"},"Custom")),(!this.state||this.state.tier!=="Custom")&&React.createElement("ul",null,React.createElement("p",null,"Blocks:"),n.props.blockTiers[this.state&&this.state.tier||Object.keys(n.props.blockTiers)[0]].averages.map(function(e){return React.createElement("li",{key:e},React.createElement("label",null,React.createElement("input",{className:"AMeMoPiach",type:"radio","data-value":e,name:"blockNumber",onChange:t.onBlockLimitChange,ref:function(r){return r&&(r.checked=t.state.blockNumber===e)}}),React.createElement("span",null,React.createElement("b",null,e))))})),this.state&&this.state.tier==="Custom"&&React.createElement("section",null,React.createElement("label",null,React.createElement("p",null,"Value:"),React.createElement("input",{type:"number",min:"1",placeholder:"Custom block number...",ref:function(n){return t.customBlockNumber=n}})),React.createElement("label",null,React.createElement("p",null,"Tranches amount:"),React.createElement("input",{type:"number",min:"1",ref:function(n){return t.rewardSplitTranchesInput=n}}))),this.state&&this.state.tier&&this.state.tier!=="Custom"&&React.createElement("p",null,n.props.blockTiers[this.state.tier].weeks," Tranches (Weeks)")),React.createElement("section",{className:"OVaglio"},React.createElement("label",null,React.createElement("p",null,"Max Simultaneous Stake:"),React.createElement("input",{ref:function(n){return t.hardCapInput=n},type:"text",placeholder:"Amount",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$",onKeyUp:this.onHardCapChange})),React.createElement("label",null,React.createElement("p",null,"Min to Stake:"),React.createElement("input",{ref:function(n){return t.minCapInput=n},type:"text",placeholder:"Amount",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$",disabled:!0})),React.createElement("label",null,React.createElement("p",null,"Reward Percentage:"),React.createElement("aside",null,React.createElement("input",{ref:function(n){return t.rewardPercentageInput=n},type:"number",min:"0",placeHoder:"Insert a percentage"})," %"))),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonG LinkVisualButtonBIGGA",onClick:this.addTier},"Add"))),this.state&&this.state.tiers&&React.createElement("ul",null,this.state.tiers.map(function(e,t){return React.createElement("li",{key:e.blockNumber,className:"TheDappInfoAll TheDappInfoSub"},React.createElement("section",{className:"TheDappInfo1"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("img",{src:r.logo}),React.createElement("b",null,r.symbol)," for ",e.time),React.createElement("h5",{className:"DFOHostingTitle"},"Reward: ",React.createElement("b",{className:"DFOHostingTitleG"},window.formatMoney(e.percentage),"%")),React.createElement("h5",{className:"DFOHostingTitle"},"by staking ",React.createElement("img",{src:s.logo}),React.createElement("b",null,s.symbol)),React.createElement("p",{className:"DFOHostingTitle"},"Distribution: ",React.createElement("b",null,"Weekly")),React.createElement("p",{className:"DFOLabelTitleInfosmall"},"DEX: 🦄 V2 "))),n.state&&n.state.pairs&&React.createElement("section",{className:"TheDappInfo1"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,"Pairs:")),n.state.pairs.map(function(e){return React.createElement("a",{key:e.address,href:window.getNetworkElement("etherscanURL")+"token/"+e.address,target:"_blank",className:"DFOHostingTag"},React.createElement("img",{src:e.logo}),e.symbol)}))),React.createElement("section",{className:"TheDappInfo05"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("span",{className:"DFOHostingTitleS"},"Min Cap:"),React.createElement("h5",{className:"DFOHostingTitle"},React.createElement("b",null,window.fromDecimals(e.minCap,n.props.element.decimals))),React.createElement("span",{className:"DFOHostingTitleS DFOHostingTitleG"},"Hard Cap:"),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleG"},React.createElement("b",null,window.fromDecimals(e.hardCap,n.props.element.decimals))))),React.createElement("a",{className:"ChiudiQuella ChiudiQuellaGigi","data-index":t,onClick:n.deleteTier},"X"))})),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB LinkVisualButtonBIGGAMaNNTROPAAAA",onClick:this.proposeNewStaking},"Propose New Liquidity Mining"))}});function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}var StakingView=React.createClass({displayName:"StakingView",requiredScripts:["spa/loaderMinimino.jsx","spa/farming/staking/edit.jsx","spa/farming/staking/edit_old.jsx","spa/imported/farm/ExploreFarmingContract.jsx","spa/imported/farm/FarmingComponent.jsx","spa/imported/farm/SetupComponent.jsx","spa/imported/shared/Input.jsx","spa/imported/shared/Coin.jsx","spa/imported/shared/TokenInput.jsx","spa/imported/shared/ApproveButton.jsx","spa/imported/farm/CreateOrEditFarmingSetup.jsx","spa/imported/farm/CreateOrEditFarmingSetups.jsx"],requiredModules:["spa/stake","spa/stake_old"],getDefaultSubscriptions:function(){var t=this;return{"stake/close":function(){return t.setState({stakeToShow:null})}}},cancelEdit:function(){this.setState({edit:!1,farmingContract:null,cancelEdit:null})},showStake:function(t,n){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.setState({stakeToShow:n})},stopStake:function(t,n){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),window.stopStake(this,n.stakingManager.options.address)},componentDidMount:function(){var t=this,n=!t.props.element.logo;t.props.element.logo=t.props.element.logo||t.props.element.logoUri||t.props.element.logoURI,t.props.element.logo&&n&&t.forceUpdate(),!t.props.element.logo&&window.loadLogo(t.props.element.token.options.address).then(function(e){t.props.element.logo=e,t.forceUpdate()})},renderFarmData:function(t){var n=_extends({},this.getProps(),{farmAddress:t.contract.options.address});return t.readonly&&delete n.edit,React.createElement(ExploreFarmingContract,n)},renderStakingData:function(t){var n=this;if(!t.old)return this.renderFarmData(t);var r=this,i=[];return i.push.apply(i,t.tiers.map(function(e){return React.createElement("li",{key:e.blockNumber,className:"TheDappInfoAll TheDappInfoSub KingJulianAlwaysWatchingYou"},React.createElement("section",{className:"TheDappInfo1 TheDappInfoYY"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleTTT"},"Earn ",React.createElement("img",{src:window.formatLink(t.rewardToken.logoUri||t.rewardToken.logoURI||t.rewardToken.logo)}),React.createElement("b",null,t.rewardToken.symbol)),React.createElement("p",{className:"DFOHostingTitle DFOHostingTitleTTT"}," by lock liquidity with:"),React.createElement("a",{className:"DFOHostingTag DFOHostingTag4"},React.createElement("img",{src:window.formatLink((t.mainToken||e.mainToken).logoUri||(t.mainToken||e.mainToken).logoURI||(t.mainToken||e.mainToken).logo)}),(t.mainToken||e.mainToken).symbol),React.createElement("p",{className:"DFOHostingTitle DFOHostingTitleTTT"},"and:"),t.pairs.map(function(e){return React.createElement("a",{key:e.address,href:window.getNetworkElement("etherscanURL")+"token/"+e.address,target:"_blank",className:"DFOHostingTag DFOHostingTag4"},React.createElement("img",{src:window.formatLink(e.logo)}),e.symbol)}),React.createElement("p",null,"Via Uniswap V2"))),React.createElement("section",{className:"TheDappInfo1 TheDappInfoYY"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleTTT"},"Total Reward: ",React.createElement("b",{className:"DFOHostingTitleG"},window.formatMoney(e.percentage),"%")),React.createElement("p",{className:"DFOHostingTitle DFOHostingTitleTTT TheDappInfoX"},"Reward Distribution: ",React.createElement("b",null,"Weekly")),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleTTT"},"Lock time: ",React.createElement("b",null,"~",e.tierKey),React.createElement("span",null,e.blockNumber," Blocks")),t.active&&t.running&&React.createElement("p",{className:"DFOHostingTitle DFOHostingTitleTTT TheDappInfoX"},"You can open Liquidity Mining positions",t.endBlock&&React.createElement("span",null," until the block n. ",React.createElement("b",null,React.createElement("a",{target:"_blank",href:window.getNetworkElement("etherscanURL")+"block/"+t.endBlock},t.endBlock)))),t.active&&t.terminated&&React.createElement("p",{className:"DFOHostingTitle DFOHostingTitleTTT TheDappInfoX"},"Liquidity Mining Contract closed until the block ",React.createElement("b",null,React.createElement("a",{target:"_blank",href:window.getNetworkElement("etherscanURL")+"block/"+t.endBlock},t.endBlock)),", you can only redeem for opened positions."),t.active&&!t.started&&React.createElement("p",{className:"DFOHostingTitle DFOHostingTitleTTT TheDappInfoX"},"This Liquidity Mining will start at the block n. ",React.createElement("b",null,React.createElement("a",{target:"_blank",href:window.getNetworkElement("etherscanURL")+"block/"+t.startBlock},t.startBlock)),"."))),React.createElement("section",{className:"TheDappInfo1 TheDappInfoYY"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("span",{className:"DFOHostingTitleS"},"Staked:"),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleTTT"},React.createElement("b",null,window.fromDecimals(e.staked,r.props.element.decimals))),React.createElement("span",{className:"DFOHostingTitleS DFOHostingTitleG"},"Available:"),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitleTTT DFOHostingTitleG"},React.createElement("b",null,window.fromDecimals(e.remainingToStake,r.props.element.decimals))),React.createElement("a",{href:"javascript:;",onClick:function(r){return n.showStake(r,t)},className:"LinkVisualButton LinkVisualPropose LinkVisualButtonG"},"🥩 ",t.active?"Stake":"Redeem"),n.props&&n.props.edit&&t.active&&React.createElement("a",{href:"javascript:;",onClick:function(r){return n.stopStake(r,t)},className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"},"Stop"))))})),i},getProps:function(){var t={};return this.props&&Object.entries(this.props).forEach(function(e){return t[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return t[e[0]]=e[1]}),delete t.props,t},render:function(){var t=this,n=this,r=this.getProps();if(r.stakeToShow)return React.createElement(r.stakeToShow.old?StakeOld:Stake,{element:r.element,stakingData:r.stakeToShow});var i=(!this.state||!this.state.edit)&&this.props&&this.props.oldStakingData&&this.props.oldStakingData,s=i&&i.filter(function(e){return!e.old});return s&&s.forEach(function(e){return e.readonly=!0}),i=i&&i.filter(function(e){return e.old}),React.createElement("ul",{className:"DFOHosting HostingCategoryTitleYYY"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Active Farming Contracts"),this.props.edit&&React.createElement("a",{href:"javascript:;",onClick:function(){return n.setState({edit:!n.state||!n.state.edit,farmingContract:null})},className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"+(n.state&&n.state.edit?"EditDFOYo Editing":"")},n.state&&n.state.edit?"Close":"New")),this.props&&this.props.edit&&this.state&&this.state.edit&&r.stakingData&&r.stakingData.old&&React.createElement(StakingEditOld,r),this.props&&this.props.edit&&this.state&&this.state.edit&&r.stakingData&&!r.stakingData.old&&React.createElement(StakingEdit,r),(!this.state||!this.state.edit)&&(!this.props||!this.props.stakingData)&&React.createElement(LoaderMinimino,null),(!this.state||!this.state.edit)&&this.props&&this.props.stakingData&&this.props.stakingData.length===0&&React.createElement("h4",null,"No Farming Contracts ",React.createElement("a",{href:"javascript:;",onClick:function(){return n.emit("edit/toggle",!0,function(){return n.setState({edit:!0})})},className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"},"Create")),(!this.state||!this.state.edit)&&this.props&&this.props.stakingData&&this.props.stakingData.length>0&&React.createElement("section",{className:"DappBox"},this.props.stakingData.map(this.renderStakingData)),(!this.state||!this.state.edit)&&React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Farming Contracts History"),(!this.state||!this.state.edit)&&this.props&&!this.props.oldStakingData&&!this.props.loadingOldStakingData&&React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB",onClick:function(){return t.emit("staking/old")}},"Redeem and manage positions from old LM contracts")),(!this.state||!this.state.edit)&&this.props&&this.props.loadingOldStakingData&&React.createElement(LoaderMinimino,null),(!this.state||!this.state.edit)&&this.props&&this.props.oldStakingData&&this.props.oldStakingData.length===0&&React.createElement("h4",null,"No data"),s&&s.length>0&&React.createElement("section",{className:"DappBox"},s.map(this.renderFarmData)),i&&i.map(this.renderStakingData))}});var Farming=React.createClass({displayName:"Farming",requiredScripts:["spa/loaderMini.jsx","spa/okBoomer.jsx","spa/loaderMinimino.jsx","spa/farming/fixedInflation/view.jsx","spa/farming/staking/view.jsx","spa/loaderMini.jsx"],getDefaultSubscriptions:function(){return{"staking/refresh":this.controller.loadStakingData,"fixedInflation/refresh":this.controller.loadFixedInflationData,"staking/old":this.controller.loadOldStakingData}},componentWillUnmount:function(){delete this.didMountCalled},componentDidMount:function(){if(this.didMountCalled)return;this.didMountCalled=!0;var t=this;t.setState({cumulativeLoading:!0},function(){Promise.all([t.controller.loadFixedInflationData(),t.controller.loadStakingData()]).then(function(){t.setState({cumulativeLoading:!1})})})},render:function(){var t={};return this.props&&Object.entries(this.props).forEach(function(e){return t[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return t[e[0]]=e[1]}),React.createElement("section",{className:"DFOOverview"},(!this.state||this.state.cumulativeLoading)&&[React.createElement("br",null),React.createElement("br",null),React.createElement(LoaderMini,null)],this.state&&this.state.cumulativeLoading===!1&&React.createElement(StakingView,t),this.state&&this.state.cumulativeLoading===!1&&React.createElement(FixedInflationView,t))}});var FunctionsController=function(t){var n=this;n.view=t,n.loadFunctionalities=function(){var t=n.view.props.element;if(!n.view||!n.view.mountDate)return;var r=n.view.mountDate,i=function(){function i(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function s(e){var i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.t0=JSON,o.next=3,window.blockchainCall(n.view.props.element.functionalitiesManager.methods.functionalityToJSON,e);case 3:o.t1=o.sent,i=n.view.state.functionalities[e]=o.t0.parse.call(o.t0,o.t1);if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){o.next=7;break}return o.abrupt("return");case 7:return o.prev=7,o.t2=window,o.next=11,window.blockchainCall(window.newContract(window.context.IFunctionalityAbi,i.location).methods.getMetadataLink);case 11:o.t3=o.sent,i.metadataLink=o.t2.formatLink.call(o.t2,o.t3);if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){o.next=15;break}return o.abrupt("return");case 15:return o.next=17,window.AJAXRequest(i.metadataLink);case 17:i.metadata=o.sent;if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){o.next=20;break}return o.abrupt("return");case 20:Object.entries(i.metadata).forEach(function(e){return i[e[0]]=e[1]}),i.description=window.extractHTMLDescription(i.description||i.code),o.next=26;break;case 24:o.prev=24,o.t4=o["catch"](7);case 26:i.inputParameters=[];try{i.inputParameters=i.methodSignature.split(i.methodSignature.substring(0,i.methodSignature.indexOf("(")+1)).join("").split(")").join(""),i.inputParameters=i.inputParameters?i.inputParameters.split(","):[]}catch(u){}o.prev=28;if(i.code){o.next=40;break}o.t5=i.code;if(o.t5){o.next=35;break}return o.next=34,window.loadContent(i.sourceLocationId,i.sourceLocation);case 34:o.t5=o.sent;case 35:i.code=o.t5;if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){o.next=38;break}return o.abrupt("return");case 38:i.codeName!=="getEmergencySurveyStaking"&&i.sourceLocationId===0&&delete i.code,i.description=window.extractHTMLDescription(i.code);case 40:o.next=44;break;case 42:o.prev=42,o.t6=o["catch"](28);case 44:return o.next=46,window.searchForCodeErrors(i.location,i.code,i.codeName,i.methodSignature,i.replaces,!0);case 46:i.compareErrors=o.sent,i.compareErrors&&i.compareErrors.length>0&&console.log(i.name,i.compareErrors.join(" - "));if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){o.next=50;break}return o.abrupt("return");case 50:n.view.setState({functionalities:n.view.state.functionalities}),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,window.searchForCodeErrors(i.location,i.code,i.codeName,i.methodSignature,i.replaces,!0);case 4:i.compareErrors=s.sent,i.compareErrors&&i.compareErrors.length>0&&console.log(i.codeName,i.sourceLocation,i.sourceLocationId,i.compareErrors.join(" - "));if(!!n.view&&n.view.mountDate===r&&t===n.view.props.element){s.next=8;break}return s.abrupt("return");case 8:n.view.setState({functionalities:n.view.state.functionalities});case 9:case"end":return s.stop()}},a,this)})),300);case 52:case"end":return o.stop()}},s,this,[[7,24],[28,42]])}));return i}();n.view.state.functionalityNames.forEach(i)},n.call=function(){function t(t,n,r,i,s,o){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i,s,o,u){var a;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return i&&u&&e!=="read"&&s.unshift(0),i&&u&&s.unshift(window.voidEthereumAddress),i&&(s=window.web3.eth.abi.encodeParameters(i,s)),f.next=5,window.blockchainCall(n.view.props.element.dFO.methods[e],t,s);case 5:return a=f.sent,f.abrupt("return",e==="read"?n.stringifyParameters(window.web3.eth.abi.decodeParameters(o,a)):"");case 7:case"end":return f.stop()}},r,this)}));return t}(),n.stringifyParameters=function(t){var n=[],r=parseInt(t.__length__);for(var i=0;i<r;i++)n.push(t[i+""]);return JSON.stringify(n)},n.deleteFunction=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0),t=[{name:"Publishing Proposal...",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,window.blockchainCall(t.element.dFO.methods.newProposal,"",t.emergency||!1,window.voidEthereumAddress,0,window.voidEthereumAddress,!1,"","",!1,!1,t.codeName);case 2:t.transaction=r.sent,t.element.minimumStaking||(n.view.emit("loader/toggle",!1),n.view.emit("message","Proposal Sent!","info"),n.view.emit("section/change","Proposals"));case 4:case"end":return r.stop()}},r,this)}))()}}],!isNaN(parseInt(n.view.props.element.minimumStaking))&&parseInt(n.view.props.element.minimumStaking)>0&&t.push({name:"Sending Initial "+window.fromDecimals(n.view.props.element.minimumStaking,n.view.props.element.decimals)+" "+n.view.props.element.symbol+" for Staking",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,window.blockchainCall(t.element.token.methods.transfer,t.transaction.events.Proposal.returnValues.proposal,window.numberToString(t.element.minimumStaking));case 2:n.view.emit("loader/toggle",!1),n.view.emit("message","Proposal Sent!","info"),n.view.emit("section/change","Proposals");case 5:case"end":return r.stop()}},r,this)}))()}}),i.abrupt("return",n.view.emit("loader/toggle",!0,t,{title:'Propose to delete Functionalty "'+e.currentTarget.dataset.codename+'"',element:n.view.props.element,codeName:e.currentTarget.dataset.codename}));case 4:case"end":return i.stop()}},r,this)}));return t}()};var Functions=React.createClass({displayName:"Functions",requiredModules:["spa/editor"],requiredScripts:["spa/loaderMini.jsx"],getInitialState:function(){return{functionalities:{},functionalityNames:[]}},change:function e(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.target,r=this,e=function i(){if(!r.state.functionalities[n.dataset.codename].sourceLocationId===undefined)return setTimeout(i,100);r.emit("section/change","New Proposal",{codeName:n.dataset.codename,sourceLocation:r.state.functionalities[n.dataset.codename].sourceLocation,sourceLocationId:r.state.functionalities[n.dataset.codename].sourceLocationId,"delete":n.dataset.delete})};e()},componentDidMount:function(){var t=this;t.mountDate=(new Date).getTime()+"_"+Math.random();try{window.loadFunctionalityNames(t.props.element).then(function(e){return t.setState({functionalityNames:t.props.element.functionalityNames=e},t.controller.loadFunctionalities)}).catch(function(e){return window.loadFunctionalities(t.props.element,function(){return t.setState({functionalityNames:t.props.element.functionalityNames,functionalities:t.props.element.functionalities})}).then(function(){return t.forceUpdate()})})}catch(n){window.loadFunctionalities(t.props.element,function(){return t.setState({functionalities:t.props.element.functionalities})}).then(function(){return t.forceUpdate()})}},componentWillUnmount:function(){delete this.mountDate},onClick:function(t,n){var r=this;try{t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var i=$(t.target).hasClass("RwWrite")?"submit":"read",s=[],r=this;this[n.codeName+"Input"]&&this[n.codeName+"Input"].children().each(function(e,t){var n=$($(t).children()[0]),r=n.val();n.is('input[type="number"]')&&(r=parseInt(r)),n.is("select")&&(r=r==="true"),r!==undefined&&s.push(n.is('input[data-many="true"]')?JSON.parse(r):r)});var o=r.state&&r.state.response||[];delete o[n.codeName],this.emit("message"),r.setState({response:o},function(){r.controller.call(i,n.codeName,n.inputParameters,s,n.returnAbiParametersArray,n.needsSender).then(function(e){var t=r.state&&r.state.response||{};t[n.codeName]=e,r.setState({response:t})}).catch(function(e){return r.emit("message",e.message||e,"error")})})}catch(u){r.emit("message",u.message||u,"error")}},renderInput:function(t){var n=this;if(t.isInternal||!t.methodSignature)return;return React.createElement("ul",{ref:function(r){return t.inputParameters&&t.inputParameters.length>0&&(n[t.codeName+"Input"]=$(r))}},t.inputParameters.map(function(e,n){return(!t.needsSender||n>(t.submitable?1:0))&&React.createElement("li",{key:e.codeName},(e.indexOf("bytes32")===0||e.indexOf("address")===0||e.indexOf("string")===0||e.indexOf("bool[]")===0||e.indexOf("uint")===0)&&React.createElement("input",{type:e.indexOf("uint")===0&&e.indexOf("[]")===-1?"number":"text",min:"0","data-many":e.indexOf("[]")!==-1,placeholder:e==="address"?"address":""}),e==="bool"&&React.createElement("select",null,React.createElement("option",{value:"false",selected:!0},"false"),React.createElement("option",{value:"true"},"true")))}))},render:function(){var t=this,n=this;return React.createElement("section",{className:"DFOOverview"},n.state.functionalityNames&&React.createElement("ul",{className:"DFOFunctionList"},Object.keys(n.state.functionalities).map(function(e){var r=n.state.functionalities[e];if(!r)return null;var i=0,s=!0;r.description=r.description||(r.methodSignature||r.code?"Loading Description...":"No description available");try{i=r.description.length>window.descriptionWordLimit?window.descriptionWordLimit:r.description.length,s=t.state&&t.state.more===r.codeName}catch(o){}return React.createElement("li",{key:r.codeName},React.createElement("section",{className:"DFOFunctionEmoji"},r.compareErrors===undefined&&React.createElement(LoaderMinimino,null),r.compareErrors&&React.createElement("h4",{title:!r.compareErrors||r.compareErrors.length===0?"":(r.compareErrors[0].indexOf("data not available")!==-1?"":"There are some problems in this functionality:\n")+r.compareErrors.join(";\n").trim(),ref:function(t){return t&&(t.innerHTML=!r.compareErrors||r.compareErrors.length===0?"&#128736;&#65039;":"&#9763;&#65039;")}})),React.createElement("section",{className:"DFOFunctionTitle"},React.createElement("h5",null,r.codeName)),React.createElement("section",{className:"DFOFunctionDescription"},r.description&&React.createElement("p",null,React.createElement("span",{ref:function(t){return t&&(t.innerHTML=r.description.substring(0,s?r.description.length:i))}}),!s&&i<r.description.length&&["... ",React.createElement("a",{href:"javascript:;",onClick:function(){return t.setState({more:r.codeName})}},"More")],s&&i<r.description.length&&[" ",React.createElement("a",{href:"javascript:;",onClick:function(){return t.setState({more:null})}},"Less")])),React.createElement("section",{className:"DFOBtnViewSection"},React.createElement("section",{className:"DFOFxTools"},r.code&&React.createElement("a",{className:"LinkVisualButton"+(t.state&&t.state.opened==="code_"+r.codeName?" Editing":""),href:"javascript:;",onClick:function(){return n.setState({opened:n.state&&n.state.opened==="code_"+r.codeName?null:"code_"+r.codeName})}},"Code"),r.methodSignature&&React.createElement("a",{className:"LinkVisualButton"+(t.state&&t.state.opened==="query_"+r.codeName?" Editing":""),href:"javascript:;",onClick:function(){return n.setState({opened:n.state&&n.state.opened==="query_"+r.codeName?null:"query_"+r.codeName})}},"Query")),r.methodSignature&&n.props.edit&&React.createElement("section",{className:"DFOFxTools"},React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB",href:"javascript:;","data-codename":r.codeName,onClick:t.change},"Change"),r.codeName!=="getMinimumBlockNumberForSurvey"&&r.codeName!=="getMinimumBlockNumberForEmergencySurvey"&&r.codeName!=="getEmergencySurveyStaking"&&r.codeName!=="checkSurveyResult"&&React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB",href:"javascript:;","data-codename":r.codeName,onClick:t.controller.deleteFunction},"Delete")),r.location&&React.createElement("a",{className:"LinkVisualClassic",href:window.getNetworkElement("etherscanURL")+"address/"+r.location,target:"_blank"},"Contract")),t.state&&t.state.opened==="code_"+r.codeName&&React.createElement("section",{className:"DFOFunctionQuery"},React.createElement(Editor,{firstCode:r.code})),t.state&&t.state.opened==="query_"+r.codeName&&React.createElement("section",{className:"DFOFunctionQuery"},React.createElement("section",{className:"DFOFunctionQueryFX"},React.createElement("section",{className:"DFOFunctionMethod"},React.createElement("h6",null,r.methodSignature)),React.createElement("section",{className:"DFOBtnReadSection"},t.renderInput(r),!r.isInternal&&r.submitable&&React.createElement("a",{href:"javascript:;",className:"LinkVisualButton RwWrite",onClick:function(t){return n.onClick(t,r)}},"Submit"),!r.isInternal&&!r.submitable&&React.createElement("a",{href:"javascript:;",className:"LinkVisualButton RwRead",onClick:function(t){return n.onClick(t,r)}},"Read"),r.isInternal&&React.createElement("span",{className:"RwIntern"},"Internal")),n.state&&n.state.response&&n.state.response[r.codeName]&&React.createElement("section",{className:"DFOBtnResultSection"},React.createElement("h6",null,n.state.response[r.codeName])))))})),(!n.state.functionalityNames||n.state.functionalityNames.length===0)&&(!this.props.element.functionalities||Object.keys(this.props.element.functionalities).length!==this.props.element.functionalitiesAmount)&&React.createElement(LoaderMini,{message:"Loading Functionalities"}))}});var GhostLoader=React.createClass({displayName:"GhostLoader",render:function(){return React.createElement("img",{src:"assets/img/ghostload.gif"})}});var GlobalCatcher=React.createClass({displayName:"GlobalCatcher",render:function(){return React.createElement("div",null,React.createElement("div",{style:{"text-align":"center",width:"100%","margin-top":"150px"}},React.createElement("span",{style:{display:"inline-block","font-size":"250px"}},"😱")),React.createElement("div",{style:{color:"white",width:"100%","text-align":"center"}},"An error occurred",this.props.error?': "'+(this.props.error.message||this.props.error)+'"':"",". Please ",React.createElement("a",{href:"javascript:;",onClick:function(){return window.location.reload()}},"refresh")," the page."))}});var GovernanceController=function(t){var n=this;n.view=t};var Governance=React.createClass({displayName:"Governance",requiredModules:["spa/proposals"],getInitialState:function(){return{section:"Proposals"}},onClick:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.sectionChange(t.target.innerHTML)},sectionChange:function(t,n){this.domRoot.children().find("a").each(function(e,n){((n=$(n).removeClass("selected")).html()===t||n.data("alternatives")&&n.data("alternatives").indexOf(t)!==-1)&&n.addClass("selected")});var r=t.split(" ").join(""),i=this;ReactModuleLoader.load({modules:["spa/"+r.firstLetterToLowerCase()],callback:function(){return i.setState({section:r,props:n||null})}})},render:function(){var t={};return this.props&&Object.entries(this.props).forEach(function(e){return t[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return t[e[0]]=e[1]}),t.section=t.subSection||t.section,React.createElement("section",{className:"DFOOpened"},React.createElement("ul",{className:"DFONavigator DFOSubNavigator DFONavigatorAfter"},React.createElement("li",null,React.createElement("a",{href:"javascript:;",onClick:this.onClick},"Rules")),React.createElement("li",null,React.createElement("a",{href:"javascript:;",onClick:this.onClick,className:"selected"},"Proposals")),React.createElement("li",null,React.createElement("a",{href:"javascript:;",onClick:this.onClick},"New Proposal"))),React.createElement(window[t.section],t))}});function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_shared=require("../../../../components/shared"),_actions=require("../../../../store/actions"),_ethers=require("ethers"),_ContractEditor=_interopRequireDefault(require("../../../../components/editor/ContractEditor")),_CreateOrEditFarmingSetups=_interopRequireDefault(require("./CreateOrEditFarmingSetups")),_FarmingExtensionTemplate=_interopRequireDefault(require("../../../../data/FarmingExtensionTemplate.sol")),_reactRouter=require("react-router"),abi=new _ethers.ethers.utils.AbiCoder,Create=function(t){function bt(e){var t=e.abi;return t.filter(function(e){return e.type==="constructor"}).length>0?!1:t.filter(function(e){return e.type==="function"&&e.stateMutability!=="view"&&e.stateMutability!=="pure"&&e.name==="transferTo"&&(!e.outputs||e.outputs.length===0)&&e.inputs&&e.inputs.length===1&&e.inputs[0].type==="uint256"}).length===0?!1:t.filter(function(e){return e.type==="function"&&e.stateMutability==="payable"&&e.name==="backToYou"&&(!e.outputs||e.outputs.length===0)&&e.inputs&&e.inputs.length===1&&e.inputs[0].type==="uint256"}).length===0?!1:!0}function wt(e){C(""),st(e.target.checked)}function Et(e){var t=e.currentTarget.value;C(window.isEthereumAddress(t)?t:"")}function St(e){W(e.target.value),A(""),_(""),R(""),F(!1),C(""),st(!1),H(null)}function xt(){return z?z==="address"?it&&!window.isEthereumAddress(N)?!1:window.isEthereumAddress(L):z==="deployedContract"?j?window.isEthereumAddress(M):P!==undefined&&P!==null&&P.contract!==undefined&&P.contract!==null:window.isEthereumAddress(M):!1}var n=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,mt();case 2:e=s.sent,r=[{name:"Clone Extension",description:"Farm Extension will comunicate with the DFO for Token and ETH transmission to the Farming Contract Contract",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,window.blockchainCall(dfoBasedFarmExtensionFactory.methods.cloneModel);case 2:return e=i.sent,i.next=5,window.web3.eth.getTransactionReceipt(e.transactionHash);case 5:r=i.sent,t.extensionAddress=window.web3.eth.abi.decodeParameter("address",r.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("ExtensionCloned(address,address)")})[0].topics[1]);case 7:case"end":return i.stop()}},n,this)}))()},onTransaction:function(t,n){t.extensionAddress=window.web3.eth.abi.decodeParameter("address",n.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("ExtensionCloned(address,address)")})[0].topics[1])}},{name:"Deploy Farm Contract",description:"New Farm Contract will be deployed.",call:function(r){return _asyncToGenerator(regeneratorRuntime.mark(function i(){var n,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n=window.newContract(t.dfoCore.getContextElement("FarmMainABI")).methods.init(r.extensionAddress,window.web3.utils.sha3("init(bool,address,address)").substring(0,10)+window.web3.eth.abi.encodeParameters(["bool","address","address"],[e.byMint,r.element.doubleProxyAddress,window.voidEthereumAddress]).substring(2),window.getNetworkElement("ethItemOrchestratorAddress"),e.rewardTokenAddress,abi.encode(["tuple(bool,uint256,uint256,uint256,uint256,uint256,uint256,address,address,address,address,bool,uint256,uint256,uint256)[]"],[e.setups])).encodeABI(),u.next=3,window.blockchainCall(farmFactory.methods.deploy,n);case 3:return s=u.sent,u.next=6,window.web3.eth.getTransactionReceipt(s.transactionHash);case 6:o=u.sent,r.farmAddress=window.web3.eth.abi.decodeParameter("address",o.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("FarmMainDeployed(address,address,bytes)")})[0].topics[1]);case 8:case"end":return u.stop()}},i,this)}))()},onTransaction:function(t,n){return _asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.farmAddress=window.web3.eth.abi.decodeParameter("address",n.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("FarmMainDeployed(address,address,bytes)")})[0].topics[1]);case 1:case"end":return r.stop()}},r,this)}))()}},{name:"Generate SmartContract Proposal",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,window.SolidityUtilities.getCompilers();case 2:return t.selectedSolidityVersion=r.sent.releases["0.7.6"],t.bypassFunctionalitySourceId=!0,t.contractName="ProposalCode",e="NewFarmingExtension",t.functionalityMethodSignature="callOneTime(address)",r.t0=JSON,r.next=10,window.blockchainCall(t.element.functionalitiesManager.methods.functionalityNames);case 10:r.t1=r.sent,r.t2=function(e){return e==="manageFarming"},r.t3=r.t0.parse.call(r.t0,r.t1).filter(r.t2).length;if(r.t3!==0){r.next=19;break}e="ManageFarmingFunctionality",t.functionalityMethodSignature="manageFarming(address,uint256,bool,address,address,uint256,bool)",t.functionalityName="manageFarming",t.functionalitySubmitable=!0,t.functionalityNeedsSender=!0;case 19:return r.next=21,fetch("data/"+e+".sol");case 21:return r.next=23,r.sent.text();case 23:r.t4=window.web3.utils.toChecksumAddress(t.extensionAddress),t.sourceCode=r.sent.format(r.t4),console.log(t.sourceCode);case 26:case"end":return r.stop()}},n,this)}))()}}],i={element:t.element,sequentialOps:r,sourceCode:"test",title:(t.fixedInflationContractAddress?"Edit":"New")+" Farming"},window.showProposalLoader(i);case 6:case"end":return s.stop()}},n,this)}));return function(){return e.apply(this,arguments)}}(),r=(0,_reactRouter.useParams)(),i=r.address,s=t.inputRewardToken,o=(0,_react.useState)(!1),u=o[0],a=o[1],f=(0,_react.useState)(0),l=f[0],c=f[1],h=(0,_react.useState)(!1),p=h[0],d=h[1],v=(0,_react.useState)(s||null),m=v[0],g=v[1],y=(0,_react.useState)(!1),b=y[0],w=y[1],E=(0,_react.useState)([]),S=E[0],x=E[1],T=(0,_react.useState)(null),N=T[0],C=T[1],k=(0,_react.useState)(null),L=k[0],A=k[1],O=(0,_react.useState)(null),M=O[0],_=O[1],D=(0,_react.useState)(null),P=D[0],H=D[1],B=(0,_react.useState)(!1),j=B[0],F=B[1],I=(0,_react.useState)(""),q=I[0],R=I[1],U=(0,_react.useState)(""),z=U[0],W=U[1],X=(0,_react.useState)(!1),V=X[0],$=X[1],J=(0,_react.useState)(0),K=J[0],Q=J[1],G=(0,_react.useState)(null),Y=G[0],Z=G[1],et=(0,_react.useState)(""),tt=et[0],nt=et[1],rt=(0,_react.useState)(!1),it=rt[0],st=rt[1],ot=(0,_react.useState)(""),ut=ot[0],at=ot[1],ft=(0,_react.useState)(0),lt=ft[0],ct=ft[1];(0,_react.useEffect)(_asyncToGenerator(regeneratorRuntime.mark(function kt(){var e;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:((e=t.farmingContract)==null?void 0:e.rewardToken)?vt(t.farmingContract.rewardToken.address):i&&vt(i),l===0&&t.dfoCore.getBlockNumber().then(function(e){c(e)});case 2:case"end":return r.stop()}},kt,this)})),[]),(0,_react.useEffect)(function(){w(!1)},[m]);var ht=function(t){x(S.concat(t))},pt=function(t,n){var r=S.map(function(e,r){return r!==n?e:t});x(r)},dt=function(t){var n=S.filter(function(e,n){return n!==t});x(n)},vt=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var r,i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a(!0),o.prev=1,o.next=4,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),e);case 4:return r=o.sent,o.next=7,r.methods.symbol().call();case 7:return i=o.sent,o.next=10,r.methods.decimals().call();case 10:s=o.sent,g({symbol:i,address:e,decimals:s}),o.next=18;break;case 14:o.prev=14,o.t0=o["catch"](1),console.error(o.t0),g(null);case 18:return o.prev=18,a(!1),o.finish(18);case 21:case"end":return o.stop()}},n,this,[[1,14,18,21]])}));return function(n){return e.apply(this,arguments)}}(),mt=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return $(!0),d.prev=1,e={setups:[],rewardTokenAddress:m.address,byMint:b,deployContract:P,extensionInitData:q||""},d.next=5,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMAggregatorABI"),t.dfoCore.getContextElement("ammAggregatorAddress"));case 5:r=d.sent,console.log(S),i="0",s=0;case 9:if(!(s<S.length)){d.next=34;break}return o=S[s],i=t.dfoCore.web3.utils.toBN(i).add(t.dfoCore.web3.utils.toBN(window.numberToString(t.dfoCore.fromDecimals(window.numberToString(o.rewardPerBlock),m.decimals))).mul(t.dfoCore.web3.utils.toBN(window.numberToString(o.blockDuration)))).toString(),u=o.free,d.next=15,r.methods.findByLiquidityPool(o.liquidityPoolToken.address).call();case 15:return a=d.sent,f=a.amm,l=u?o.liquidityPoolToken.tokens[0].address:o.mainToken.address,d.next=20,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),l);case 20:c=d.sent;if(l!==window.voidEthereumAddress){d.next=25;break}d.t0=18,d.next=28;break;case 25:return d.next=27,c.methods.decimals().call();case 27:d.t0=d.sent;case 28:h=d.t0,p=[u,parseInt(o.blockDuration),parseInt(o.startBlock),window.numberToString(t.dfoCore.fromDecimals(window.numberToString(o.rewardPerBlock),m.decimals)),window.numberToString(t.dfoCore.fromDecimals(window.numberToString(o.minStakeable),h)),u?0:window.numberToString(t.dfoCore.fromDecimals(window.numberToString(o.maxStakeable)),h),o.renewTimes,f,o.liquidityPoolToken.address,l,t.dfoCore.voidEthereumAddress,o.involvingEth,u?0:t.dfoCore.fromDecimals(window.numberToString(parseFloat(o.penaltyFee)/100)),0,0],e.setups.push(p);case 31:s++,d.next=9;break;case 34:return console.log(e),Z(e),ct(i),d.abrupt("return",e);case 40:d.prev=40,d.t1=d["catch"](1),console.error(d.t1),Z(null);case 44:return d.prev=44,$(!1),d.finish(44);case 47:case"end":return d.stop()}},n,this,[[1,40,44,47]])}));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i,s,o,u,a,f,l,c,h,p,d,v;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return e=!1,r=null,$(!0),m.prev=3,i=Y.setups,s=Y.rewardTokenAddress,o=Y.extensionAddress,u=Y.extensionInitData,a=t.dfoCore.getContextElement("farmFactoryAddress"),m.next=8,t.dfoCore.getContract(t.dfoCore.getContextElement("FarmFactoryABI"),a);case 8:return f=m.sent,l=["address","bytes","address","address","bytes"],console.log(Y),c=abi.encode(["tuple(bool,uint256,uint256,uint256,uint256,uint256,address,address,address,address,bool,uint256,uint256,uint256)[]"],[i]),h=[t.dfoCore.web3.utils.toChecksumAddress(o?o:M),q||u||"0x",t.dfoCore.getContextElement("ethItemOrchestratorAddress"),s,c||0],console.log(h),console.log(u),console.log(q),console.log(o),p=t.dfoCore.web3.utils.sha3("init("+l.join(",")+")").substring(0,10)+t.dfoCore.web3.eth.abi.encodeParameters(l,h).substring(2),console.log(p),m.next=21,f.methods.deploy(p).estimateGas({from:t.dfoCore.address});case 21:return d=m.sent,m.next=24,f.methods.deploy(p).send({from:t.dfoCore.address,gas:d});case 24:return r=m.sent,m.next=27,t.dfoCore.web3.eth.getTransactionReceipt(r.transactionHash);case 27:r=m.sent,v=t.dfoCore.web3.eth.abi.decodeParameter("address",r.logs.filter(function(e){return e.topics[0]===t.dfoCore.web3.utils.sha3("FarmMainDeployed(address,address,bytes)")})[0].topics[1]),at(v),m.next=36;break;case 32:m.prev=32,m.t0=m["catch"](3),console.error(m.t0),m.t0=!0;case 36:m.prev=36;if(!!e||!r){m.next=45;break}return t.updateFarmingContract(null),m.next=41,Promise.all(S.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:dt(n);case 1:case"end":return t.stop()}},t,this)}));return function(t,n){return e.apply(this,arguments)}}()));case 41:t.setFarmingContractStep(0),g(null),w(!1),Q(K+1);case 45:return $(!1),m.finish(36);case 47:case"end":return m.stop()}},n,this,[[3,32,36,47]])}));return function(){return e.apply(this,arguments)}}(),yt=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:e=!1,$(!0),y.prev=2,r=Y.byMint,i=Y.host,s=Y.deployContract;if(s){y.next=24;break}return o=t.dfoCore.getContextElement("farmFactoryAddress"),y.next=8,t.dfoCore.getContract(t.dfoCore.getContextElement("FarmFactoryABI"),o);case 8:return u=y.sent,y.next=11,u.methods.cloneFarmDefaultExtension().estimateGas({from:t.dfoCore.address});case 11:return a=y.sent,y.next=14,u.methods.cloneFarmDefaultExtension().send({from:t.dfoCore.address,gas:a});case 14:return f=y.sent,y.next=17,t.dfoCore.web3.eth.getTransactionReceipt(f.transactionHash);case 17:l=y.sent,c=t.dfoCore.web3.eth.abi.decodeParameter("address",l.logs.filter(function(e){return e.topics[0]===t.dfoCore.web3.utils.sha3("ExtensionCloned(address)")})[0].topics[1]),h=new t.dfoCore.web3.eth.Contract(t.dfoCore.getContextElement("FarmExtensionABI"),c),p=h.methods.init(r,i,N||t.dfoCore.voidEthereumAddress).encodeABI(),Z(_extends({},Y,{extensionAddress:c,extensionInitData:p})),y.next=33;break;case 24:return d=s.abi,v=s.bytecode,y.next=27,(new t.dfoCore.web3.eth.Contract(d)).deploy({data:v}).estimateGas({from:t.dfoCore.address});case 27:return m=y.sent,y.next=30,(new t.dfoCore.web3.eth.Contract(d)).deploy({data:v}).send({from:t.dfoCore.address,gasLimit:m,gas:m});case 30:g=y.sent,console.log(g.options.address),Z(_extends({},Y,{extensionAddress:g.options.address}));case 33:Q(e?K:K+1),y.next=40;break;case 36:y.prev=36,y.t0=y["catch"](2),console.error(y.t0),y.t0=!0;case 40:return y.prev=40,$(!1),y.finish(40);case 43:case"end":return y.stop()}},n,this,[[2,36,40,43]])}));return function(){return e.apply(this,arguments)}}(),Tt=function(){return React.createElement("div",{className:"CheckboxQuestions"},React.createElement("h6",null,"Reward token address"),React.createElement("p",{className:"BreefRecapB"},"The reward token is the token chosen to reward farmers and can be one per contract."),React.createElement(_shared.TokenInput,{placeholder:"Reward token",onClick:vt,tokenAddress:m&&m.address||"",text:"Load"}),u?React.createElement("div",{className:"row justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"}))):React.createElement(React.Fragment,null,m&&React.createElement("div",{className:"CheckboxQuestions"},React.createElement("p",null,React.createElement(_shared.Coin,{address:m.address})," ",m.symbol),React.createElement("p",{className:"BreefRecapB"},"If “by reserve” is selected, the input token will be sent from a wallet. If “by mint” is selected, it will be minted and then sent. The logic of this action must be carefully coded into the extension! To learn more, read the Documentation ",React.createElement("a",null,"Documentation (coming Soon)")),React.createElement("select",{value:b===!0?"true":"false",onChange:function(t){return w(t.target.value==="true")},className:"SelectRegular"},React.createElement("option",{value:""},"Select method"),React.createElement("option",{value:"true"},"By mint"),React.createElement("option",{value:"false"},"By reserve"))),m&&React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{className:"web2ActionBTN",onClick:function(){t.updateFarmingContract({rewardToken:_extends({},m,{byMint:b})}),Q(0)}},"Start"))))},Nt=function(){return V?React.createElement("div",{className:"col-12"},React.createElement("div",{className:"row justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"})))):K===1?React.createElement("div",{className:"col-12 flex flex-column justify-content-center align-items-center"},React.createElement("div",{className:"row mb-4"},React.createElement("h6",null,React.createElement("b",null,"Deploy extension"))),React.createElement("div",{className:"row"},React.createElement("a",{onClick:function(){return Q(0)},className:"backActionBTN mr-4"},"Back"),React.createElement("a",{onClick:function(){return yt()},className:"Web3ActionBTN"},"Deploy extension"))):K===2?React.createElement("div",{className:"col-12 flex flex-column justify-content-center align-items-center"},React.createElement("div",{className:"row mb-4"},React.createElement("h6",null,React.createElement("b",null,"Deploy Farming Contract"))),React.createElement("div",{className:"row"},React.createElement("a",{onClick:function(){return Q(M?0:1)},className:"backActionBTN mr-4"},"Back"),React.createElement("a",{onClick:function(){return gt()},className:"Web3ActionBTN"},"Deploy contract"))):K===3?React.createElement("div",{className:"col-12 flex flex-column justify-content-center align-items-center"},React.createElement("div",{className:"row mb-4"},React.createElement("h6",{className:"text-secondary"},React.createElement("b",null,"Deploy successful!")))):React.createElement("div",{className:"CheckboxQuestions"},React.createElement("h6",null,"Host"),React.createElement("p",{className:"BreefRecapB"},'The host is the Contract, Wallet, DAO, or DFO with permissions to manage and add new setups in this contract. The host permissions are set into the extension contract. If you choose "Standard Extension (Address, wallet)," the extension must have all of the tokens needed to fill every setup rewards. You can also program extension permissions by your Organization, DFO to mint or transfer directly from the treasury, using the DFOhub website or a custom contract (more info in the Documentation).'),React.createElement("select",{className:"SelectRegular",value:z,onChange:St},React.createElement("option",{value:""},"Choose the host type"),React.createElement("option",{value:"address"},"Standard Extension (Address, wallet)"),React.createElement("option",{value:"deployedContract"},"Custom Extension (Deployed Contract)"),React.createElement("option",{value:"fromSourceCode"},"Custom Extension (Deploy Contract)")),z==="address"?React.createElement(React.Fragment,null,React.createElement("div",{className:"InputTokensRegular InputRegularB"},React.createElement("input",{type:"text",className:"TextRegular",value:L||"",onChange:function(t){return A(t.target.value.toString())},placeholder:"Wallet address","aria-label":"Host address"})),React.createElement("div",{className:"CheckboxQuestions"},React.createElement("h6",null,React.createElement("input",{type:"checkbox",checked:it,onChange:wt})," External Treasury"),it&&React.createElement("input",{type:"text",className:"TextRegular",value:N||"",onChange:Et,placeholder:"Treasury address","aria-label":"Treasury address"}),React.createElement("p",{className:"BreefRecapB"},"[Optional] Separate the Extension to the treasury used to send tokens to the Farm contract to activate setups."))):z==="fromSourceCode"?React.createElement(React.Fragment,null,React.createElement("p",{className:"BreefRecapB"},"Deploy a custom extension contract. In the IDE, we loaded a simple extension contract, and you can use it as a guide. Before building a custom contract, we kindly recommend reading the Covenants Documentation. Do it at your own risk."),React.createElement(_ContractEditor.default,{filterDeployedContract:bt,dfoCore:t.dfoCore,onContract:H,templateCode:tt}),React.createElement("h6",null,"Extension payload"),React.createElement("div",{className:"InputTokensRegular InputRegularB"},React.createElement("input",{type:"text",className:"TextRegular",value:q||"",onChange:function(t){return R(t.target.value.toString())},placeholder:"Payload","aria-label":"Payload"}))):z==="deployedContract"?React.createElement(React.Fragment,null,React.createElement("div",{className:"InputTokensRegular InputRegularB"},React.createElement("input",{type:"text",className:"TextRegular",value:M,onChange:function(t){return _(t.target.value.toString())},placeholder:"Insert extension address","aria-label":"Deployed contract address"})),React.createElement("h6",null,"[Optional] Extension payload"),React.createElement("div",{className:"InputTokensRegular InputRegularB"},React.createElement("input",{type:"text",className:"TextRegular",value:q||"",onChange:function(t){return R(t.target.value.toString())},placeholder:"Payload","aria-label":"Payload"}))):React.createElement(React.Fragment,null),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){W(null),d(!1)},className:"backActionBTN"},"Back"),React.createElement("a",{onClick:function(){if(!xt())return;mt(),Q(M?2:1)},className:"web2ActionBTN",disabled:!xt()},"Deploy")))},Ct=function(){return React.createElement("div",{className:"col-12"},React.createElement("div",{className:"row flex-column align-items-start mb-4"},React.createElement("h5",{className:"text-secondary"},React.createElement("b",null,"Farm ",t.farmingContract.rewardToken.symbol))),React.createElement(_CreateOrEditFarmingSetups.default,{rewardToken:m,farmingSetups:S,onAddFarmingSetup:ht,onRemoveFarmingSetup:dt,onEditFarmingSetup:pt,onCancel:function(){t.updateFarmingContract(null)},onFinish:n}))};return ut?React.createElement("div",null,React.createElement("h3",null,"Farming Contract Deployed!"),React.createElement("p",null,"The contract address is ",React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"address/"+ut,target:"_blank"},ut)),React.createElement("p",null,"To activate all the setups you created, ",b?"be sure to grant the permission to mint at least":"you must send"," ",React.createElement("b",null,window.fromDecimals(lt,m.decimals,!0))," ",m.symbol," ",React.createElement(_shared.Coin,{address:m.address})," ",b?"for the extension":"to its extension, having address"," ",React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"address/"+Y.extensionAddress,target:"_blank"},Y.extensionAddress)),React.createElement("p",null,"If you need more information, copy the two addresses and check documentation.")):p?React.createElement("div",{className:"create-component"},React.createElement("div",{className:"row mb-4"},Nt())):React.createElement("div",null,!t.farmingContract&&Tt(),t.farmingContract&&Ct())},mapStateToProps=function(t){var n=t.core,r=t.session,i=r.farmingContract,s=r.farmingSetups,o=r.creationStep;return{dfoCore:n.dfoCore,farmingContract:i,farmingSetups:s,creationStep:o}},mapDispatchToProps=function(t){return{setFarmingContractStep:function(n){return t((0,_actions.setFarmingContractStep)(n))},updateFarmingContract:function(n){return t((0,_actions.updateFarmingContract)(n))},addFarmingSetup:function(n){return t((0,_actions.addFarmingSetup)(n))},removeFarmingSetup:function(n){return t((0,_actions.removeFarmingSetup)(n))}}},_default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Create);exports.default=_default;exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_shared=require("../../../../components/shared"),CreateOrEditFarmingSetup=function(t){function yt(){if(a==="locked"&&window.formatNumber(Y)<=0)return;q&&window.formatNumber(p)>0&&window.formatNumber(K)>0&&ct(1)}var n=t.rewardToken,r=t.onAddFarmingSetup,i=t.editSetup,s=t.onEditFarmingSetup,o=t.dfoCore,u=t.onCancel,a=i?i.free?"free":"locked":t.selectedFarmingType,f=(0,_react.useState)(!1),l=f[0],c=f[1],h=(0,_react.useState)(i&&i.blockDuration?i.blockDuration:0),p=h[0],d=h[1],v=(0,_react.useState)(i&&i.startBlock?i.startBlock:0),m=v[0],g=v[1],y=(0,_react.useState)(i&&i.startBlock?!0:!1),b=y[0],w=y[1],E=(0,_react.useState)(i&&i.minStakeable?i.minStakeable:!1),S=E[0],x=E[1],T=(0,_react.useState)(i&&i.minStakeable?i.minStakeable:0),N=T[0],C=T[1],k=(0,_react.useState)(i&&i.renewTimes?i.renewTimes>0:!1),L=k[0],A=k[1],O=(0,_react.useState)(i&&i.renewTimes?i.renewTimes:0),M=O[0],_=O[1],D=(0,_react.useState)(i&&i.involvingEth?i.involvingEth:!1),P=D[0],H=D[1],B=(0,_react.useState)(i&&i.ethSelectData?i.ethSelectData:null),j=B[0],F=B[1],I=(0,_react.useState)(i&&i.data?i.data:null),q=I[0],R=I[1],U=(0,_react.useState)(i&&i.mainTokenIndex?i.mainTokenIndex:0),z=U[0],W=U[1],X=(0,_react.useState)(i&&i.mainToken?i.mainToken:null),V=X[0],$=X[1],J=(0,_react.useState)(i&&i.rewardPerBlock?i.rewardPerBlock:0),K=J[0],Q=J[1],G=(0,_react.useState)(i&&i.maxStakeable?i.maxStakeable:0),Y=G[0],Z=G[1],et=(0,_react.useState)(i&&i.penaltyFee?i.penaltyFee>0:!1),tt=et[0],nt=et[1],rt=(0,_react.useState)(i&&i.penaltyFee?i.penaltyFee:0),it=rt[0],st=rt[1],ot=(0,_react.useState)(i&&i.ethAddress?i.ethAddress:""),ut=ot[0],at=ot[1],ft=(0,_react.useState)(0),lt=ft[0],ct=ft[1];(0,_react.useEffect)(function(){i&&(i.liquidityPoolTokenAddress||i.liquidityPoolToken&&i.liquidityPoolToken.address)&&ht(i.liquidityPoolTokenAddress||i.liquidityPoolToken.address).then(function(){return i.mainToken&&$(i.mainToken)})},[]);var ht=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var n,r,i,s,u,a,f,l,h,p,d;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(e){v.next=2;break}return v.abrupt("return");case 2:return c(!0),v.prev=3,v.next=6,o.getContract(o.getContextElement("AMMAggregatorABI"),o.getContextElement("ammAggregatorAddress"));case 6:return n=v.sent,v.next=9,n.methods.info(e).call();case 9:return r=v.sent,i=r.name,s=r.amm,v.next=14,o.getContract(o.getContextElement("AMMABI"),s);case 14:return u=v.sent,v.next=17,u.methods.data().call();case 17:return a=v.sent,v.next=20,u.methods.byLiquidityPool(e).call();case 20:return f=v.sent,l=[],h=!1,H(!1),v.next=26,Promise.all(f[2].map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var n,r,i,s;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(e.toLowerCase()!==a[0].toLowerCase()){u.next=15;break}H(!0),h=!0,at(a[0]);if(a[0]!==o.voidEthereumAddress){u.next=8;break}F(null),u.next=15;break;case 8:return u.next=10,o.getContract(o.getContextElement("ERC20ABI"),a[0]);case 10:return n=u.sent,u.next=13,n.methods.symbol().call();case 13:r=u.sent,F({symbol:r});case 15:return u.next=17,o.getContract(o.getContextElement("ERC20ABI"),e);case 17:i=u.sent;if(e!==window.voidEthereumAddress){u.next=22;break}u.t0="ETH",u.next=25;break;case 22:return u.next=24,i.methods.symbol().call();case 24:u.t0=u.sent;case 25:s=u.t0,l.push({symbol:s,address:e,isEth:e.toLowerCase()===a[0].toLowerCase()});case 27:case"end":return u.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()));case 26:return v.next=28,o.getContract(o.getContextElement("ERC20ABI"),e);case 28:return p=v.sent,v.next=31,p.methods.decimals().call();case 31:d=v.sent,h||F(null),R({address:e,name:i,tokens:l,decimals:d}),$(l[0]),v.next=43;break;case 37:v.prev=37,v.t0=v["catch"](3),H(!1),F(null),R(null),console.error(v.t0);case 43:return v.prev=43,c(!1),v.finish(43);case 46:case"end":return v.stop()}},t,this,[[3,37,43,46]])}));return function(n){return e.apply(this,arguments)}}(),pt=function(t){x(t),C(0)},dt=function(t){nt(t),st(0)},vt=function(t){st(t>100?100:t)},mt=function(t){var r=o.fromDecimals(t,n.decimals);Q(r<1?0:t)},gt=function(){if(S&&window.formatNumber(N)<=0)return;if(L&&window.formatNumber(M)<=0)return;var n={free:a==="free",blockDuration:p,startBlock:m,minStakeable:N,renewTimes:M,involvingEth:P,ethSelectData:j,liquidityPoolToken:q,mainTokenIndex:z,mainToken:V,rewardPerBlock:K,maxStakeable:Y,penaltyFee:it,ethAddress:ut};i?s(n,t.editSetupIndex):r(n)},bt=function(){return React.createElement("div",{className:"CheckboxQuestions"},React.createElement("p",{className:"BreefRecapB"},"Load the Pool you want to reward for this setup by its Ethereum address."),React.createElement(_shared.TokenInput,{placeholder:"Liquidity pool address",tokenAddress:i&&(i.liquidityPoolTokenAddress||i.liquidityPoolToken&&i.liquidityPoolToken.address)||"",onClick:ht,text:"Load"}),l?React.createElement("div",{className:"row justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"}))):React.createElement(React.Fragment,null,React.createElement("div",{className:"CheckboxQuestions"},q&&q.tokens.length>0&&React.createElement("h6",{className:"TokenSelectedB"},React.createElement("b",null,q.name," | ",q.tokens.map(function(e){return React.createElement(React.Fragment,null,e.isEth?P?"ETH":e.symbol:e.symbol," ")}))," ",q.tokens.map(function(e){return React.createElement(_shared.Coin,{address:e.isEth?P?t.dfoCore.voidEthereumAddress:e.address:e.address})}))),q&&React.createElement(React.Fragment,null,!1,a==="locked"&&React.createElement(React.Fragment,null,React.createElement("select",{className:"SelectRegular",value:z,onChange:function(t){W(t.target.value),$(q.tokens[t.target.value])}},q.tokens.map(function(e,t){return React.createElement("option",{key:e.address,value:t},e.isEth?P?"ETH":e.symbol:e.symbol)})),React.createElement("div",{className:"InputTokensRegular"},React.createElement("h6",null,"Max stakeable"),React.createElement("p",{className:"BreefRecapB"},"The maximum amount of main tokens staked simultaneously."),React.createElement(_shared.Input,{min:0,showCoin:!0,address:V.isEth&&P?t.dfoCore.voidEthereumAddress:V.address,value:Y,name:V.isEth&&P?"ETH":V.symbol,onChange:function(t){return Z(t.target.value)}}))),React.createElement("div",{className:"InputTokensRegular"},React.createElement("h6",null,"Reward per block"),React.createElement("p",{className:"BreefRecapB"},"The total amount of tokens per block to reward farmers."),React.createElement(_shared.Input,{min:0,showCoin:!0,address:n.address,value:K,name:n.symbol,onChange:function(t){return mt(t.target.value)}})),React.createElement("p",{className:"BreefRecapB"},"Select the duration of the setup. The selected timeband will determinate the end block once activated"),React.createElement("select",{className:"SelectRegular",value:p,onChange:function(t){return d(t.target.value)}},React.createElement("option",{value:0},"Choose setup duration"),Object.keys(t.dfoCore.getContextElement("blockIntervals")).map(function(e,n){return React.createElement("option",{key:e,value:t.dfoCore.getContextElement("blockIntervals")[e]},e)})),React.createElement("p",{className:"BreefRecapB"},React.createElement("b",null,"Total reward (",""+p," blocks): ",K*p," ",n.symbol))),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:u,className:"backActionBTN"},"Back"),React.createElement("a",{onClick:yt,className:"web2ActionBTN"},"Next"))))},wt=function(){return React.createElement("div",{className:"CheckboxQuestions"},React.createElement("h6",null,React.createElement("input",{type:"checkbox",checked:b,onChange:function(t){g(0),w(t.target.checked)}})," Start Block"),b&&React.createElement("div",{className:"InputTokensRegular InputRegularB"},React.createElement(_shared.Input,{min:0,value:m,onChange:function(t){return g(t.target.value)}})),React.createElement("p",{className:"BreefRecapB"},"[Optional ",React.createElement("b",null,"💫 Recommended"),"] Set a start block for this setup. Farmers will be able to activate it after that. This feature helps by giving the host the time needed to send reward tokens to the contract or vote via a DFO/DAO for more complex functionalities. more info in the ",React.createElement("a",{target:"_blank",href:"https://docs.ethos.wiki/covenants/protocols/farm/manage-farming-setups/activate-disactivate-farming-setup"},"Grimoire")),"                ",React.createElement("h6",null,React.createElement("input",{type:"checkbox",checked:S,onChange:function(t){return pt(t.target.checked)},id:"minStakeable"})," Min stakeable"),S&&React.createElement("div",{className:"InputTokensRegular"},React.createElement(_shared.Input,{min:0,showCoin:!0,address:(V==null?!void 0:!V.isEth)&&!q.tokens[z].isEth?""+((V==null?void 0:V.address)||q.tokens[z].address):P?t.dfoCore.voidEthereumAddress:""+((V==null?void 0:V.address)||q.tokens[z].address),value:N,name:(V==null?!void 0:!V.isEth)&&!q.tokens[z].isEth?""+((V==null?void 0:V.symbol)||q.tokens[z].symbol):P?"ETH":""+((V==null?void 0:V.symbol)||q.tokens[z].symbol),onChange:function(t){return C(t.target.value)}}),a==="free"&&React.createElement(React.Fragment,null,React.createElement("h6",null,"Main Token"),React.createElement("select",{className:"SelectRegular",value:z,onChange:function(t){W(t.target.value),$(q.tokens[t.target.value])}},q.tokens.map(function(e,t){return React.createElement("option",{key:e.address,value:t},e.isEth?P?"ETH":e.symbol:e.symbol)})),React.createElement("br",null))),React.createElement("p",{className:"BreefRecapB"},"[Optional] A minimum amount of main tokens to stake to open a position"),a==="locked"&&React.createElement(React.Fragment,null,React.createElement("h6",null,React.createElement("input",{type:"checkbox",checked:tt,onChange:function(t){return dt(t.target.checked)},id:"penaltyFee"})," Penalty fee "),tt&&React.createElement(React.Fragment,null,React.createElement("div",{className:"SpecialInputPerch"},React.createElement("aside",null,"%"),React.createElement("input",{placeholder:"Penalty Fee",type:"number",min:0,max:100,value:it,onChange:function(t){return vt(t.target.value)},className:"TextRegular"})),React.createElement("p",{className:"BreefRecapB"},"Main Token: ",n.symbol)),React.createElement("p",{className:"BreefRecapB"},"[Optional] The penalty fee is a perchentange of the total reward of a position that must be paid to close it before the end block.")),React.createElement("h6",null,React.createElement("input",{type:"checkbox",checked:L,onChange:function(t){_(0),A(t.target.checked)},id:"repeat"})," Repeat"),L&&React.createElement("div",{className:"InputTokensRegular InputRegularB"},React.createElement(_shared.Input,{min:0,value:M,onChange:function(t){return _(t.target.value)}})),React.createElement("p",{className:"BreefRecapB"},"[Optional] Select the amount of time to automatically repete this setup after the block-end."),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){return ct(0)},className:"backActionBTN"},"Back"),React.createElement("a",{onClick:function(){return gt()},className:"web2ActionBTN"},i?"Edit":"Add")))};return lt===0?bt():lt===1?wt():React.createElement("div",null)},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(CreateOrEditFarmingSetup);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_CreateOrEditFarmingSetup=_interopRequireDefault(require("./CreateOrEditFarmingSetup")),CreateOrEditFarmingSetups=function(t){var n=t.rewardToken,r=t.farmingSetups,i=t.onAddFarmingSetup,s=t.onEditFarmingSetup,o=t.onRemoveFarmingSetup,u=t.onCancel,a=t.onFinish,f=(0,_react.useState)(!1),l=f[0],c=f[1],h=(0,_react.useState)(null),p=h[0],d=h[1],v=(0,_react.useState)(0),m=v[0],g=v[1],y=(0,_react.useState)(""),b=y[0],w=y[1],E=(0,_react.useState)(0),S=E[0],x=E[1];return S>0||p?React.createElement(_CreateOrEditFarmingSetup.default,{rewardToken:n,onAddFarmingSetup:function(t){i(t),x(0),c(!1)},editSetup:p,editSetupIndex:m,onEditFarmingSetup:function(t,n){s(t,n),d(null),g(0),x(0)},selectedFarmingType:p?p.maxLiquidity?"locked":"free":b,onCancel:function(){x(0),d(null),g(0)}}):r.length===0||l?React.createElement("div",{className:"CheckboxQuestions"},React.createElement("h6",null,React.createElement("b",null,"Create Setup by")),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){return w(b!=="free"?"free":null)},className:(b==="free"?"web2ActionBTN":"backActionBTN")+" mr-4"},"Free"),React.createElement("a",{onClick:function(){return w(b!=="locked"?"locked":null)},className:""+(b==="locked"?"web2ActionBTN":"backActionBTN")},"Locked")),React.createElement("p",{className:"BreefRecapB"},"Farming setups can be either Free or Locked. In free farming, Farmers can stake / un-stake liquidity anytime, but the reward/block is shared btween them. In Locked setups Farmers lock the liquidity until it ends, but reawards are fixed."),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{className:"backActionBTN",onClick:u},"Back"),React.createElement("a",{onClick:function(){return b&&x(1)},disabled:!b,className:"web2ActionBTN"},"Next")),React.createElement("br",null),r.length===0&&!t.forEdit&&React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{className:"hiddenLink",onClick:a},"Deploy without setups"))):React.createElement("div",{className:"CheckboxQuestions"},r.map(function(e,t){return React.createElement("div",{key:t,className:"SetupListITEM"},React.createElement("div",{className:"SetupListITEMINFO"},React.createElement("p",null,e.free?"Free setup":"Locked setup"," ",e.free?" "+e.liquidityPoolToken.tokens.map(function(t){return""+(e.involvingEth&&t.address.toLowerCase()===e.ethAddress.toLowerCase()?"ETH":t.symbol)}):""+(e.mainToken.isEth&&e.involvingEth?"ETH":e.liquidityPoolToken.symbol)," (",e.liquidityPoolToken.name,") - Reward: ",e.rewardPerBlock," ",n.symbol,"/block ")),React.createElement("div",{className:"SetupListITEMACTIONS"},React.createElement("a",{className:"web2ActionBTN",onClick:function(){return o(t)}},React.createElement("b",null,"Delete")),React.createElement("a",{onClick:function(){d(e),g(t)},className:"web2ActionBTN"},React.createElement("b",null,"Edit"))))}),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){return c(!0)},className:"web2ActionBTN"},"Add setup"),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){r.forEach(function(e,t){return o(t)}),u()},className:"backActionBTN mr-4"},"Back")," ",t.finishButton||React.createElement("a",{onClick:function(){return a()},className:"web2ActionBTN ml-4"},"Next"))))},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(CreateOrEditFarmingSetups);exports.default=_default;exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_components=require("../../../../components"),Explore=function(t){var n=t.dfoCore,r=(0,_react.useState)(""),i=r[0],s=r[1],o=(0,_react.useState)([]),u=o[0],a=o[1],f=(0,_react.useState)([]),l=f[0],c=f[1],h=(0,_react.useState)(!1),p=h[0],d=h[1],v=(0,_react.useState)(""),m=v[0],g=v[1],y=(0,_react.useState)(!0),b=y[0],w=y[1];(0,_react.useEffect)(function(){n&&E()},[]);var E=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return w(!0),s.prev=1,s.next=4,n.loadDeployedFarmingContracts();case 4:return e=s.sent,s.next=7,Promise.all(e.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.prev=0,O.next=3,n.getContract(n.getContextElement("FarmMainABI"),e.address);case 3:return i=O.sent,O.next=6,i.methods._rewardTokenAddress().call();case 6:s=O.sent,o=s===n.voidEthereumAddress;if(o){O.next=14;break}return O.next=11,n.getContract(n.getContextElement("ERC20ABI"),s);case 11:O.t0=O.sent,O.next=15;break;case 14:O.t0=null;case 15:u=O.t0;if(o){O.next=22;break}return O.next=19,u.methods.symbol().call();case 19:O.t1=O.sent,O.next=23;break;case 22:O.t1="ETH";case 23:a=O.t1;if(o){O.next=30;break}return O.next=27,u.methods.decimals().call();case 27:O.t2=O.sent,O.next=31;break;case 30:O.t2=18;case 31:return f=O.t2,O.next=34,i.methods._extension().call();case 34:return l=O.sent,O.next=37,n.getContract(n.getContextElement("FarmExtensionABI"),l);case 37:c=O.sent;if(o){O.next=44;break}return O.next=41,u.methods.balanceOf(l).call();case 41:O.t3=O.sent,O.next=47;break;case 44:return O.next=46,n.web3.eth.getBalance(l);case 46:O.t3=O.sent;case 47:return h=O.t3,O.next=50,c.methods.data().call();case 50:return p=O.sent,d=p.host,v=p.byMint,O.next=55,n.getBlockNumber();case 55:return m=O.sent,O.next=58,i.methods.setups().call();case 58:return g=O.sent,y=[],b=[],w=0,E=0,S=0,x=!1,T=!1,N=!1,O.prev=67,O.next=70,n.getContract(n.getContextElement("dfoDoubleProxyABI"),d);case 70:return C=O.sent,O.t4=n,O.t5=n.getContextElement("dfoProxyABI"),O.next=75,C.methods.proxy().call();case 75:return O.t6=O.sent,O.next=78,O.t4.getContract.call(O.t4,O.t5,O.t6);case 78:return k=O.sent,O.t7=n,O.t8=n.getContextElement("dfoStateHolderABI"),O.next=83,k.methods.getStateHolderAddress().call();case 83:return O.t9=O.sent,O.next=86,O.t7.getContract.call(O.t7,O.t8,O.t9);case 86:return L=O.sent,O.next=89,L.methods.getBool("farming.authorized."+l.toLowerCase()).call();case 89:N=O.sent,T=!0,O.next=96;break;case 93:O.prev=93,O.t10=O["catch"](67),T=!1;case 96:return O.next=98,Promise.all(g.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,r){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.dfoCore.loadFarmingSetup(i,r);case 2:s=a.sent,o=s[0],u=s[1],x||(x=parseInt(u.renewTimes)>0&&!e.active&&parseInt(u.lastSetupIndex)===parseInt(r),!T&&!v&&e.rewardPerBlock!=="0"&&(x=x&&parseInt(h)>=parseInt(e.rewardPerBlock)*parseInt(u.blockDuration))),e.active&&parseInt(e.endBlock)>m&&(u.free?y.push(e):b.push(e),S+=parseInt(e.rewardPerBlock)),e.rewardPerBlock!=="0"&&(u.free?w+=1:E+=1);case 8:case"end":return a.stop()}},n,this)}));return function(t,n){return e.apply(this,arguments)}}()));case 98:return A={name:"Farm "+a,contractAddress:i.options.address,rewardTokenAddress:u.options.address,rewardPerBlock:n.toDecimals(n.toFixed(S).toString(),f),byMint:v,extension:l.substring(0,5)+"..."+l.substring(l.length-3,l.length),fullExtension:""+l,farmAddress:i.options.address.substring(0,5)+"..."+i.options.address.substring(i.options.address.length-3,i.options.address.length),freeSetups:y,lockedSetups:b,totalFreeSetups:w,totalLockedSetups:E,canActivateSetup:x,fromDfo:T,fromDfoReady:N,host:d.substring(0,5)+"..."+d.substring(d.length-3,d.length),fullhost:""+d},O.abrupt("return",{contract:i,metadata:A,isActive:y.length+b.length>0||x});case 102:O.prev=102,O.t11=O["catch"](0),console.error(O.t11);case 105:case"end":return O.stop()}},r,this,[[0,102],[67,93]])}));return function(t){return e.apply(this,arguments)}}()));case 7:i=s.sent,a(i.filter(function(e){return e}).sort(function(e,t){return e.isActive===t.isActive?0:e.isActive?-1:1})),c(i.filter(function(e){return e}).sort(function(e,t){return e.isActive===t.isActive?0:e.isActive?-1:1})),s.next=17;break;case 12:s.prev=12,s.t0=s["catch"](1),console.log(s.t0),a([]),c([]);case 17:return s.prev=17,w(!1),s.finish(17);case 20:case"end":return s.stop()}},r,this,[[1,12,17,20]])}));return function(){return e.apply(this,arguments)}}(),S=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=4;break}return s(""),a(l),r.abrupt("return");case 4:return w(!0),r.prev=5,s(e),n=[],r.next=10,Promise.all(l.map(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function r(t){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t.metadata.rewardTokenAddress.toLowerCase().includes(e.toLowerCase())&&n.push(t);case 1:case"end":return i.stop()}},r,this)}));return function(e){return t.apply(this,arguments)}}()));case 10:a(n),r.next=16;break;case 13:r.prev=13,r.t0=r["catch"](5),console.error(r.t0);case 16:return r.prev=16,w(!1),r.finish(16);case 19:case"end":return r.stop()}},t,this,[[5,13,16,19]])}));return function(n){return e.apply(this,arguments)}}(),x=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:g(e),n=i?[]:l;if(!i){r.next=5;break}return r.next=5,Promise.all(l.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e&&e.metadata.rewardTokenAddress.toLowerCase().includes(i.toLowerCase())&&n.push(e);case 1:case"end":return r.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()));case 5:r.t0=e,r.next=r.t0==="0"?8:r.t0==="1"?10:r.t0==="2"?12:r.t0==="3"?14:r.t0==="4"?16:18;break;case 8:return a(n),r.abrupt("break",19);case 10:return a(n.sort(function(e,t){return parseFloat(t.metadata.rewardPerBlock)-parseFloat(e.metadata.rewardPerBlock)})),r.abrupt("break",19);case 12:return a(n.sort(function(e,t){return parseFloat(e.metadata.rewardPerBlock)-parseFloat(t.metadata.rewardPerBlock)})),r.abrupt("break",19);case 14:return a(n.sort(function(e,t){return parseInt(t.metadata.freeSetups.length+t.metadata.lockedSetups.length)-parseInt(e.metadata.freeSetups.length+e.metadata.lockedSetups.length)})),r.abrupt("break",19);case 16:return a(n.sort(function(e,t){return parseInt(e.metadata.freeSetups.length+e.metadata.lockedSetups.length)-parseInt(t.metadata.freeSetups.length+t.metadata.lockedSetups.length)})),r.abrupt("break",19);case 18:return r.abrupt("break",19);case 19:case"end":return r.stop()}},t,this)}));return function(n){return e.apply(this,arguments)}}();return React.createElement("div",{className:"MainExploration"},React.createElement("div",{className:"SortBox"},React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Sort by token address..",value:i,onChange:function(t){return S(t.target.value)}}),React.createElement("div",{className:"SortOptions"},React.createElement("select",{className:"SelectRegular",value:m,onChange:function(t){return x(t.target.value)}},React.createElement("option",{value:"0"},"Sort by.."),React.createElement("option",{value:"1"},"Higher Rewards per day"),React.createElement("option",{value:"2"},"Lower Rewards per day"),React.createElement("option",{value:"3"},"More Setups"),React.createElement("option",{value:"4"},"Less Setups")),React.createElement("label",null,React.createElement("input",{type:"checkbox",checked:p,onChange:function(t){return d(t.target.checked)}}),React.createElement("p",null,"Only Active")))),b?React.createElement("div",{className:"row mt-4"},React.createElement("div",{className:"col-12 justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"})))):React.createElement("div",{className:"ListOfThings"},u.length===0&&React.createElement("div",{className:"col-12 text-left"},React.createElement("h6",null,React.createElement("b",null,"No farming contract available!"))),u.length>0&&u.map(function(e,n){return p&&(e.metadata.freeSetups.length>0||e.metadata.lockedSetups.length>0)||e.metadata.canActivateSetup||!p?React.createElement(_components.FarmingComponent,{key:e.contract.options.address,className:"FarmContract",dfoCore:t.dfoCore,metadata:e.metadata,hasBorder:!0}):React.createElement("div",{key:n})})))},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(Explore);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_reactRouter=require("react-router"),_components=require("../../../../components"),_Create=_interopRequireDefault(require("./Create")),_CreateOrEditFarmingSetups=_interopRequireDefault(require("./CreateOrEditFarmingSetups")),_shared=require("../../../../components/shared"),_Loading=_interopRequireDefault(require("../../../../components/shared/Loading")),ExploreFarmingContract=function(t){var n=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var r,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=[{name:"Generate SmartContract Proposal",call:function(n){return _asyncToGenerator(regeneratorRuntime.mark(function r(){var t,i,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,window.SolidityUtilities.getCompilers();case 2:n.selectedSolidityVersion=u.sent.releases["0.7.6"],n.bypassFunctionalitySourceId=!0,n.contractName="ProposalCode",n.functionalityMethodSignature="callOneTime(address)",t="FarmingSetFarmingSetupsProposal",i="";for(s in e)o=e[s],i+="        "+("farmingSetups["+s+"] = FarmingSetupConfiguration("+o.add+", "+o.disable+", "+o.index+", FarmingSetupInfo("+o.info.free+", "+o.info.blockDuration+", "+o.info.startBlock+", "+o.info.originalRewardPerBlock+", "+o.info.minStakeable+", "+o.info.maxStakeable+", "+o.info.renewTimes+", "+window.web3.utils.toChecksumAddress(o.info.ammPlugin)+", "+window.web3.utils.toChecksumAddress(o.info.liquidityPoolTokenAddress)+", "+window.web3.utils.toChecksumAddress(o.info.mainTokenAddress)+", "+window.web3.utils.toChecksumAddress(o.info.ethereumAddress)+", "+o.info.involvingETH+", "+o.info.penaltyFee+", "+o.info.setupsCount+", "+o.info.lastSetupIndex+"));")+"\n";return u.next=11,fetch("data/"+t+".sol");case 11:return u.next=13,u.sent.text();case 13:u.t0=e.length,u.t1=i.trim(),u.t2=m.metadata.fullExtension,n.sourceCode=u.sent.format(u.t0,u.t1,u.t2),console.log(n.sourceCode);case 18:case"end":return u.stop()}},r,this)}))()}}],i={element:t.element,sequentialOps:r,sourceCode:"test",title:"Manage Farming Setups"},window.showProposalLoader(i);case 3:case"end":return s.stop()}},n,this)}));return function(n){return e.apply(this,arguments)}}(),r=t.dfoCore,i=t.farmAddress,s=t.withoutBack,o=(0,_reactRouter.useParams)(),u=o.address;u||(u=i);var a=t.edit,f=(0,_react.useState)([]),l=f[0],c=f[1],h=(0,_react.useState)(null),p=h[0],d=h[1],v=(0,_react.useState)(null),m=v[0],g=v[1],y=(0,_react.useState)(!1),b=y[0],w=y[1],E=(0,_react.useState)(!0),S=E[0],x=E[1],T=(0,_react.useState)(null),N=T[0],C=T[1],k=(0,_react.useState)(!1),L=k[0],A=k[1],O=(0,_react.useState)(null),M=O[0],_=O[1],D=(0,_react.useState)(!1),P=D[0],H=D[1],B=(0,_react.useState)([]),j=B[0],F=B[1],I=(0,_react.useState)(0),q=I[0],R=I[1];(0,_react.useEffect)(function(){r&&U()},[]),(0,_react.useEffect)(function(){b&&!a&&w(!1)});var U=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,i,s,o,a,f,l,h,p,v,m,y,b,w,E,S,T,N,k,L,A,O,M,D,P;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return x(!0),H.prev=1,H.next=4,r.getContract(r.getContextElement("FarmMainABI"),u);case 4:return e=H.sent,d(e),H.next=8,e.methods._rewardTokenAddress().call();case 8:return i=H.sent,H.next=11,r.getContract(r.getContextElement("ERC20ABI"),i);case 11:return s=H.sent,H.next=14,s.methods.symbol().call();case 14:return o=H.sent,H.next=17,s.methods.decimals().call();case 17:return a=H.sent,_({symbol:o,address:i,decimals:a}),H.next=21,e.methods._extension().call();case 21:return f=H.sent,H.next=24,r.getContract(r.getContextElement("FarmExtensionABI"),f);case 24:return l=H.sent,C(l),H.next=28,l.methods.data().call();case 28:return h=H.sent,p=h.host,v=h.byMint,H.next=33,e.methods.setups().call();case 33:return m=H.sent,H.next=36,r.getBlockNumber();case 36:y=H.sent,b=[],w=[],E=0,S=0,T=0,N=!1,k=[],L=0;case 45:if(!(L<m.length)){H.next=57;break}return H.next=48,t.dfoCore.loadFarmingSetup(e,L);case 48:A=H.sent,O=A[0],M=A[1],N||(N=parseInt(M.renewTimes)>0&&!O.active&&parseInt(M.lastSetupIndex)===parseInt(L)),O.rewardPerBlock!=="0"&&(M.free?E+=1:S+=1,k.push(_extends({},O,{setupInfo:M,rewardTokenAddress:i,setupIndex:L,finished:parseInt(y)>parseInt(O.endBlock)&&parseInt(O.endBlock)!==0||parseInt(O.endBlock)===0&&parseInt(M.renewTimes)===0}))),O.active&&parseInt(O.endBlock)>y&&(M.free?b.push(O):w.push(O),T+=parseInt(O.rewardPerBlock));case 54:L++,H.next=45;break;case 57:D=k.sort(function(e,t){return t.active-e.active}),c(D),P={name:"Farm "+o,contractAddress:e.options.address,rewardTokenAddress:s.options.address,rewardPerBlock:r.toDecimals(r.toFixed(T).toString(),a),byMint:v,freeSetups:b,lockedSetups:w,totalFreeSetups:E,totalLockedSetups:S,canActivateSetup:N,extension:f.substring(0,5)+"..."+f.substring(f.length-3,f.length),fullExtension:""+f,farmAddress:e.options.address.substring(0,5)+"..."+e.options.address.substring(e.options.address.length-3,e.options.address.length),host:p.substring(0,5)+"..."+p.substring(p.length-3,p.length),fullhost:""+p},g({contract:e,metadata:P,isActive:b+w>0||N}),H.next=66;break;case 63:H.prev=63,H.t0=H["catch"](1),console.error(H.t0);case 66:return H.prev=66,x(!1),H.finish(66);case 69:case"end":return H.stop()}},n,this,[[1,63,66,69]])}));return function(){return e.apply(this,arguments)}}(),z=function(t){return t.toLowerCase()===r.getContextElement("wethTokenAddress").toLowerCase()||t===r.voidEthereumAddress},W=function(t){F(j.concat(t))},X=function(t,n){var r=j.map(function(e,r){return r!==n?e:t});F(r)},V=function(t){var n=j.filter(function(e,n){return n!==t});F(n)},$=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function i(){var e,s,o,u,a,f,l,c,h,p,d,v;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return console.log(j),A(!0),m.prev=2,e=[],m.next=6,r.getContract(r.getContextElement("AMMAggregatorABI"),r.getContextElement("ammAggregatorAddress"));case 6:s=m.sent,o="0",m.t0=regeneratorRuntime.keys(j);case 9:if((m.t1=m.t0()).done){m.next=34;break}return u=m.t1.value,a=j[u],o=t.dfoCore.web3.utils.toBN(o).add(t.dfoCore.web3.utils.toBN(window.numberToString(t.dfoCore.fromDecimals(window.numberToString(a.rewardPerBlock),M.decimals))).mul(t.dfoCore.web3.utils.toBN(window.numberToString(a.blockDuration)))).toString(),f=a.free,m.next=16,s.methods.findByLiquidityPool(a.liquidityPoolToken.address).call();case 16:return l=m.sent,c=l.amm,h=f?a.liquidityPoolToken.tokens[0].address:a.mainToken.address,m.next=21,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),h);case 21:p=m.sent;if(h!==window.voidEthereumAddress){m.next=26;break}m.t2=18,m.next=29;break;case 26:return m.next=28,p.methods.decimals().call();case 28:m.t2=m.sent;case 29:d=m.t2,v={add:!0,disable:!1,index:0,info:{free:f,blockDuration:parseInt(a.blockDuration),startBlock:parseInt(a.startBlock),originalRewardPerBlock:window.numberToString(t.dfoCore.fromDecimals(window.numberToString(a.rewardPerBlock),M.decimals)),minStakeable:window.numberToString(t.dfoCore.fromDecimals(window.numberToString(a.minStakeable),d)),maxStakeable:f?0:window.numberToString(t.dfoCore.fromDecimals(window.numberToString(a.maxStakeable)),d),renewTimes:a.renewTimes,ammPlugin:c,liquidityPoolTokenAddress:a.liquidityPoolToken.address,mainTokenAddress:h,ethereumAddress:r.voidEthereumAddress,involvingETH:a.involvingEth,penaltyFee:f?0:t.dfoCore.fromDecimals(window.numberToString(parseFloat(a.penaltyFee)/100)),setupsCount:0,lastSetupIndex:0}},e.push(v),m.next=9;break;case 34:return m.next=36,n(e);case 36:m.next=41;break;case 38:m.prev=38,m.t3=m["catch"](2),console.error(m.t3);case 41:case"end":return m.stop()}},i,this,[[2,38]])}));return function(){return e.apply(this,arguments)}}();if(S)return React.createElement(_Loading.default,null);var J=l.filter(function(e){return!e.setupInfo.free&&!e.finished}),K=l.filter(function(e){return e.setupInfo.free&&!e.finished}),Q=l.filter(function(e){return e.finished});return q?React.createElement("div",null,React.createElement("h3",null,"Congratulations!"),React.createElement("p",null,"In order to be able to activate the new setups you created, ",m.metadata.byMint?"be sure to grant the permission to mint at least":"you must send"," ",React.createElement("b",null,window.fromDecimals(q,M.decimals,!0))," ",M.symbol," ",React.createElement(_shared.Coin,{address:M.address})," ",m.metadata.byMint?"for the extension":"to its extension, having address"," ",React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"address/"+m.metadata.fullExtension,target:"_blank"},m.metadata.fullExtension)),React.createElement("a",{href:"javascript:;",onClick:function(){return R("")}},"Got it")):React.createElement("div",{className:"ListOfThings"},p&&m?React.createElement("div",{className:"row"},React.createElement(_components.FarmingComponent,{className:"FarmContractOpen",dfoCore:r,contract:m.contract,metadata:m.metadata,goBack:!1,withoutBack:s,hostedBy:a})):React.createElement("div",null),a&&React.createElement(React.Fragment,null,!b&&React.createElement("button",{className:"btn btn-primary",onClick:function(){return w(!0)}},"Add new setups")),b&&React.createElement("div",{className:"ListOfThings"},!1,b&&React.createElement(_CreateOrEditFarmingSetups.default,{rewardToken:M,farmingSetups:j,onAddFarmingSetup:function(t){return W(t)},onRemoveFarmingSetup:function(t){return V(t)},onEditFarmingSetup:function(t,n){return X(t,n)},onCancel:function(){F([]),w(!1)},onFinish:function(){},finishButton:L?React.createElement(_Loading.default,null):React.createElement("button",{className:"btn btn-primary",onClick:function(){return $()}},"Update setups"),forEdit:!0})))},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(ExploreFarmingContract);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _Coin=_interopRequireDefault(require("../coin/Coin")),_reactRouterDom=require("react-router-dom"),FarmingComponent=function(t){var n=t.className,r=t.goBack,i=t.metadata,s=t.dfoCore,o=t.withoutBack,u=i.name.replace("Farm ","");return React.createElement("div",{className:n},i?React.createElement(React.Fragment,null,React.createElement("div",{className:"FarmTitle"},React.createElement("figure",null,i.rewardTokenAddress!==s.voidEthereumAddress?React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"token/"+i.rewardTokenAddress},React.createElement(_Coin.default,{height:45,address:i.rewardTokenAddress})):React.createElement(_Coin.default,{height:45,address:i.rewardTokenAddress})),React.createElement("aside",null,React.createElement("h6",null,React.createElement("b",null,i.name)," ",i.freeSetups.length+i.lockedSetups.length===0&&!i.canActivateSetup?React.createElement("span",{className:"text-danger"},React.createElement("b",null,"(inactive)")):React.createElement(React.Fragment,null)),!o&&React.createElement(_reactRouterDom.Link,{to:r?"/farm/dapp/":"/farm/dapp/"+i.contractAddress,className:r?"backActionBTN":"web2ActionBTN"},r?"Back":"Open"))),React.createElement("div",{className:"FarmThings"},React.createElement("p",null,React.createElement("b",null,"Daily Rate"),": ",i.rewardPerBlock*6400," ",u),React.createElement("p",null,React.createElement("b",null,"Active Setups"),": ",i.freeSetups.length+i.lockedSetups.length," "),React.createElement("div",{className:"StatsLink"},React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"address/"+i.contractAddress},"Contract"),React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"address/"+i.fullhost},"Host"),React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"address/"+i.fullExtension},"Extension"))),r&&React.createElement(React.Fragment,null,React.createElement("div",{className:"FarmThings"}))):React.createElement("div",{className:"col-12 justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"}))))},_default=FarmingComponent;exports.default=_default;exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_components=require("../../../../components"),Hosted=function(t){var n=t.dfoCore,r=(0,_react.useState)(""),i=r[0],s=r[1],o=(0,_react.useState)([]),u=o[0],a=o[1],f=(0,_react.useState)([]),l=f[0],c=f[1],h=(0,_react.useState)(!0),p=h[0],d=h[1];(0,_react.useEffect)(function(){n&&v()},[]);var v=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return d(!0),s.prev=1,s.next=4,n.getHostedFarmingContracts();case 4:return e=s.sent,s.next=7,Promise.all(e.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.prev=0,x.next=3,n.getContract(n.getContextElement("FarmMainABI"),e.address);case 3:return i=x.sent,x.next=6,i.methods._rewardTokenAddress().call();case 6:return s=x.sent,x.next=9,n.getContract(n.getContextElement("ERC20ABI"),s);case 9:return o=x.sent,x.next=12,o.methods.symbol().call();case 12:return u=x.sent,x.next=15,o.methods.decimals().call();case 15:return a=x.sent,x.next=18,i.methods._extension().call();case 18:return f=x.sent,x.next=21,n.getContract(n.getContextElement("FarmExtensionABI"),f);case 21:return l=x.sent,x.next=24,l.methods.data().call();case 24:return c=x.sent,h=c.host,p=c.byMint,x.next=29,n.getBlockNumber();case 29:return d=x.sent,x.next=32,i.methods.setups().call();case 32:return v=x.sent,m=[],g=[],y=0,b=0,w=0,E=!1,x.next=41,Promise.all(v.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,r){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.dfoCore.loadFarmingSetup(i,r);case 2:s=a.sent,o=s[0],u=s[1],E||(E=parseInt(u.renewTimes)>0&&!e.active&&parseInt(u.lastSetupIndex)===parseInt(r)),e.active&&parseInt(e.endBlock)>d&&(u.free?m.push(e):g.push(e),w+=parseInt(e.rewardPerBlock)),e.rewardPerBlock!=="0"&&(u.free?y+=1:b+=1);case 8:case"end":return a.stop()}},n,this)}));return function(t,n){return e.apply(this,arguments)}}()));case 41:return S={name:"Farm "+u,contractAddress:i.options.address,rewardTokenAddress:o.options.address,rewardPerBlock:n.toDecimals(n.toFixed(w).toString(),a),byMint:p,freeSetups:m,lockedSetups:g,totalFreeSetups:y,totalLockedSetups:b,canActivateSetup:E,extension:f.substring(0,5)+"..."+f.substring(f.length-3,f.length),fullExtension:""+f,farmAddress:i.options.address.substring(0,5)+"..."+i.options.address.substring(i.options.address.length-3,i.options.address.length),host:h.substring(0,5)+"..."+h.substring(h.length-3,h.length),fullhost:""+h},x.abrupt("return",{contract:i,metadata:S,isActive:m.length+g.length>0||E});case 45:x.prev=45,x.t0=x["catch"](0),console.error(x.t0);case 48:case"end":return x.stop()}},r,this,[[0,45]])}));return function(t){return e.apply(this,arguments)}}()));case 7:i=s.sent,a(i.filter(function(e){return e}).sort(function(e,t){return e.isActive===t.isActive?0:e.isActive?-1:1})),c(i.filter(function(e){return e}).sort(function(e,t){return e.isActive===t.isActive?0:e.isActive?-1:1})),s.next=17;break;case 12:s.prev=12,s.t0=s["catch"](1),console.error(s.t0),a([]),c([]);case 17:return s.prev=17,d(!1),s.finish(17);case 20:case"end":return s.stop()}},r,this,[[1,12,17,20]])}));return function(){return e.apply(this,arguments)}}(),m=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=4;break}return s(""),a(l),r.abrupt("return");case 4:return d(!0),r.prev=5,s(e),n=[],r.next=10,Promise.all(l.map(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function r(t){var i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.methods._rewardTokenAddress().call();case 2:i=s.sent,i.toLowerCase().includes(e.toLowerCase())&&n.push(t);case 4:case"end":return s.stop()}},r,this)}));return function(e){return t.apply(this,arguments)}}()));case 10:a(n),r.next=16;break;case 13:r.prev=13,r.t0=r["catch"](5),console.error(r.t0);case 16:return r.prev=16,d(!1),r.finish(16);case 19:case"end":return r.stop()}},t,this,[[5,13,16,19]])}));return function(n){return e.apply(this,arguments)}}();return React.createElement("div",{className:"MainExploration"},React.createElement("h6",null,React.createElement("b",null,"Reward token address")),React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Reward token address..",value:i,onChange:function(t){return m(t.target.value)}}),p?React.createElement("div",{className:"row mt-4"},React.createElement("div",{className:"col-12 justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"})))):React.createElement("div",{className:"ListOfThings"},u.length===0&&React.createElement("div",{className:"col-12 text-left"},React.createElement("h6",null,React.createElement("b",null,"No farming contract available!"))),u.length>0&&u.map(function(e){return React.createElement(_components.FarmingComponent,{key:e.contract.options.address,className:"FarmContract",dfoCore:n,metadata:e.metadata,hostedBy:!0,hasBorder:!0})})))},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(Hosted);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_ApproveButton=_interopRequireDefault(require("../buttons/ApproveButton")),LockedPositionComponent=function(t){var n=t.position,r=t.dfoCore,i=t.blockNumber,s=t.setup,o=t.setupInfo,u=t.mainTokenInfo,a=t.onRewardTokenApproval,f=t.setupTokens,l=t.rewardTokenInfo,c=t.lockedPositionReward,h=t.lockedPositionStatus,p=t.lpTokenInfo,d=t.lmContract,v=t.onComplete,m=t.farmTokenSymbol,g=t.farmTokenDecimals,y=(0,_react.useState)(!1),b=y[0],w=y[1],E=(0,_react.useState)(!1),S=E[0],x=E[1],T=(0,_react.useState)(!1),N=T[0],C=T[1],k=(0,_react.useState)(!1),L=k[0],A=k[1],O=(0,_react.useState)(!1),M=O[0],_=O[1],D=(0,_react.useState)(""),P=D[0],H=D[1],B=0;f.forEach(function(e,t){e.address===o.mainTokenAddress&&(B=t)});var j=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(P){s.next=2;break}return s.abrupt("return");case 2:return A(!0),s.prev=3,s.next=6,d.methods.transferPosition(P,n.positionId).estimateGas({from:r.address});case 6:return e=s.sent,s.next=9,d.methods.transferPosition(P,n.positionId).send({from:r.address,gasLimit:e,gas:e});case 9:i=s.sent,v(i),s.next=16;break;case 13:s.prev=13,s.t0=s["catch"](3),console.error(s.t0);case 16:return s.prev=16,A(!1),s.finish(16);case 19:case"end":return s.stop()}},t,this,[[3,13,16,19]])}));return function(){return e.apply(this,arguments)}}(),F=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return C(!0),s.prev=1,s.next=4,d.methods.unlock(n.positionId,!1).estimateGas({from:r.address});case 4:return e=s.sent,s.next=7,d.methods.unlock(n.positionId,!1).send({from:r.address,gasLimit:e,gas:e});case 7:i=s.sent,v(i),s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](1),console.error(s.t0);case 14:return s.prev=14,C(!1),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return _(!0),s.prev=1,s.next=4,d.methods.withdrawReward(n.positionId).estimateGas({from:r.address});case 4:return e=s.sent,s.next=7,d.methods.withdrawReward(n.positionId).send({from:r.address,gasLimit:e,gas:e});case 7:i=s.sent,v(i),s.next=14;break;case 11:s.prev=11,s.t0=s["catch"](1),console.error(s.t0);case 14:return s.prev=14,_(!1),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])}));return function(){return e.apply(this,arguments)}}(),q=parseInt(parseInt(n.reward)*(parseInt(o.penaltyFee)/1e18));return React.createElement("div",{className:"LockedFarmPositions"},React.createElement("div",{className:"FarmYou"},React.createElement("p",null,React.createElement("b",null,"Position Weight"),": ",window.formatMoney(window.fromDecimals(n.mainTokenAmount,u.decimals,!0),6)," ",u.symbol),parseInt(i)<parseInt(s.endBlock)&&!S&&React.createElement("a",{onClick:function(){return x(!0)},className:"web2ActionBTN"},"Unlock"),S&&React.createElement("a",{onClick:function(){return x(!1)},className:"backActionBTN"},"Close"),S&&React.createElement("div",{className:"UnlockDiv"},React.createElement("p",{className:"UnlockInfo"},window.formatMoney(window.fromDecimals(q+parseInt(h.partiallyRedeemed),l.decimals,!0),6)," ",l.symbol," - ",window.formatMoney(r.toDecimals(n.liquidityPoolTokenAmount,parseInt(p.decimals)),parseInt(p.decimals))," ","fLP"," needed to Unlock this position"),React.createElement("p",{className:"UnlockInfoBal"},"Balance: ",window.formatMoney(window.fromDecimals(l.balance,l.decimals,!0),6)," ",l.symbol," - ",window.formatMoney(window.fromDecimals(n.liquidityPoolTokenAmount,parseInt(p.decimals),!0),9)," fLP"),l.approval?N?React.createElement("a",{className:"Web3ActionBTN",disabled:N},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):parseInt(i)<parseInt(s.endBlock)?React.createElement("a",{onClick:function(){return F()},className:"Web3ActionBTN"},"Unlock"):React.createElement(React.Fragment,null):React.createElement(_ApproveButton.default,{contract:l.contract,from:r.address,spender:d.options.address,onApproval:function(){return a()},onError:function(t){return console.error(t)},text:"Approve "+l.symbol}))),React.createElement("div",{className:"Farmed"},React.createElement("p",null,React.createElement("b",null,"Reward"),": ",window.formatMoney(r.toDecimals(r.toFixed(n.reward),l.decimals),l.decimals)," ",l.symbol),React.createElement("p",null,React.createElement("b",null,"Available"),": ",window.formatMoney(r.toDecimals(r.toFixed(c),l.decimals),l.decimals)," ",l.symbol),b?React.createElement("a",{onClick:function(){return w(!1)},className:"backActionBTN"},"Close"):React.createElement("a",{onClick:function(){return w(!0)},className:"web2ActionBTN"},"Transfer"),M?React.createElement("a",{className:"Web3ActionBTN",disabled:M},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{onClick:function(){return I()},className:"Web3ActionBTN"},"Claim"),b&&React.createElement("div",{className:"Tranferpos"},React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Position receiver",value:P,onChange:function(t){return H(t.target.value)},id:"transferAddress"}),L?React.createElement("a",{className:"Web3ActionBTN",disabled:L},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{onClick:function(){return j()},className:"Web3ActionBTN"},"Transfer"))))},_default=LockedPositionComponent;exports.default=_default;exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_components=require("../../../../components"),Positions=function(t){var n=(0,_react.useState)([]),r=n[0],i=n[1],s=(0,_react.useState)(!0),o=s[0],u=s[1];(0,_react.useEffect)(function(){a()},[]);var a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u(!0),n.prev=1,n.next=4,t.dfoCore.loadPositions();case 4:i(t.dfoCore.positions),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](1),console.error(n.t0),i([]);case 11:return n.prev=11,u(!1),n.finish(11);case 14:case"end":return n.stop()}},n,this,[[1,7,11,14]])}));return function(){return e.apply(this,arguments)}}();return React.createElement("div",{className:"MainExploration"},o?React.createElement("div",{className:"row mt-4"},React.createElement("div",{className:"col-12 justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"})))):React.createElement("div",{className:"ListOfThings"},r.length===0&&React.createElement("div",{className:"col-12 text-left"},React.createElement("h6",null,React.createElement("b",null,"No opened positions!"))),r.length>0&&r.map(function(e){return React.createElement(_components.SetupComponent,{className:"FarmSetup",setupIndex:e.setupIndex,setupInfo:e.setupInfo,key:e.contract.options.address+"-"+e.setupInfo,lmContract:e.contract,dfoCore:t.dfoCore,setup:e,hasBorder:!0})})))},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(Positions);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}exports.__esModule=!0,exports.default=void 0;var _Coin=_interopRequireDefault(require("../coin/Coin")),_react=require("react"),_2=require(".."),_reactRedux=require("react-redux"),_actions=require("../../../store/actions"),_axios=_interopRequireDefault(require("axios")),_LockedPositionComponent=_interopRequireDefault(require("./LockedPositionComponent")),_metamaskFox=_interopRequireDefault(require("../../../assets/images/metamask-fox.svg")),_Loading=_interopRequireDefault(require("../Loading")),SetupComponent=function(t){function vr(){var e=t.dfoCore.getContextElement("farmingPrestoAddress"),n=t.dfoCore.getContextElement("farmingPrestoAddressOld"),r=t.dfoCore.getContextElement("oldFarmingPrestoContracts").map(function(e){return t.dfoCore.web3.utils.toChecksumAddress(e)}),i=t.dfoCore.web3.utils.toChecksumAddress(s.options.address);return r.indexOf(i)===-1?e:n}var n=t.className,r=t.dfoCore,i=t.setupIndex,s=t.lmContract,o=t.hostedBy,u=(0,_react.useState)(null),a=u[0],f=u[1],l=(0,_react.useState)(null),c=l[0],h=l[1],p=(0,_react.useState)(0),d=p[0],v=p[1],m=(0,_react.useState)(!0),g=m[0],y=m[1],b=(0,_react.useState)(!1),w=b[0],E=b[1],S=(0,_react.useState)(!1),x=S[0],T=S[1],N=(0,_react.useState)(!1),C=N[0],k=N[1],L=(0,_react.useState)(!1),A=L[0],O=L[1],M=(0,_react.useState)(!1),_=M[0],D=M[1],P=(0,_react.useState)(!1),H=P[0],B=P[1],j=(0,_react.useState)(!1),F=j[0],I=j[1],q=(0,_react.useState)(!1),R=q[0],U=q[1],z=(0,_react.useState)(!1),W=z[0],X=z[1],V=(0,_react.useState)(!1),$=V[0],J=V[1],K=(0,_react.useState)(!1),Q=K[0],G=K[1],Y=(0,_react.useState)(!1),Z=Y[0],et=Y[1],tt=(0,_react.useState)({name:"",version:""}),nt=tt[0],rt=tt[1],it=(0,_react.useState)(null),st=it[0],ot=it[1],ut=(0,_react.useState)(""),at=ut[0],ft=ut[1],lt=(0,_react.useState)(null),ct=lt[0],ht=lt[1],pt=(0,_react.useState)(18),dt=pt[0],vt=pt[1],mt=(0,_react.useState)(""),gt=mt[0],yt=mt[1],bt=(0,_react.useState)(""),wt=bt[0],Et=bt[1],St=(0,_react.useState)("0"),xt=St[0],Tt=St[1],Nt=(0,_react.useState)([]),Ct=Nt[0],kt=Nt[1],Lt=(0,_react.useState)([]),At=Lt[0],Ot=Lt[1],Mt=(0,_react.useState)([]),_t=Mt[0],Dt=Mt[1],Pt=(0,_react.useState)([]),Ht=Pt[0],Bt=Pt[1],jt=(0,_react.useState)([]),Ft=jt[0],It=jt[1],qt=(0,_react.useState)(0),Rt=qt[0],Ut=qt[1],zt=(0,_react.useState)(0),Wt=zt[0],Xt=zt[1],Vt=(0,_react.useState)(0),$t=Vt[0],Jt=Vt[1],Kt=(0,_react.useState)(null),Qt=Kt[0],Gt=Kt[1],Yt=(0,_react.useState)(null),Zt=Yt[0],en=Yt[1],tn=(0,_react.useState)(null),nn=tn[0],rn=tn[1],sn=(0,_react.useState)(0),on=sn[0],un=sn[1],an=(0,_react.useState)(null),fn=an[0],ln=an[1],cn=(0,_react.useState)(null),hn=cn[0],pn=cn[1],dn=(0,_react.useState)(0),vn=dn[0],mn=dn[1],gn=(0,_react.useState)([]),yn=gn[0],bn=gn[1],wn=(0,_react.useState)([]),En=wn[0],Sn=wn[1],xn=(0,_react.useState)([]),Tn=xn[0],Nn=xn[1],Cn=(0,_react.useState)(0),kn=Cn[0],Ln=Cn[1],An=(0,_react.useState)(0),On=An[0],Mn=An[1],_n=(0,_react.useState)(!1),Dn=_n[0],Pn=_n[1],Hn=(0,_react.useState)(""),Bn=Hn[0],jn=Hn[1],Fn=(0,_react.useState)(0),In=Fn[0],qn=Fn[1],Rn=(0,_react.useState)("add-pair"),Un=Rn[0],zn=Rn[1],Wn=(0,_react.useState)("to-pair"),Xn=Wn[0],Vn=Wn[1],$n=(0,_react.useState)(0),Jn=$n[0],Kn=$n[1],Qn=(0,_react.useState)("0"),Gn=Qn[0],Yn=Qn[1],Zn=(0,_react.useRef)(null),er=(0,_react.useState)(null),tr=er[0],nr=er[1],rr=(0,_react.useState)(0),ir=rr[0],sr=rr[1],or=(0,_react.useState)(0),ur=or[0],ar=or[1],fr=(0,_react.useState)(!1),lr=fr[0],cr=fr[1],hr=(0,_react.useState)(0),pr=hr[0],dr=hr[1],mr=new t.dfoCore.web3.eth.Contract(t.dfoCore.getContextElement("FarmingPrestoABI"),vr());(0,_react.useEffect)(function(){return gr(),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){var n,r,i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n=[],d.next=3,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMAggregatorABI"),t.dfoCore.getContextElement("ammAggregatorAddress"));case 3:return r=d.sent,d.next=6,r.methods.amms().call();case 6:i=d.sent,s=i,o=Array.isArray(s),u=0,s=o?s:s[Symbol.iterator]();case 8:if(!o){d.next=14;break}if(!(u>=s.length)){d.next=11;break}return d.abrupt("break",34);case 11:a=s[u++],d.next=18;break;case 14:u=s.next();if(!u.done){d.next=17;break}return d.abrupt("break",34);case 17:a=u.value;case 18:return f=a,d.next=21,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMABI"),f);case 21:return l=d.sent,d.t0=f,d.t1=l,d.next=26,l.methods.info().call();case 26:return d.t2=d.sent,d.next=29,l.methods.data().call();case 29:d.t3=d.sent,c={address:d.t0,contract:d.t1,info:d.t2,data:d.t3},c.data[2]&&n.push(c);case 32:d.next=8;break;case 34:sr(0),h=n.filter(function(e){return e.info[0]==="UniswapV2"})[0],p=n.indexOf(h),n.splice(p,1),n.unshift(h),ar(n);case 40:case"end":return d.stop()}},e,this)}))),function(){clearInterval(Zn.current)}},[]),(0,_react.useEffect)(function(){Pr(Jn)},[Bn,ir]);var gr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return y(!0),u.prev=1,u.next=4,t.dfoCore.loadFarmingSetup(s,i);case 4:return e=u.sent,r=e[0],o=e[1],f(r),h(o),et(!1),u.next=12,yr(r,o,!0);case 12:Zn.current||(Zn.current=setInterval(_asyncToGenerator(regeneratorRuntime.mark(function a(){var e,n,r;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,t.dfoCore.loadFarmingSetup(s,i);case 2:return e=u.sent,n=e[0],r=e[1],f(n),h(r),u.next=9,yr(n,r);case 9:case"end":return u.stop()}},a,this)})),5e3)),u.next=18;break;case 15:u.prev=15,u.t0=u["catch"](1),console.error(u.t0);case 18:return u.prev=18,y(!1),u.finish(18);case 21:case"end":return u.stop()}},n,this,[[1,15,18,21]])}));return function(){return e.apply(this,arguments)}}(),yr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,o,u){var a,f,l,c,h,p,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,j,F,I,q,R,z,W,X,V,$,K,Q,Y,Z,et,tt,nt,it,st,ut,at,ft,lt,ct,pt,dt,mt,gt,bt,wt,St,xt,Nt,Ct,Lt,At,Mt,_t,Pt,Ht,jt,Ft,qt,Rt,zt,Wt,Vt,$t,Jt,Kt,Qt,Yt;return regeneratorRuntime.wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:return a=null,f=[],l=[],Zt.next=5,s.methods._farmTokenCollection().call();case 5:return c=Zt.sent,Zt.next=8,t.dfoCore.getContract(t.dfoCore.getContextElement("INativeV1ABI"),c);case 8:return h=Zt.sent,Zt.next=11,r.getContract(r.getContextElement("AMMABI"),o.ammPlugin);case 11:p=Zt.sent,ot(p);if(e.free){Zt.next=39;break}m=e.objectId;if(m==="0"){Zt.next=38;break}return Zt.next=18,h.methods.balanceOf(t.dfoCore.address,m).call();case 18:return g=Zt.sent,Zt.next=21,h.methods.symbol(m).call();case 21:return y=Zt.sent,Zt.next=24,h.methods.decimals(m).call();case 24:return b=Zt.sent,Zt.next=27,h.methods.asInteroperable(m).call();case 27:return w=Zt.sent,yt(w),Et(y),Tt(g),vt(b),Zt.next=34,p.methods.byLiquidityPoolAmount(o.liquidityPoolTokenAddress,g).call();case 34:E=Zt.sent,kt(E.tokensAmounts),Zt.next=39;break;case 38:Tt("0");case 39:return u&&Xt(0),Mn(o.renewTimes),Ln(e.rewardPerBlock),Zt.next=44,window.getLogs({address:s.options.address,topics:[window.web3.utils.sha3("Transfer(uint256,address,address)")],fromBlock:t.dfoCore.getContextElement("deploySearchStart"),toBlock:"latest"});case 44:S=Zt.sent,x=0;case 46:if(!(x<S.length)){Zt.next=57;break}return T=S[x],N=T.topics,C=t.dfoCore.web3.eth.abi.decodeParameter("uint256",N[1]),Zt.next=52,s.methods.position(C).call();case 52:k=Zt.sent,r.isValidPosition(k)&&parseInt(k.setupIndex)===parseInt(i)&&(o.free?a=_extends({},k,{positionId:C}):l.includes(C)||(f.push(_extends({},k,{positionId:C})),l.push(C)));case 54:x++,Zt.next=46;break;case 57:return ln(a),bn(f),!a&&u&&(B(!1),U(!1)),Zt.next=62,s.methods._extension().call();case 62:return L=Zt.sent,Zt.next=65,r.getContract(r.getContextElement("FarmExtensionABI"),L);case 65:return A=Zt.sent,u&&ht(A),Zt.next=69,s.methods._rewardTokenAddress().call();case 69:O=Zt.sent,M=O===r.voidEthereumAddress;if(M){Zt.next=77;break}return Zt.next=74,r.getContract(r.getContextElement("ERC20ABI"),O);case 74:Zt.t0=Zt.sent,Zt.next=78;break;case 77:Zt.t0=null;case 78:_=Zt.t0;if(M){Zt.next=85;break}return Zt.next=82,_.methods.symbol().call();case 82:Zt.t1=Zt.sent,Zt.next=86;break;case 85:Zt.t1="ETH";case 86:D=Zt.t1;if(M){Zt.next=93;break}return Zt.next=90,_.methods.decimals().call();case 90:Zt.t2=Zt.sent,Zt.next=94;break;case 93:Zt.t2=18;case 94:P=Zt.t2;if(M){Zt.next=101;break}return Zt.next=98,_.methods.allowance(r.address,s.options.address).call();case 98:Zt.t3=Zt.sent,Zt.next=102;break;case 101:Zt.t3=253;case 102:H=Zt.t3;if(M){Zt.next=109;break}return Zt.next=106,_.methods.balanceOf(r.address).call();case 106:Zt.t4=Zt.sent,Zt.next=112;break;case 109:return Zt.next=111,r.web3.eth.getBalance(r.address);case 111:Zt.t4=Zt.sent;case 112:return j=Zt.t4,rn({contract:_,symbol:D,decimals:P,balance:j,address:O,approval:parseInt(H)!==0&&parseInt(H)>=parseInt(j)}),Zt.next=116,r.getBlockNumber();case 116:return F=Zt.sent,v(F),Zt.next=120,r.getContract(r.getContextElement("ERC20ABI"),o.liquidityPoolTokenAddress);case 120:return I=Zt.sent,Zt.next=123,I.methods.symbol().call();case 123:return q=Zt.sent,Zt.next=126,I.methods.decimals().call();case 126:return R=Zt.sent,Zt.next=129,I.methods.balanceOf(r.address).call();case 129:return z=Zt.sent,Zt.next=132,I.methods.allowance(r.address,s.options.address).call();case 132:return W=Zt.sent,Gt({contract:I,symbol:q,decimals:R,balance:z,approval:parseInt(W)!==0&&parseInt(W)>=parseInt(z)}),X=parseInt(o.renewTimes)>0&&!e.active&&parseInt(o.lastSetupIndex)===parseInt(i),J(X),V=window.formatNumber(o.startBlock||0),dr(F>V?0:V),Zt.next=140,A.methods.data().call();case 140:$=Zt.sent,K=$.host,Q=$.byMint,Y=!1;if(M){Zt.next=150;break}return Zt.next=147,_.methods.balanceOf(L).call();case 147:Zt.t5=Zt.sent,Zt.next=153;break;case 150:return Zt.next=152,r.web3.eth.getBalance(L);case 152:Zt.t5=Zt.sent;case 153:return Z=Zt.t5,Zt.prev=154,Zt.next=157,r.getContract(r.getContextElement("dfoDoubleProxyABI"),K);case 157:return et=Zt.sent,Zt.t6=r,Zt.t7=r.getContextElement("dfoProxyABI"),Zt.next=162,et.methods.proxy().call();case 162:return Zt.t8=Zt.sent,Zt.next=165,Zt.t6.getContract.call(Zt.t6,Zt.t7,Zt.t8);case 165:return tt=Zt.sent,Zt.t9=r,Zt.t10=r.getContextElement("dfoStateHolderABI"),Zt.next=170,tt.methods.getStateHolderAddress().call();case 170:return Zt.t11=Zt.sent,Zt.next=173,Zt.t9.getContract.call(Zt.t9,Zt.t10,Zt.t11);case 173:return nt=Zt.sent,Zt.next=176,nt.methods.getBool("farming.authorized."+L.toLowerCase()).call();case 176:Y=Zt.sent,Zt.next=182;break;case 179:Zt.prev=179,Zt.t12=Zt["catch"](154),Y=Q||parseInt(Z)>=parseInt(e.rewardPerBlock)*parseInt(o.blockDuration);case 182:G(Y),it=o.liquidityPoolTokenAddress;if(!o.free){Zt.next=190;break}return Zt.next=187,p.methods.byLiquidityPoolAmount(it,e.totalSupply).call();case 187:st=Zt.sent,Zt.next=196;break;case 190:return Zt.next=192,p.methods.byTokenAmount(it,o.mainTokenAddress,e.totalSupply).call();case 192:return st=Zt.sent,Zt.next=195,p.methods.byLiquidityPoolAmount(it,st.liquidityPoolAmount).call();case 195:st=Zt.sent;case 196:ut=null,at=[],ft=[],lt=[],ct=0;case 201:if(!(ct<st.liquidityPoolTokens.length)){Zt.next=252;break}pt=st.liquidityPoolTokens[ct];if(wr(o,pt)){Zt.next=209;break}return Zt.next=206,r.getContract(r.getContextElement("ERC20ABI"),pt);case 206:Zt.t13=Zt.sent,Zt.next=210;break;case 209:Zt.t13=null;case 210:dt=Zt.t13;if(!dt){Zt.next=217;break}return Zt.next=214,dt.methods.symbol().call();case 214:Zt.t14=Zt.sent,Zt.next=218;break;case 217:Zt.t14="ETH";case 218:mt=Zt.t14;if(!dt){Zt.next=225;break}return Zt.next=222,dt.methods.decimals().call();case 222:Zt.t15=Zt.sent,Zt.next=226;break;case 225:Zt.t15=18;case 226:gt=Zt.t15;if(!dt){Zt.next=233;break}return Zt.next=230,dt.methods.balanceOf(r.address).call();case 230:Zt.t16=Zt.sent,Zt.next=236;break;case 233:return Zt.next=235,r.web3.eth.getBalance(r.address);case 235:Zt.t16=Zt.sent;case 236:bt=Zt.t16;if(!dt){Zt.next=243;break}return Zt.next=240,dt.methods.allowance(r.address,s.options.address).call();case 240:Zt.t17=Zt.sent,Zt.next=244;break;case 243:Zt.t17=!0;case 244:wt=Zt.t17,ft.push(parseInt(wt)!==0&&(parseInt(wt)>=parseInt(bt)||!dt)),at.push({amount:0,balance:r.toDecimals(r.toFixed(bt),gt),liquidity:st.tokensAmounts[ct],decimals:gt,address:dt?pt:r.voidEthereumAddress,symbol:mt}),lt.push(dt),pt.toLowerCase()===o.mainTokenAddress.toLowerCase()&&(ut={approval:parseInt(wt)!==0&&(parseInt(wt)>=parseInt(bt)||!dt),decimals:gt,contract:dt,address:dt?pt:r.voidEthereumAddress,symbol:mt},en(ut));case 249:ct++,Zt.next=201;break;case 252:return Zt.next=254,p.methods.info().call();case 254:St=Zt.sent,rt({name:St[0],version:St[1]}),Ot(at),It(lt),u&&Ut(0),u&&Dt((new Array(at.length)).fill(0)),Bt(ft);if(!a){Zt.next=281;break}return xt=a.free,Nt=a.creationBlock,Ct=a.setupIndex,Lt=a.liquidityPoolTokenAmount,At=a.mainTokenAmount,Zt.next=269,p.methods.byLiquidityPoolAmount(o.liquidityPoolTokenAddress,Lt).call();case 269:return Mt=Zt.sent,console.log(a.positionId),Zt.next=273,s.methods.calculateFreeFarmingReward(a.positionId,!0).call();case 273:_t=Zt.sent,Pt=parseInt(_t),d<parseInt(e.endBlock)&&(Pt+=parseInt(e.rewardPerBlock)*(parseInt(a.liquidityPoolTokenAmount)/parseInt(e.totalSupply))),Pt=window.numberToString(Pt).split(".")[0],mn(Pt),pn({free:xt,creationBlock:Nt,positionSetupIndex:Ct,liquidityPoolAmount:Lt,mainTokenAmount:At,tokensAmounts:Mt.tokensAmounts,tokens:at}),Zt.next=309;break;case 281:if(!(f.length>0)){Zt.next=309;break}Ht=[],jt=[],Ft=0;case 285:if(!(Ft<f.length)){Zt.next=307;break}return qt=f[Ft],Rt=qt.free,zt=qt.creationBlock,Wt=qt.setupIndex,Vt=qt.liquidityPoolTokenAmount,$t=qt.mainTokenAmount,Zt.next=294,p.methods.byLiquidityPoolAmount(o.liquidityPoolTokenAddress,Vt).call();case 294:return Jt=Zt.sent,Zt.next=297,s.methods.calculateLockedFarmingReward(0,0,!0,qt.positionId).call();case 297:return Kt=Zt.sent,Qt=parseInt(Kt.reward)+(parseInt(e.endBlock)<=parseInt(d)?0:parseInt(qt.lockedRewardPerBlock)),Zt.next=301,s.methods._partiallyRedeemed(qt.positionId).call();case 301:Yt=Zt.sent,jt.push(Qt),Ht.push({free:Rt,creationBlock:zt,positionSetupIndex:Wt,partiallyRedeemed:Yt,liquidityPoolAmount:Vt,mainTokenAmount:$t,tokensAmounts:Jt.tokensAmounts,tokens:at});case 304:Ft++,Zt.next=285;break;case 307:Sn(Ht),Nn(jt);case 309:return Zt.t18=qn,Zt.next=312,br(e,o,O,P,at);case 312:Zt.t19=Zt.sent,(0,Zt.t18)(Zt.t19);case 314:case"end":return Zt.stop()}},n,this,[[154,179]])}));return function(n,r,i){return e.apply(this,arguments)}}(),br=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e,n,i,s,o){var u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(parseInt(e.totalSupply)!==0){C.next=2;break}return C.abrupt("return",-1);case 2:return u=2304e3,C.prev=3,C.next=6,window.getEthereumPrice();case 6:return a=C.sent,C.next=9,r.getContextElement("WUSDAddress");case 9:f=C.sent;if(!n.free){C.next=24;break}return l=(i+","+o.map(function(e){return e&&e.address?e.address+",":""})).slice(0,-1),C.next=14,window.getTokenPricesInDollarsOnCoingecko(l);case 14:return c=C.sent,h=c.data,p=i!==r.voidEthereumAddress?i.toLowerCase()===f.toLowerCase()?1:h[i.toLowerCase()].usd:a,d=0,C.next=20,Promise.all(o.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e&&e.address&&(n=e.address!==r.voidEthereumAddress?e.address.toLowerCase()===f.toLowerCase()?1:h[e.address.toLowerCase()].usd:a,d+=n*e.liquidity*Math.pow(10,18-e.decimals));case 1:case"end":return i.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}()));case 20:return v=parseInt(e.rewardPerBlock)*Math.pow(10,18-s)*u*p,C.abrupt("return",v*100/d);case 24:m=n.mainTokenAddress;if(m===r.voidEthereumAddress){C.next=31;break}return C.next=28,r.getContract(r.getContextElement("ERC20ABI"),m);case 28:C.t0=C.sent,C.next=32;break;case 31:C.t0=null;case 32:g=C.t0;if(m===r.voidEthereumAddress){C.next=39;break}return C.next=36,g.methods.decimals().call();case 36:C.t1=C.sent,C.next=40;break;case 39:C.t1=18;case 40:return y=C.t1,b=i+","+m,C.next=44,window.getTokenPricesInDollarsOnCoingecko(b);case 44:return w=C.sent,E=w.data,S=i!==r.voidEthereumAddress?i.toLowerCase()===f.toLowerCase()?1:E[i.toLowerCase()].usd:a,x=m!==r.voidEthereumAddress?m.toLowerCase()===f.toLowerCase()?1:E[m.toLowerCase()].usd:a,T=parseInt(e.rewardPerBlock)*Math.pow(10,18-s)*u*S*100,N=parseInt(n.maxStakeable)*Math.pow(10,18-y)*x*2,C.abrupt("return",T/N);case 51:C.next=56;break;case 53:return C.prev=53,C.t2=C["catch"](3),C.abrupt("return",0);case 56:case"end":return C.stop()}},t,this,[[3,53]])}));return function(n,r,i,s,o){return e.apply(this,arguments)}}(),wr=function(t,n){return n.toLowerCase()===t.ethereumAddress.toLowerCase()&&t.involvingETH},Er=function(t){var n=r.getContextElement("blockIntervals"),i=Object.entries(n).reduce(function(e,t){var n=t[0],r=t[1];return e[r]=n,e},{});return i[t]},Sr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(Q){o.next=2;break}return o.abrupt("return");case 2:return E(!0),o.prev=3,o.next=6,s.methods.activateSetup(i).estimateGas({from:t.dfoCore.address});case 6:return e=o.sent,o.next=9,s.methods.activateSetup(i).send({from:t.dfoCore.address,gas:e});case 9:return r=o.sent,t.addTransaction(r),o.next=13,gr();case 13:o.next=18;break;case 15:o.prev=15,o.t0=o["catch"](3),console.error(o.t0);case 18:return o.prev=18,E(!1),o.finish(18);case 21:case"end":return o.stop()}},n,this,[[3,15,18,21]])}));return function(){return e.apply(this,arguments)}}(),xr=function(t,n){if(n){Gt(_extends({},Qt,{approval:!0}));return}Bt(Ht.map(function(e,n){return n===t?!0:e}))},Tr,Nr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,r){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:Tr&&clearTimeout(Tr);if(e){o.next=6;break}return Xt(0),Jt(0),Dt(_t.map(function(){return 0})),o.abrupt("return");case 6:Tr=setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function u(){var n,o,f,l,h,p,v,m,g,y;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,st.methods.data().call();case 2:return n=b.sent[0],o=At[r].address,o=o===window.voidEthereumAddress?n:o,f=t.dfoCore.toFixed(t.dfoCore.fromDecimals(e,parseInt(At[r].decimals))),b.next=8,st.methods.byTokenAmount(c.liquidityPoolTokenAddress,o,f).call();case 8:return l=b.sent,h=l,p=h.liquidityPoolAmount,b.next=12,st.methods.byLiquidityPoolAmount(c.liquidityPoolTokenAddress,p).call();case 12:l=b.sent,v=l.tokensAmounts,Ut(p),Dt(v.map(function(t,n){return r===n?{value:window.numberToString(e),full:f}:v[n]}));if(c.free){b.next=26;break}m=0,At.forEach(function(e,t){e.address===c.mainTokenAddress&&(m=t)});if(!(parseInt(v[m])>0)){b.next=24;break}return b.next=22,s.methods.calculateLockedFarmingReward(i,v[m],!1,0).call();case 22:g=b.sent,Xt(t.dfoCore.toDecimals(t.dfoCore.toFixed(parseInt(g.relativeRewardPerBlock)*(parseInt(a.endBlock)-d)),nn.decimals));case 24:b.next=27;break;case 26:parseInt(a.totalSupply)+parseInt(p)>0&&(y=parseInt(p)*6400*parseInt(a.rewardPerBlock)/(parseInt(a.totalSupply)+parseInt(p)),isNaN(y)||Jt(t.dfoCore.toDecimals(t.dfoCore.toFixed(y),nn.decimals)));case 27:case"end":return b.stop()}},u,this)})),300);case 7:case"end":return o.stop()}},n,this)}));return function(n,r){return e.apply(this,arguments)}}(),Cr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,r,o){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:Tr&&clearTimeout(Tr);if(!!e&&e!=="NaN"){r.next=5;break}return Xt(0),Jt(0),r.abrupt("return");case 5:Tr=setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function u(){var n,r,f,l,h,p;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,n=o?e:t.dfoCore.toFixed(t.dfoCore.fromDecimals(e,parseInt(Qt.decimals))),Ut({value:window.numberToString(e),full:n}),v.next=5,st.methods.byLiquidityPoolAmount(c.liquidityPoolTokenAddress,n).call();case 5:r=v.sent,f=r.tokensAmounts,Dt(f);if(c.free){v.next=19;break}return l=0,v.next=12,At.map(function(e,t){e.address===c.mainTokenAddress&&(l=t)});case 12:if(!(parseInt(f[l])>0)){v.next=17;break}return v.next=15,s.methods.calculateLockedFarmingReward(i,f[l],!1,0).call();case 15:h=v.sent,Xt(t.dfoCore.toDecimals(t.dfoCore.toFixed(parseInt(h.relativeRewardPerBlock)*(parseInt(a.endBlock)-d)),nn.decimals));case 17:v.next=21;break;case 19:p=parseInt(t.dfoCore.fromDecimals(e,parseInt(Qt.decimals)))*6400*parseInt(a.rewardPerBlock)/(parseInt(a.totalSupply)+parseInt(t.dfoCore.fromDecimals(e,parseInt(Qt.decimals)))),isNaN(p)||Jt(t.dfoCore.toDecimals(window.numberToString(p),nn.decimals));case 21:v.next=26;break;case 23:v.prev=23,v.t0=v["catch"](0),console.error(v.t0);case 26:case"end":return v.stop()}},u,this,[[0,23]])})),300);case 6:case"end":return r.stop()}},n,this)}));return function(n,r,i){return e.apply(this,arguments)}}(),kr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:T(!0),S.prev=1;if(Rt){S.next=4;break}return S.abrupt("return");case 4:return e={setupIndex:i,amount:0,amountIsLiquidityPool:Un==="add-lp"?!0:!1,positionOwner:Dn?Bn:r.voidEthereumAddress},o=null,u=0,a=0,S.next=10,Promise.all(At.map(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,r){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:c.involvingETH&&e.address===t.dfoCore.voidEthereumAddress?o=r:e.address===c.mainTokenAddress&&(a=r);case 1:case"end":return i.stop()}},n,this)}));return function(t,n){return e.apply(this,arguments)}}()));case 10:return f=Rt.full||Rt.toString(),S.next=13,st.methods.byLiquidityPoolAmount(c.liquidityPoolTokenAddress,f).call();case 13:l=S.sent,h=l.tokensAmounts,e.amount=e.amountIsLiquidityPool?f:h[a],u=h[o],p=c.involvingETH&&!e.amountIsLiquidityPool?u:0;if(!tr){S.next=32;break}return console.log("using presto!"),d={from:r.address,value:tr.ethValue,gasLimit:9999999},S.next=23,tr.transaction.estimateGas(d);case 23:return d.gasLimit=S.sent,d.gasLimit=parseInt(d.gasLimit*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),d.gas=d.gasLimit,S.next=28,tr.transaction.send(d);case 28:v=S.sent,t.addTransaction(v),S.next=60;break;case 32:if(!c.free){S.next=53;break}if(!!fn&&!Dn){S.next=43;break}return S.next=36,s.methods.openPosition(e).estimateGas({from:r.address,value:p});case 36:return m=S.sent,S.next=39,s.methods.openPosition(e).send({from:r.address,gas:parseInt(m*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),gasLimit:parseInt(m*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),value:p});case 39:g=S.sent,t.addTransaction(g),S.next=51;break;case 43:if(!fn){S.next=51;break}return S.next=46,s.methods.addLiquidity(fn.positionId,e).estimateGas({from:r.address,value:p});case 46:return y=S.sent,S.next=49,s.methods.addLiquidity(fn.positionId,e).send({from:r.address,gas:parseInt(y*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),gasLimit:parseInt(y*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),value:p});case 49:b=S.sent,t.addTransaction(b);case 51:S.next=60;break;case 53:return S.next=55,s.methods.openPosition(e).estimateGas({from:r.address,value:p});case 55:return w=S.sent,S.next=58,s.methods.openPosition(e).send({from:r.address,gas:parseInt(w*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),gasLimit:parseInt(w*(t.dfoCore.getContextElement("farmGasMultiplier")||1)),value:p});case 58:E=S.sent,t.addTransaction(E);case 60:return S.next=62,gr();case 62:S.next=68;break;case 64:S.prev=64,S.t0=S["catch"](1),console.error(S.t0),Un==="add-eth"&&S.t0.code&&S.t0.code!==4001&&et(!0);case 68:return S.prev=68,T(!1),S.finish(68);case 71:case"end":return S.stop()}},n,this,[[1,64,68,71]])}));return function(){return e.apply(this,arguments)}}(),Lr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,i,o,u,f;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!c.free||!!on&&on!==0){l.next=2;break}return l.abrupt("return");case 2:k(!0),l.prev=3;if(!c.free){l.next=15;break}return e=on===100?hn.liquidityPoolAmount:t.dfoCore.toFixed(parseInt(hn.liquidityPoolAmount)*on/100).toString().split(".")[0],l.next=8,s.methods.withdrawLiquidity(fn.positionId,0,Xn==="to-pair",e).estimateGas({from:r.address});case 8:return i=l.sent,l.next=11,s.methods.withdrawLiquidity(fn.positionId,0,Xn==="to-pair",e).send({from:r.address,gasLimit:i,gas:i});case 11:o=l.sent,t.addTransaction(o),l.next=22;break;case 15:return l.next=17,s.methods.withdrawLiquidity(0,a.objectId,Xn==="to-pair",xt).estimateGas({from:r.address});case 17:return u=l.sent,l.next=20,s.methods.withdrawLiquidity(0,a.objectId,Xn==="to-pair",xt).send({from:r.address,gasLimit:u,gas:u});case 20:f=l.sent,t.addTransaction(f);case 22:return l.next=24,gr();case 24:l.next=29;break;case 26:l.prev=26,l.t0=l["catch"](3),console.error(l.t0);case 29:return l.prev=29,k(!1),l.finish(29);case 32:case"end":return l.stop()}},n,this,[[3,26,29,32]])}));return function(){return e.apply(this,arguments)}}(),Ar=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,i;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return O(!0),o.prev=1,o.next=4,s.methods.withdrawReward(fn.positionId).estimateGas({from:r.address});case 4:return e=o.sent,o.next=7,s.methods.withdrawReward(fn.positionId).send({from:r.address,gasLimit:e,gas:e});case 7:return i=o.sent,t.addTransaction(i),o.next=11,gr();case 11:o.next=16;break;case 13:o.prev=13,o.t0=o["catch"](1),console.error(o.t0);case 16:return o.prev=16,O(!1),o.finish(16);case 19:case"end":return o.stop()}},n,this,[[1,13,16,19]])}));return function(){return e.apply(this,arguments)}}(),Or=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,i){var o,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:if(!c.free){i.next=22;break}return D(!0),i.prev=4,i.next=7,s.methods.transferPosition(at,e).estimateGas({from:r.address});case 7:return o=i.sent,i.next=10,s.methods.transferPosition(at,e).send({from:r.address,gasLimit:o,gas:o});case 10:return u=i.sent,t.addTransaction(u),i.next=14,gr();case 14:i.next=19;break;case 16:i.prev=16,i.t0=i["catch"](4),console.error(i.t0);case 19:return i.prev=19,D(!1),i.finish(19);case 22:case"end":return i.stop()}},n,this,[[4,16,19,22]])}));return function(n,r){return e.apply(this,arguments)}}(),Mr=function(n){if(!n){var r=Ht.findIndex(function(e){return!e});return r!==-1?React.createElement(_2.ApproveButton,{contract:Ft[r],from:t.dfoCore.address,spender:s.options.address,onApproval:function(){return xr(r,!1)},onError:function(t){return console.error(t)},text:"Approve "+At[r].symbol}):React.createElement("div",null)}return Qt.approval?React.createElement("div",null):React.createElement(_2.ApproveButton,{contract:Qt.contract,from:t.dfoCore.address,spender:s.options.address,onApproval:function(){return xr(null,!0)},onError:function(t){return console.error(t)},text:"Approve "+Qt.symbol})},_r=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return zn(e.target.value),i.next=3,t.dfoCore.web3.eth.getBalance(t.dfoCore.address);case 3:r=i.sent,Yn(r),nr(null),et(!1),Kn(0),e.target.value==="add-eth"&&(Ut(0),Dt((new Array(At.length)).fill(0)),Jt("0"),Xt("0"));case 9:case"end":return i.stop()}},n,this)}));return function(n){return e.apply(this,arguments)}}(),Dr=function(t){Vn(t.target.value)},Pr=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var r,o,u,f,l,h,p,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:H.prev=0,r=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(e,n,i,s,o){var a,f,l,c,p,d,v,m,g,y,b,S,x,T,N,C,k,L,A;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,w.methods.byTokens([E,e]).call();case 2:a=O.sent,f=a[2];if(f!==window.voidEthereumAddress){O.next=6;break}return O.abrupt("return",{});case 6:return l=a[3].indexOf(e),c=a[3].indexOf(E),p=window.formatNumber(window.normalizeValue(a[1][l],i)),d=window.formatNumber(window.normalizeValue(a[1][c],18)),v=p*d,m=d+window.formatNumber(window.normalizeValue(u,18)),g=v/m,y=p-g,b=f,O.next=17,w.methods.getSwapOutput(E,o||u,[f],[e]).call();case 17:S=O.sent[1],x=g/p;if(o){O.next=23;break}return O.next=22,r(e,n,i,s,u=window.numberToString(window.formatNumber(u)*x).split(".")[0]);case 22:return O.abrupt("return",O.sent);case 23:return O.next=25,st.methods.byTokenAmount(h,e,S).call();case 25:return T=O.sent,N=T[0],T=T[1][T[2].indexOf(n)],N=window.numberToString(parseInt(N)/x).split(".")[0],T=window.numberToString(parseInt(T)/x).split(".")[0],C=window.formatNumber(window.normalizeValue(S,i)),k=window.formatNumber(window.normalizeValue(T,s)),O.next=34,w.methods.byTokens([E,n]).call();case 34:f=O.sent[2],L=f,A="0";if(L===window.voidEthereumAddress){O.next=41;break}return O.next=40,w.methods.getSwapOutput(n,T,[f],[E]).call();case 40:A=O.sent[1];case 41:return O.abrupt("return",{lpAmount:N,updatedFirstTokenAmount:C,updatedSecondTokenAmount:k,token0Value:S,token1Value:T,token1ValueETH:A,firstTokenEthLiquidityPoolAddress:b,secondTokenEthLiquidityPoolAddress:L});case 42:case"end":return O.stop()}},t,this)}));return function(n,r,i,s,o){return e.apply(this,arguments)}}(),cr(!0),nr(null),Kn(e||"0");if(parseFloat(e)){H.next=7;break}return H.abrupt("return",cr(!1));case 7:return o=window.toDecimals(window.numberToString(e),18),u=t.dfoCore.web3.utils.toBN(o).div(t.dfoCore.web3.utils.toBN(2)).toString(),H.next=12,st.methods.data().call();case 12:return f=H.sent[0],l=c,h=l.liquidityPoolTokenAddress,H.next=17,st.methods.byLiquidityPool(h).call();case 17:p=H.sent,v=new window.web3.eth.Contract(t.dfoCore.getContextElement("ERC20ABI"),p[2][0]),m=new window.web3.eth.Contract(t.dfoCore.getContextElement("ERC20ABI"),p[2][1]);if(p[2][0]!==window.voidEthereumAddress){H.next=24;break}H.t0=18,H.next=27;break;case 24:return H.next=26,v.methods.decimals().call();case 26:H.t0=H.sent;case 27:g=H.t0;if(p[2][1]!==window.voidEthereumAddress){H.next=32;break}H.t1=18,H.next=35;break;case 32:return H.next=34,m.methods.decimals().call();case 34:H.t1=H.sent;case 35:return y=H.t1,b=p[2].indexOf(l.mainTokenAddress),w=st,H.next=40,w.methods.data().call();case 40:return E=H.sent[0],H.next=43,r(v.options.address,m.options.address,g,y);case 43:S=H.sent,x=S.lpAmount,T=S.token0Value,N=S.token1Value,C=u,k=S.token1ValueETH,L=S.firstTokenEthLiquidityPoolAddress,A=S.secondTokenEthLiquidityPoolAddress;if(!(v.options.address===f||!x||S.updatedSecondTokenAmount>S.updatedFirstTokenAmount)){H.next=62;break}return H.next=54,r(m.options.address,v.options.address,y,g);case 54:S=H.sent,x=S.lpAmount,T=S.token1Value,N=S.token0Value,C=S.token1ValueETH,k=u,L=S.secondTokenEthLiquidityPoolAddress,A=S.firstTokenEthLiquidityPoolAddress;case 62:O=[],L!==window.voidEthereumAddress&&O.push({inputTokenAddress:E,inputTokenAmount:C,ammPlugin:w.options.address,liquidityPoolAddresses:[L],swapPath:[v.options.address],enterInETH:!0,exitInETH:!1,receivers:[mr.options.address],receiversPercentages:[]}),A!==window.voidEthereumAddress&&O.push({inputTokenAddress:E,inputTokenAmount:k,ammPlugin:w.options.address,liquidityPoolAddresses:[A],swapPath:[m.options.address],enterInETH:!0,exitInETH:!1,receivers:[mr.options.address],receiversPercentages:[]}),M=0,L!==window.voidEthereumAddress&&(M=t.dfoCore.web3.utils.toBN(M).add(t.dfoCore.web3.utils.toBN(C)).toString()),A!==window.voidEthereumAddress&&(M=t.dfoCore.web3.utils.toBN(M).add(t.dfoCore.web3.utils.toBN(k)).toString()),l.involvingETH&&v.options.address===f&&(M=t.dfoCore.web3.utils.toBN(M).add(t.dfoCore.web3.utils.toBN(T)).toString()),l.involvingETH&&m.options.address===f&&(M=t.dfoCore.web3.utils.toBN(M).add(t.dfoCore.web3.utils.toBN(N)).toString()),_={setupIndex:i,amount:b===0?T:N,amountIsLiquidityPool:!1,positionOwner:window.isEthereumAddress(Bn)?Bn:t.dfoCore.address};if(c.free){H.next=78;break}return H.next=74,s.methods.calculateLockedFarmingReward(i,b===0?T:N,!1,0).call();case 74:D=H.sent,Xt(t.dfoCore.toDecimals(t.dfoCore.toFixed(parseInt(D.relativeRewardPerBlock)*(parseInt(a.endBlock)-d)),nn.decimals)),H.next=80;break;case 78:P=parseInt(x)*6400*parseInt(a.rewardPerBlock)/(parseInt(a.totalSupply)+parseInt(x)),isNaN(P)||Jt(t.dfoCore.toDecimals(t.dfoCore.toFixed(P),nn.decimals));case 80:H.t2=nr,H.t3=o,H.t4=mr.methods.openPosition(t.dfoCore.getContextElement("prestoAddress"),O,s.options.address,_),H.t5=T,H.t6=N,H.t7=g,H.t8=y,H.t9=v.options.address,H.t10=m.options.address;if(!l.involvingETH||v.options.address!==f){H.next=93;break}H.t11="ETH",H.next=96;break;case 93:return H.next=95,v.methods.symbol().call();case 95:H.t11=H.sent;case 96:H.t12=H.t11;if(!l.involvingETH||m.options.address!==f){H.next=101;break}H.t13="ETH",H.next=104;break;case 101:return H.next=103,m.methods.symbol().call();case 103:H.t13=H.sent;case 104:H.t14=H.t13,H.t15={ethValue:H.t3,transaction:H.t4,firstTokenAmount:H.t5,secondTokenAmount:H.t6,token0decimals:H.t7,token1decimals:H.t8,token0Address:H.t9,token1Address:H.t10,token0Symbol:H.t12,token1Symbol:H.t14},(0,H.t2)(H.t15),H.next=112;break;case 109:H.prev=109,H.t16=H["catch"](0),console.error(H.t16);case 112:cr(!1);case 113:case"end":return H.stop()}},n,this,[[0,109]])}));return function(n){return e.apply(this,arguments)}}(),Hr=function(){var t=a.rewardPerBlock,n=c.maxStakeable,r=parseInt(t)*Math.pow(10,18-nn.decimals),i=parseInt(n)*Math.pow(10,18-Zt.decimals),s=r*(1/i);return $?window.formatMoney(s*parseInt(c.blockDuration),6):parseInt(d)>=parseInt(a.endBlock)?0:window.formatMoney(s*(parseInt(a.endBlock)-parseInt(d)),6)},Br=function(){return F?jr():Fr()},jr=function(){return},Fr=function(){return R&&fn&&c.free?React.createElement("div",{className:"FarmActions"},React.createElement("input",{type:"range",value:on,onChange:function(t){return un(parseInt(t.target.value))},className:"form-control-range",id:"formControlRange"}),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("p",{className:"BreefRecap"},React.createElement("b",null,"Amount:")," ",on,"% (",window.formatMoney(r.toDecimals(r.toFixed(parseInt(hn.liquidityPoolAmount)*on/100).toString(),Qt.decimals),Qt.decimals)," ",Qt.symbol," - ",hn.tokens.map(function(e,t){return React.createElement("span",{key:e.address}," ",window.formatMoney(r.toDecimals(r.toFixed(parseInt(hn.tokensAmounts[t].full||hn.tokensAmounts[t])*on/100).toString(),e.decimals),e.decimals)," ",e.symbol," ")}),")"),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return un(10)}},"10%"),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return un(25)}},"25%"),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return un(50)}},"50%"),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return un(75)}},"75%"),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return un(90)}},"90%"),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return un(100)}},"MAX")),React.createElement("div",{className:"row"},React.createElement("div",{className:"QuestionRegular"},React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"To Pair"),React.createElement("input",{name:"outputType",type:"radio",value:"to-pair",checked:Xn==="to-pair",onChange:Dr})),React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"To LP Token"),React.createElement("input",{name:"outputType",type:"radio",value:"to-lp",checked:Xn==="to-lp",onChange:Dr})))),React.createElement("div",{className:"Web2ActionsBTNs"},C?React.createElement("a",{className:"Web3ActionBTN",disabled:C},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{onClick:function(){return Lr()},className:"Web3ActionBTN"},"Remove"))):React.createElement("div",{className:"FarmActions"},(parseInt(a.endBlock)>parseInt(d)||fn)&&React.createElement("div",{className:"QuestionRegular"},a.active&&(c.free||!fn)&&parseInt(a.endBlock)>parseInt(d)&&React.createElement(React.Fragment,null,React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"From Pair"),React.createElement("input",{name:"inputType-"+s.options.address+"-"+i,type:"radio",value:"add-pair",checked:Un==="add-pair",onChange:function(t){return _r(t)}})),(!fn||Dn||!c.free)&&React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"From ETH (BETA)"),React.createElement("input",{name:"inputType-"+s.options.address+"-"+i,type:"radio",value:"add-eth",checked:Un==="add-eth",onChange:function(t){return _r(t)}})),React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"From LP Token"),React.createElement("input",{name:"inputType-"+s.options.address+"-"+i,type:"radio",value:"add-lp",checked:Un==="add-lp",onChange:function(t){return _r(t)}})))),Un==="add-pair"?React.createElement(React.Fragment,null,At.map(function(e,t){return React.createElement("div",{key:e.address,className:"InputTokenRegular"},React.createElement(_2.Input,{showMax:!0,address:e.address,value:_t[t].value||window.fromDecimals(_t[t],e.decimals,!0),balance:e.balance,min:0,onChange:function(n){return Nr(n.target.value,t)},showCoin:!0,showBalance:!0,name:e.symbol}))}),parseFloat(Rt)>0&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},React.createElement("b",null,"LP tokens"),":",React.createElement("span",null," ",window.formatMoney(r.toDecimals(Rt,Qt.decimals),Qt.decimals)," ",Qt.symbol))),React.createElement("label",{className:"OptionalThingsFarmers",htmlFor:"openPositionWallet1"},React.createElement("input",{className:"form-check-input",type:"checkbox",checked:Dn,onChange:function(t){t.target.checked||jn(""),Pn(t.target.checked)},id:"openPositionWallet1"}),React.createElement("p",null,"External Owner")),Dn&&React.createElement("div",{className:"DiffWallet"},React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Position owner address",value:Bn,onChange:function(t){return jn(t.target.value)},id:"uniqueOwner"}),React.createElement("p",{className:"BreefExpl"},'Open this farming position as another wallet - The wallet you insert here will be the owner of the entire position and Farm Tokens (if "Locked Position")')),!c.free&&nn&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},"Total Rewards until end block: ",React.createElement("br",null),React.createElement("b",null,window.formatMoney(Wt,nn.decimals)," ",nn.symbol)),React.createElement("p",{className:"BreefExpl"},"Once you lock this liquidity you'll be able to withdraw it at the Setup End Block. If you want to Unlock this position earlier, you'll need to pay a Penalty Fee (in Reward Tokens) + all of the Reward Tokens you Claimed from this position + All of the Farm Token you're minting (representing your LP tokens locked).")),c.free&&nn&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},"Estimated reward per day: ",React.createElement("br",null),React.createElement("b",null,window.formatMoney($t,nn.decimals)," ",nn.symbol))),React.createElement("div",{className:"Web3BTNs"},Ht.some(function(e){return!e})&&React.createElement(React.Fragment,null,Mr()),x?React.createElement("a",{className:"Web3ActionBTN",disabled:x},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{className:"Web3ActionBTN",onClick:function(){return kr()},disabled:Ht.some(function(e){return!e})||_t.some(function(e){return e===0})},"Add Liquidity"))):Un==="add-lp"?React.createElement(React.Fragment,null,React.createElement("div",{className:"InputTokenRegular"},React.createElement(_2.Input,{showMax:!0,address:Qt.contract.options.address,value:Rt.value||window.fromDecimals(Rt,Qt.decimals,!0),balance:window.fromDecimals(Qt.balance,Qt.decimals,!0),min:0,onChange:function(t){return Cr(t.target.value)},showCoin:!0,showBalance:!0,name:Qt.symbol})),parseFloat(Rt.value||Rt)>0&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},React.createElement("b",null,"Pair"),":",At.map(function(e,t){return React.createElement("span",{key:e.address}," ",_t[t].value||window.formatMoney(r.toDecimals(_t[t],e.decimals),e.decimals)," ",e.symbol)}))),React.createElement("label",{className:"OptionalThingsFarmers",htmlFor:"openPosition2"},React.createElement("input",{className:"form-check-input",type:"checkbox",checked:Dn,onChange:function(t){t.target.checked||jn(""),Pn(t.target.checked)},id:"openPosition2"}),React.createElement("p",null,"External Owner")),Dn&&React.createElement("div",{className:"DiffWallet"},React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Position owner address",value:Bn,onChange:function(t){return jn(t.target.value)},id:"uniqueOwner"}),React.createElement("p",{className:"BreefExpl"},'Open this farming position as another wallet - The wallet you insert here will be the owner of the entire position and Farm Tokens (if "Locked Position")')),!c.free&&nn&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},"Total Rewards until end block: ",React.createElement("br",null),React.createElement("b",null,window.formatMoney(Wt,nn.decimals)," ",nn.symbol)),React.createElement("p",{className:"BreefExpl"},"Once you lock this liquidity you'll be able to withdraw it at the Setup End Block. If you want to Unlock this position earlier, you'll need to pay a Penalty Fee (in Reward Tokens) + all of the Reward Tokens you Claimed from this position + All of the Farm Token you're minting (representing your LP tokens locked).")),c.free&&nn&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},React.createElement("b",null,"Estimated reward per day"),": ",window.formatMoney($t,nn.decimals)," ",nn.symbol)),React.createElement("div",{className:"Web3BTNs"},!Qt.approval&&React.createElement(React.Fragment,null,Mr(!0)),x?React.createElement("a",{className:"Web3ActionBTN",disabled:x},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{className:"Web3ActionBTN",onClick:function(){return kr()},disabled:!Qt.approval||parseFloat(Rt)===0},"Add Liquidity"))):Un==="add-eth"?React.createElement(React.Fragment,null,React.createElement("div",{className:"InputTokenRegular"},React.createElement(_2.Input,{showMax:!0,address:r.voidEthereumAddress,value:Jn,balance:r.toDecimals(Gn,18),min:0,onChange:function(t){return Pr(t.target.value)},showCoin:!0,showBalance:!0,name:"ETH"})),React.createElement("div",{className:"DiffWallet"},!1,lr&&React.createElement(_Loading.default,null),tr&&React.createElement("p",{className:"BreefRecap"},"Position Weight: ",React.createElement("br",null),React.createElement("b",null,window.fromDecimals(tr.firstTokenAmount,tr.token0decimals)," ",tr.token0Symbol)," and ",React.createElement("b",null,window.fromDecimals(tr.secondTokenAmount,tr.token1decimals)," ",tr.token1Symbol))),React.createElement("label",{className:"OptionalThingsFarmers",htmlFor:"openPosition2"},React.createElement("input",{className:"form-check-input",type:"checkbox",checked:Dn,onChange:function(t){t.target.checked||jn(""),Pn(t.target.checked)},id:"openPosition2"}),React.createElement("p",null,"External Owner")),Dn&&React.createElement("div",{className:"DiffWallet"},React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Position owner address",value:Bn,onChange:function(t){return jn(t.target.value)},id:"uniqueOwner"}),React.createElement("p",{className:"BreefExpl"},'Open this farming position as another wallet - The wallet you insert here will be the owner of the entire position and Farm Tokens (if "Locked Position")')),!c.free&&nn&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},"Total Rewards until end block: ",React.createElement("br",null),React.createElement("b",null,window.formatMoney(Wt,nn.decimals)," ",nn.symbol)),React.createElement("p",{className:"BreefExpl"},"Once you lock this liquidity you'll be able to withdraw it at the Setup End Block. If you want to Unlock this position earlier, you'll need to pay a Penalty Fee (in Reward Tokens) + all of the Reward Tokens you Claimed from this position + All of the Farm Token you're minting (representing your LP tokens locked).")),c.free&&nn&&React.createElement("div",{className:"DiffWallet"},React.createElement("p",{className:"BreefRecap"},"Estimated reward per day: ",React.createElement("br",null),React.createElement("b",null,window.formatMoney($t,nn.decimals)," ",nn.symbol))),React.createElement("div",{className:"Web3BTNs"},x?React.createElement("a",{className:"Web3ActionBTN",disabled:x},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{className:"Web3ActionBTN",onClick:function(){return kr()},disabled:parseFloat(Jn)===0},"Add Liquidity")),Z&&Un==="add-eth"&&React.createElement("div",{className:"BetaAllert"},React.createElement("p",{className:"BreefRecap"},React.createElement("b",null,'The Presto "From ETH" feature is in beta. You might received a failed transaction. Use it at your own risk!')))):React.createElement(React.Fragment,null))};return g||!a?React.createElement("div",{className:n},React.createElement("div",{className:"row px-2 farming-component-main-row"},React.createElement("div",{className:"col-12 flex justify-content-center align-items-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"}))))):React.createElement("div",{className:n},React.createElement("div",{className:"FarmSetupMain"},!pr&&React.createElement("h5",null,React.createElement("b",null,c.free?"Free Farming":"Locked Farming"," ",!a.active&&$?React.createElement("span",{className:"text-secondary"},Q?"(new)":"(soon)"):a.active?React.createElement(React.Fragment,null):React.createElement("span",{className:"text-danger"},"(inactive)")," ",parseInt(a.endBlock)<=d&&parseInt(a.endBlock)!==0&&React.createElement("span",null,"(ended)"))," ",React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"token/"+c.liquidityPoolTokenAddress},nt.name)),pr&&React.createElement("h5",null,React.createElement("b",null,"Can be activated after block ",React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"block/"+pr,target:"_blank"},"#",pr))),React.createElement("aside",null,parseInt(a.endBlock)>0?React.createElement("p",null,React.createElement("b",null,"block end"),": ",React.createElement("a",{className:"BLKEMD",target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"block/"+a.endBlock},a.endBlock)):React.createElement("p",null,React.createElement("b",null,"Duration"),": ",Er(c.blockDuration)),!c.free&&React.createElement(React.Fragment,null,React.createElement("p",null,React.createElement("b",null,"Limit"),": ",t.dfoCore.toDecimals(c.maxStakeable,Zt.decimals)," ",Zt.symbol),React.createElement("p",null,React.createElement("b",null,"Penalty fee"),": ",parseInt(c.penaltyFee)===0?"0":t.dfoCore.formatMoney(t.dfoCore.toDecimals(t.dfoCore.toFixed(c.penaltyFee),18)*100,18),"%")),c.minStakeable>0&&React.createElement("p",null,React.createElement("b",null,"Min to Farm"),": ",window.formatMoney(window.fromDecimals(c.minStakeable,Zt.decimals,!0),6)," ",Zt.symbol)),React.createElement("div",{className:"SetupFarmingInstructions"},React.createElement("p",null,At.map(function(e,n){return React.createElement("figure",{key:e.address},n!==0?"+ ":"",e.address!==t.dfoCore.voidEthereumAddress?React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"token/"+e.address},React.createElement(_Coin.default,{address:e.address})):React.createElement(_Coin.default,{address:e.address})," ")})," = ",React.createElement("b",null,"APY"),": ",In<0?"(Insufficient Liquidity)":In===0?"(Missing Price Feed)":window.formatMoney(In,3)+"%")),React.createElement("div",{className:"SetupFarmingOthers"},c.free?React.createElement(React.Fragment,null,React.createElement("p",null,React.createElement("b",null,"Daily Rate"),": ",t.dfoCore.toDecimals(parseInt(a.rewardPerBlock)*6400,nn.decimals,6)," ",nn.symbol," ",React.createElement("span",null,"(Shared)")),React.createElement("p",null,React.createElement("b",null,"Total Deposited"),": ",t.dfoCore.toDecimals(parseInt(a.totalSupply),Qt.decimals,6)," LP (",At.map(function(e,n){return React.createElement("span",{key:e.address},t.dfoCore.toDecimals(e.liquidity,e.decimals,6)," ",e.symbol,n!==At.length-1?" - ":"")}),")")):React.createElement(React.Fragment,null,React.createElement("p",null,React.createElement("b",null,"Available to Farm"),": ",window.fromDecimals(parseInt(c.maxStakeable)-parseInt(a.totalSupply),Zt.decimals)," ",Zt.symbol),React.createElement("p",null,React.createElement("b",null,"Rate"),": ",Hr()," ",nn.symbol," (fixed) (for every ",Zt.symbol," locked until the end block)")))),React.createElement("div",{className:"YourFarmingPositions"},c.free?React.createElement(React.Fragment,null,React.createElement("div",{className:"FarmYou"},fn&&React.createElement(React.Fragment,null,React.createElement("p",null,React.createElement("b",null,"Your Deposit"),": ",window.formatMoney(window.fromDecimals(hn.liquidityPoolAmount,Qt.decimals,!0),6)," ",Qt.symbol," - ",hn.tokens.map(function(e,t){return React.createElement("span",{key:e.address}," ",window.formatMoney(window.fromDecimals(hn.tokensAmounts[t],e.decimals,!0),6)," ",e.symbol," ")}))),$&&React.createElement(React.Fragment,null,Q&&React.createElement(React.Fragment,null,w?React.createElement("a",{className:"Web3ActionBTN",disabled:w},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{className:"Web3ActionBTN",onClick:function(){Sr()}},"Activate")),!Q&&React.createElement(React.Fragment,null,React.createElement("p",{className:"BreefRecap"},"Not ready to be activated, come back at another time"))),o&&ct&&!F&&parseInt(c.lastSetupIndex)===parseInt(i)&&o&&React.createElement("a",{className:"web2ActionBTN",onClick:function(){B(!1),U(!1),I(!0)}},"Edit"),F&&React.createElement("a",{className:"backActionBTN",onClick:function(){B(!1),U(!1),I(!1)}},"Close"),!H&&parseInt(a.endBlock)>parseInt(d)&&React.createElement("a",{className:"web2ActionBTN",onClick:function(){B(!0),U(!1),I(!1)}},"Farm"),H&&React.createElement("a",{className:"backActionBTN",onClick:function(){B(!1),U(!1),I(!1)}},"Close"),!R&&fn&&React.createElement("a",{className:"web2ActionBTN",onClick:function(){B(!1),U(!0),I(!1)}},"Remove"),R&&React.createElement("a",{className:"backActionBTN",onClick:function(){B(!1),U(!1),I(!1)}},"Close")),fn&&React.createElement("div",{className:"Farmed"},React.createElement("p",null,React.createElement("b",null,"Daily Earnings"),": ",window.formatMoney(r.toDecimals((parseInt(a.rewardPerBlock)*6400*parseInt(hn.liquidityPoolAmount)/parseInt(a.totalSupply)).toString().split(".")[0],nn.decimals),9)," ",nn.symbol),React.createElement("p",null,React.createElement("b",null,"Available"),": ",window.fromDecimals(vn,nn.decimals,!0)," ",nn.symbol),W?React.createElement("a",{onClick:function(){return X(!1)},className:"backActionBTN"},"Close"):React.createElement("a",{onClick:function(){return X(!0)},className:"web2ActionBTN"},"Transfer"),A?React.createElement("a",{className:"Web3ActionBTN",disabled:A},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{onClick:function(){return Ar()},className:"Web3ActionBTN"},"Claim"),W&&React.createElement("div",{className:"Tranferpos"},React.createElement("input",{type:"text",className:"TextRegular",placeholder:"Position receiver",value:at,onChange:function(t){return ft(t.target.value)},id:"transferAddress"}),_?React.createElement("a",{className:"Web3ActionBTN",disabled:_},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{onClick:function(){return Or(fn.positionId)},className:"Web3ActionBTN"},"Transfer")))):React.createElement(React.Fragment,null,parseInt(xt)>0&&React.createElement("div",{className:"LockedFarmTokensPosition"},React.createElement("p",null,React.createElement("b",null,"Your Farm ITEM (fLP) Balance"),":"),React.createElement("p",null,window.formatMoney(window.fromDecimals(xt,dt,!0),9)," (",At.map(function(e,t){return(parseInt(xt)===0?0:window.formatMoney(window.fromDecimals(Ct[t],e.decimals,!0),3))+" "+e.symbol+(t!==At.length-1?" - ":"")}),")",React.createElement("a",{className:"MetamaskAddButton",onClick:function(){return t.dfoCore.addTokenToMetamask(gt,"fLP",dt)}},React.createElement("img",{height:14,src:_metamaskFox.default,alt:"Metamask",className:"mb-1"})," Add ","fLP"))),parseInt(d)>=parseInt(a.endBlock)&&parseInt(xt)>0&&React.createElement(React.Fragment,null,React.createElement("div",{className:"QuestionRegular"},React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"To Pair"),React.createElement("input",{name:"outputType-"+s.options.address+"-"+i,type:"radio",value:"to-pair",checked:Xn==="to-pair",onChange:Dr})),React.createElement("label",{className:"PrestoSelector"},React.createElement("span",null,"To LP Token"),React.createElement("input",{name:"outputType-"+s.options.address+"-"+i,type:"radio",value:"to-lp",checked:Xn==="to-lp",onChange:Dr}))),C?React.createElement("a",{className:"Web3ActionBTN Web3ActionBTNV",disabled:C},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):parseInt(d)>=parseInt(a.endBlock)?React.createElement("a",{className:"Web3ActionBTN Web3ActionBTNV",onClick:function(){return Lr()}},"Withdraw Liquidity"):React.createElement(React.Fragment,null)),yn.length>0&&React.createElement(React.Fragment,null,yn.map(function(e,n){return React.createElement(_LockedPositionComponent.default,{key:n,farmTokenBalance:xt,farmTokenSymbol:wt,farmTokenDecimals:dt,onComplete:function(n){t.addTransaction(n),gr()},lmContract:s,position:e,blockNumber:d,setup:a,setupInfo:c,dfoCore:r,rewardTokenInfo:nn,setupTokens:At,lpTokenInfo:Qt,lockedPositionStatus:En[n],lockedPositionReward:Tn[n],mainTokenInfo:Zt,onRewardTokenApproval:function(){return rn(_extends({},nn,{approval:!0}))}})})),($||o&&ct&&parseInt(c.lastSetupIndex)===parseInt(i)||parseInt(a.endBlock)>parseInt(d))&&React.createElement("div",{className:"FarmYou"},$&&React.createElement(React.Fragment,null,Q&&React.createElement(React.Fragment,null,w?React.createElement("a",{className:"Web3ActionBTN",disabled:w},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{className:"Web3ActionBTN",onClick:function(){Sr()}},"Activate")),!Q&&React.createElement(React.Fragment,null,React.createElement("p",{className:"BreefRecap"},"Not ready to be activated, come back at another time"))),o&&ct&&!F&&parseInt(c.lastSetupIndex)===parseInt(i)&&React.createElement("a",{className:"web2ActionBTN",onClick:function(){B(!1),U(!1),I(!0)}},"Edit"),F&&React.createElement("a",{className:"backActionBTN",onClick:function(){B(!1),U(!1),I(!1)}},"Close"),!H&&parseInt(a.endBlock)>parseInt(d)&&React.createElement("a",{className:"web2ActionBTN",onClick:function(){B(!0),U(!1),I(!1)}},"Farm"),H&&React.createElement("a",{className:"backActionBTN",onClick:function(){B(!1),U(!1),I(!1)}},"Close")))),(H||R)&&!F?React.createElement(React.Fragment,null,React.createElement("hr",null),Br()):React.createElement("div",null),F&&!H&&!R?jr():React.createElement("div",null))},mapStateToProps=function(t){return{}},mapDispatchToProps=function(t){return{addTransaction:function(n){return t((0,_actions.addTransaction)(n))}}},_default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(SetupComponent);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_CreateOrEditFixedInflationEntry=_interopRequireDefault(require("./CreateOrEditFixedInflationEntry")),_Loading=_interopRequireDefault(require("../../../../components/shared/Loading")),_ContractEditor=_interopRequireDefault(require("../../../../components/editor/ContractEditor")),CreateOrEditFixedInflation=function(t){function F(e){b(""),S(""),m(e.currentTarget.value)}function I(e){l(e),u(0)}function q(e){var t={id:window.web3.utils.sha3("0"),name:e.name,lastBlock:e.lastBlock,blockInterval:e.blockInterval,callerRewardPercentage:window.toDecimals(window.numberToString((e.callerRewardPercentage||0)/100),18),operations:e.operations.map(function(e){var t=e.receivers.map(function(e){return e.address}),n=e.receivers.map(function(e){return window.toDecimals(window.numberToString(e.percentage/100),18)});return n.pop(),{inputTokenAddress:e.enterInETH&&e.amm?e.amm.ethAddress:e.inputToken.address,inputTokenAmount:window.toDecimals(window.numberToString(e.transferType==="percentage"?parseFloat(e.percentage)/100:e.amount),e.transferType==="percentage"?"18":e.inputToken.decimals),inputTokenAmountIsPercentage:e.transferType==="percentage",inputTokenAmountIsByMint:e.inputTokenMethod==="mint",ammPlugin:e.amm?e.amm.ammContract.options.address:window.voidEthereumAddress,liquidityPoolAddresses:e.pathTokens?e.pathTokens.map(function(e){return e.address}):[],swapPath:e.pathTokens?e.pathTokens.map(function(e){return e.outputTokenAddress}):[],receivers:t,receiversPercentages:n,enterInETH:e.enterInETH&&e.amm!==undefined&&e.amm!==null||!1,exitInETH:e.exitInETH||!1}})};return console.log(JSON.stringify(t)),t}function U(e,t){console.log(e,t)}function W(){var e=o===0?NaN:o-1;j(isNaN(e)),u(e)}function X(e){var t={},n=Object.keys(e);for(var r=0;r<n.length;r++){var i=n[r];t[i]=e[i]}t.operations=[];for(var s=e.operations,o=Array.isArray(s),u=0,s=o?s:s[Symbol.iterator]();;){var a;if(o){if(u>=s.length)break;a=s[u++]}else{u=s.next();if(u.done)break;a=u.value}var f=a,l={};Object.entries(f).forEach(function(e){return l[e[0]]=e[1]}),t.operations.push(l)}return t}function V(e,t,r,i,s){var o={name:e,lastBlock:t,blockInterval:r,callerRewardPercentage:i,operations:s};l(o),n(o)}function $(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("h6",null,"Deploy"))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},z[o][0]())),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("button",{disabled:h,onClick:W,className:"btn btn-light"},"Back"),o!==z.length-1&&React.createElement("button",{disabled:z[o][1](),onClick:function(){return u(o+1)},className:"btn btn-primary"},"Next"),o===z.length-1&&(h?React.createElement(_Loading.default,null):React.createElement("button",{disabled:z[o][1](),onClick:n,className:"btn btn-primary"},"Deploy")),O&&React.createElement("span",null,O))))}function J(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("h6",null,"Success!"))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"/address/"+D},D))))}var n=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:s=[{name:"Generate SmartContract Proposal",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,window.SolidityUtilities.getCompilers();case 2:t.selectedSolidityVersion=d.sent.releases["0.7.6"],t.bypassFunctionalitySourceId=!0,t.contractName="ProposalCode",t.functionalityMethodSignature="callOneTime(address)",e="FixedInflationSetEntry",r=[q(t.entry)],i='FixedInflationEntry("'+r[0].name+'", '+r[0].blockInterval+", "+(r[0].lastBlock||0)+", "+r[0].callerRewardPercentage+")",s="",o="";for(u in r){a=r[u],f="operationSets_"+u,l="";for(c in a.operations)h=a.operations[c],l+="\n        operationSets["+c+"] = _"+f+"_"+c+"();";s+="        "+l+"\n"}for(u in r)for(c in r[u].operations){h=r[u].operations[c],l="    function _operationSets_"+u+"_"+c+"() private view returns(FixedInflationOperation memory) {",l+="\n        address[] memory liquidityPoolAddresses_"+u+"_"+c+" = new address[]("+h.liquidityPoolAddresses.length+");";for(p in h.liquidityPoolAddresses)l+="\n        liquidityPoolAddresses_"+u+"_"+c+"["+p+"] = "+web3.utils.toChecksumAddress(h.liquidityPoolAddresses[p])+";";l+="\n        address[] memory swapPath_"+u+"_"+c+" = new address[]("+h.swapPath.length+");";for(p in h.swapPath)l+="\n        swapPath_"+u+"_"+c+"["+p+"] = "+web3.utils.toChecksumAddress(h.swapPath[p])+";";l+="\n        address[] memory receivers_"+u+"_"+c+" = new address[]("+h.receivers.length+");";for(p in h.receivers)l+="\n        receivers_"+u+"_"+c+"["+p+"] = "+web3.utils.toChecksumAddress(h.receivers[p])+";";l+="\n        uint256[] memory receiversPercentages_"+u+"_"+c+" = new uint256[]("+h.receiversPercentages.length+");";for(p in h.receiversPercentages)l+="\n        receiversPercentages_"+u+"_"+c+"["+p+"] = "+h.receiversPercentages[p]+";";l+="\n        return FixedInflationOperation("+web3.utils.toChecksumAddress(h.inputTokenAddress)+", "+h.inputTokenAmount+", "+h.inputTokenAmountIsPercentage+", "+h.inputTokenAmountIsByMint+", "+h.ammPlugin+", liquidityPoolAddresses_"+u+"_"+c+", swapPath_"+u+"_"+c+", "+h.enterInETH+", "+h.exitInETH+", receivers_"+u+"_"+c+", receiversPercentages_"+u+"_"+c+");",o+=l+"\n    }\n\n"}return d.next=15,fetch("data/"+e+".sol");case 15:return d.next=17,d.sent.text();case 17:d.t0=k,d.t1=i.trim(),d.t2=r[0].operations.length,d.t3=s.trim(),d.t4=o.trim(),t.sourceCode=d.sent.format(d.t0,d.t1,d.t2,d.t3,d.t4),console.log(t.sourceCode);case 24:case"end":return d.stop()}},n,this)}))()}}],s=t.fixedInflationContractAddress?s:[{name:"Clone Extension",description:"Fixed Inflation Extension will comunicate with the DFO for Token and ETH transmission to the Fixed Inflation Contract",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,window.blockchainCall(i.methods.cloneModel);case 2:return e=s.sent,s.next=5,window.web3.eth.getTransactionReceipt(e.transactionHash);case 5:r=s.sent,t.extensionAddress=window.web3.eth.abi.decodeParameter("address",r.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("ExtensionCloned(address,address)")})[0].topics[1]);case 7:case"end":return s.stop()}},n,this)}))()},onTransaction:function(t,n){t.extensionAddress=window.web3.eth.abi.decodeParameter("address",n.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("ExtensionCloned(address,address)")})[0].topics[1])}},{name:"Deploy Fixed Inflation Contract",description:"New Fixed Inflation Contract will be deployed.",call:function(n){return _asyncToGenerator(regeneratorRuntime.mark(function i(){var e,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return n.elaboratedEntry=q(n.entry),e=window.newContract(t.dfoCore.getContextElement("FixedInflationABI")).methods.init(n.extensionAddress,window.web3.utils.sha3("init(address)").substring(0,10)+window.web3.eth.abi.encodeParameter("address",n.element.doubleProxyAddress).substring(2),n.elaboratedEntry,n.elaboratedEntry.operations).encodeABI(),u.next=4,window.blockchainCall(r.methods.deploy,e);case 4:return s=u.sent,u.next=7,window.web3.eth.getTransactionReceipt(s.transactionHash);case 7:o=u.sent,n.fixedInflationAddress=window.web3.eth.abi.decodeParameter("address",o.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("FixedInflationDeployed(address,address,bytes)")})[0].topics[1]);case 9:case"end":return u.stop()}},i,this)}))()},onTransaction:function(t,n){return _asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.fixedInflationAddress=window.web3.eth.abi.decodeParameter("address",n.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("FixedInflationDeployed(address,address,bytes)")})[0].topics[1]);case 1:case"end":return r.stop()}},r,this)}))()}},{name:"Generate SmartContract Proposal",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,window.SolidityUtilities.getCompilers();case 2:return t.selectedSolidityVersion=r.sent.releases["0.7.6"],t.bypassFunctionalitySourceId=!0,t.contractName="ProposalCode",e="NewFixedInflationExtension",t.functionalityMethodSignature="callOneTime(address)",r.t0=JSON,r.next=10,window.blockchainCall(t.element.functionalitiesManager.methods.functionalityNames);case 10:r.t1=r.sent,r.t2=function(e){return e==="manageFixedInflation"},r.t3=r.t0.parse.call(r.t0,r.t1).filter(r.t2).length;if(r.t3!==0){r.next=19;break}e="ManageFixedInflationFunctionality",t.functionalityMethodSignature="manageFixedInflation(address,uint256,address[],uint256[],uint256[],address)",t.functionalityName="manageFixedInflation",t.functionalitySubmitable=!0,t.functionalityNeedsSender=!0;case 19:return r.next=21,fetch("data/"+e+".sol");case 21:return r.next=23,r.sent.text();case 23:r.t4=window.web3.utils.toChecksumAddress(t.extensionAddress),t.sourceCode=r.sent.format(r.t4),console.log(t.sourceCode);case 26:case"end":return r.stop()}},n,this)}))()}}],o={element:t.element,sequentialOps:s,entry:e,sourceCode:"test",title:(t.fixedInflationContractAddress?"Edit":"New")+" Fixed Inflation"},window.showProposalLoader(o);case 4:case"end":return u.stop()}},n,this)}));return function(n){return e.apply(this,arguments)}}(),r=window.newContract(t.dfoCore.getContextElement("FixedInflationFactoryABI"),t.dfoCore.getContextElement("fixedInflationFactoryAddress")),i=window.newContract(t.dfoCore.getContextElement("DFOBasedFixedInflationExtensionFactoryABI"),t.dfoCore.getContextElement("dFOBasedFixedInflationExtensionFactory")),s=(0,_react.useState)(NaN),o=s[0],u=s[1],a=(0,_react.useState)(null),f=a[0],l=a[1],c=(0,_react.useState)(!1),h=c[0],p=c[1],d=(0,_react.useState)("wallet"),v=d[0],m=d[1],g=(0,_react.useState)(""),y=g[0],b=g[1],w=(0,_react.useState)(""),E=w[0],S=w[1],x=(0,_react.useState)(""),T=x[0],N=x[1],C=(0,_react.useState)(""),k=C[0],L=C[1],A=(0,_react.useState)(""),O=A[0],M=A[1],_=(0,_react.useState)(""),D=_[0],P=_[1],H=(0,_react.useState)(!1),B=H[0],j=H[1];(0,_react.useEffect)(function(){function n(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,n,i,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,A,O,M,_,D,P;return regeneratorRuntime.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!!n||!!t.fixedInflationContractAddress){H.next=2;break}return H.abrupt("return",l({name:"",operations:[]}));case 2:return H.next=4,t.dfoCore.getContract(t.dfoCore.getContextElement("FixedInflationABI"),t.fixedInflationContractAddress);case 4:return e=H.sent,H.t0=L,H.next=8,e.methods.extension().call();case 8:return H.t1=H.sent,(0,H.t0)(H.t1),H.next=12,e.methods.entry().call();case 12:n=H.sent,i={},Object.entries(n[0]).forEach(function(e){return i[e[0]]=e[1]}),i.callerRewardPercentage=window.numberToString(parseFloat(window.fromDecimals(i.callerRewardPercentage,18,!0))*100),i.operations=[],s=n[1],o=Array.isArray(s),u=0,s=o?s:s[Symbol.iterator]();case 18:if(!o){H.next=24;break}if(!(u>=s.length)){H.next=21;break}return H.abrupt("break",114);case 21:a=s[u++],H.next=28;break;case 24:u=s.next();if(!u.done){H.next=27;break}return H.abrupt("break",114);case 27:a=u.value;case 28:return f=a,c={},Object.entries(f).forEach(function(e){return c[e[0]]=e[1]}),h="18",p="ETH",H.prev=33,d=window.newContract(window.context.votingTokenAbi,c.inputTokenAddress),H.next=37,window.blockchainCall(d.methods.decimals);case 37:return h=H.sent,H.next=40,window.blockchainCall(d.methods.symbol);case 40:p=H.sent,H.next=45;break;case 43:H.prev=43,H.t2=H["catch"](33);case 45:c.inputToken={address:c.inputTokenAddress,symbol:p,decimals:h},c.actionType=c.ammPlugin===window.voidEthereumAddress?"transfer":"swap",c.inputTokenMethod=c.inputTokenAmountIsByMint?"mint":"reserve",c.transferType=c.inputTokenAmountIsPercentage?"percentage":"amount",!c.inputTokenAmountIsPercentage&&(c.amount=window.fromDecimals(c.inputTokenAmount,h,!0)),c.inputTokenAmountIsPercentage&&(c.percentage=window.numberToString(parseFloat(window.fromDecimals(c.inputTokenAmount,18,!0))*100));if(!c.ammPlugin||c.ammPlugin===window.voidEthereumAddress){H.next=107;break}return H.next=54,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMAggregatorABI"),t.dfoCore.getContextElement("ammAggregatorAddress"));case 54:return v=H.sent,H.next=57,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMABI"),c.ammPlugin);case 57:return m=H.sent,H.next=60,m.methods.data().call();case 60:g=H.sent,y=g[0],c.amm={ammAggregator:v,ammContract:m,ammData:g,ethAddress:y},c.pathTokens=[],H.t3=regeneratorRuntime.keys(c.liquidityPoolAddresses);case 65:if((H.t4=H.t3()).done){H.next=107;break}b=H.t4.value,w=c.liquidityPoolAddresses[b],H.t5=c.amm.info;if(H.t5){H.next=73;break}return H.next=72,v.methods.info(w).call();case 72:H.t5=H.sent;case 73:return c.amm.info=H.t5,H.next=76,m.methods.byLiquidityPool(w).call();case 76:E=H.sent,S=E[2],x=[],T=c.swapPath[b],N=0;case 81:if(!(N<S.length)){H.next=95;break}C=S[N];if(C===window.voidEthereumAddress){H.next=91;break}return H.next=86,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),C);case 86:return k=H.sent,H.next=89,k.methods.symbol().call();case 89:A=H.sent,x.push(A);case 91:y===C&&(x[x.length-1]="ETH ("+x[x.length-1]+")");case 92:N++,H.next=81;break;case 95:return H.next=97,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),w);case 97:return O=H.sent,H.next=100,O.methods.symbol().call();case 100:return M=H.sent,H.next=103,O.methods.decimals().call();case 103:_=H.sent,c.pathTokens.push({symbol:M,address:w,decimals:_,output:null,outputTokenAddress:T,lpTokensAddresses:S,symbols:x}),H.next=65;break;case 107:c.oldReceivers=c.receivers,c.receivers=[],D=100;for(b in c.oldReceivers)w=c.oldReceivers[b=parseInt(b)],P=0,b!==c.oldReceivers.length-1&&(P=window.numberToString(parseFloat(window.fromDecimals(c.receiversPercentages[b],18,!0))*100)),D-=P,c.receivers.push({address:w,percentage:b!==c.oldReceivers.length-1?P:D});i.operations.push(c);case 112:H.next=18;break;case 114:l(i);case 115:case"end":return H.stop()}},r,this,[[33,43]])}));return n}(),[]);var R={wallet:function(){return _asyncToGenerator(regeneratorRuntime.mark(function n(){var e,i,s,o,u,a,f;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return M("1/3 - Deploying Extension..."),e={from:t.dfoCore.address},i=r.methods.cloneFixedInflationDefaultExtension(),l.next=5,i.estimateGas(e);case 5:return s=l.sent,e.gasLimit=s,l.next=9,i.send(e);case 9:return o=l.sent,l.next=12,window.web3.eth.getTransactionReceipt(o.transactionHash);case 12:return u=l.sent,a=window.web3.eth.abi.decodeParameter("address",u.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("ExtensionCloned(address)")})[0].topics[1]),m("deployedContract"),L(a),f=window.web3.utils.sha3("init(address)").substring(0,10),f+=window.web3.eth.abi.encodeParameter("address",y).substring(2),N(f),l.next=21,R.deployedContract(a,f);case 21:case"end":return l.stop()}},n,this)}))()},deployedContract:function(n,i){return _asyncToGenerator(regeneratorRuntime.mark(function s(){var e,o,u,a,l,c,h,p,d;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return M((n?"2/3":"1/2")+" - Deploying Liqudity Mining Contract..."),e=q(f),o=window.newContract(t.dfoCore.getContextElement("FixedInflationABI")).methods.init(n||k,i||T||"0x",e,e.operations).encodeABI(),u={from:t.dfoCore.address},a=r.methods.deploy(o),v.next=7,a.estimateGas(u);case 7:return l=v.sent,u.gasLimit=l,v.next=11,a.send(u);case 11:return c=v.sent,v.next=14,window.web3.eth.getTransactionReceipt(c.transactionHash);case 14:return h=v.sent,p=window.web3.eth.abi.decodeParameter("address",h.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("FixedInflationDeployed(address,address,bytes)")})[0].topics[1]),M((n?"3/3":"2/2")+" - Enabling Extension..."),v.next=19,t.dfoCore.getContract(t.dfoCore.getContextElement("FixedInflationExtensionABI"),n||k);case 19:return d=v.sent,u={from:t.dfoCore.address},a=d.methods.setActive(!0),v.next=24,a.estimateGas(u);case 24:return l=v.sent,u.gasLimit=l,v.next=28,a.send(u);case 28:c=v.sent,P(p);case 30:case"end":return v.stop()}},s,this)}))()}},z=[[function(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("h6",null,"Host"),React.createElement("p",null),React.createElement("select",{className:"custom-select wusd-pair-select",value:v,onChange:F},React.createElement("option",{value:"wallet"},"Wallet"),React.createElement("option",{value:"deployedContract"},"Deployed Contract"))),(v==="wallet"||v==="deployedContract")&&React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},v==="wallet"&&React.createElement("input",{type:"text",placeholder:"Host address",defaultValue:y,onKeyUp:function(t){return b(window.isEthereumAddress(t.currentTarget.value)?t.currentTarget.value:"")}}),v==="deployedContract"&&React.createElement("input",{type:"text",placeholder:"Insert extension address",defaultValue:k,onKeyUp:function(t){return L(window.isEthereumAddress(t.currentTarget.value)?t.currentTarget.value:"")}}))),v==="fromSourceCode"&&React.createElement(_ContractEditor.default,{dfoCore:t.dfoCore,onFinish:U}),v!=="wallet"&&React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("input",{placeholder:"Optional init payload",type:"text",defaultValue:T,onKeyUp:function(t){return N(t.currentTarget.value)}})))))},function(){return!(v==="wallet"?y&&y!==window.voidEthereumAddress:v==="deployedContract"?k:E)}]];return f?D?J():isNaN(o)?React.createElement(_CreateOrEditFixedInflationEntry.default,{entry:X(f),"continue":I,saveEntry:V,cancelEdit:t.cancelEdit,notFirstTime:B}):$():React.createElement(_Loading.default,null)},mapStateToProps=function(t){return{dfoCore:t.core.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(CreateOrEditFixedInflation);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _reactRedux=require("react-redux"),_react=require("react"),_CreateOrEditFixedInflationEntryOperation=_interopRequireDefault(require("./CreateOrEditFixedInflationEntryOperation")),CreateOrEditFixedInflationEntry=function(t){function A(e){isNaN(e)&&(e=o.length,o.push({add:!0,receivers:[],pathTokens:[]}),u(o)),L(e)}function O(){o[k].add&&k===o.length-1&&(o.pop(),u(o)),L(null)}function M(e){delete e.add,o[k]=e,u(o),L(null)}function _(e){o.splice(e,1),u(o.map(function(e){return e}))}function D(e){var t=0;try{t=parseFloat(e.target.value.split("-").join("").trim())}catch(e){}b(t>99?99:t)}function P(e){S(e.currentTarget.checked),b(0)}function H(e){N(e.currentTarget.checked),p(0)}var n=(0,_react.useState)(0),r=n[0],i=n[1],s=(0,_react.useState)(t.entry.operations||[]),o=s[0],u=s[1],a=(0,_react.useState)(t.entry.name||""),f=a[0],l=a[1],c=(0,_react.useState)(t.entry.lastBlock||0),h=c[0],p=c[1],d=(0,_react.useState)(t.entry.blockInterval||Object.values(t.dfoCore.getContextElement("blockIntervals"))[0]),v=d[0],m=d[1],g=(0,_react.useState)(t.entry.callerRewardPercentage||0),y=g[0],b=g[1],w=(0,_react.useState)((t.entry.callerRewardPercentage||0)>0),E=w[0],S=w[1],x=(0,_react.useState)((t.entry.lastBlock||0)>0),T=x[0],N=x[1],C=(0,_react.useState)(null),k=C[0],L=C[1];(0,_react.useEffect)(function(){t.notFirstTime&&i(B.length-1)},[]);var B=[[function(){return React.createElement(React.Fragment,null,React.createElement("p",{className:"OnlyMobileVersion"},"Use a Desktop or a tablet to build Inflation Contracts"),React.createElement("div",{className:"InputForm NUUUMobileVersion"},React.createElement("input",{className:"TextRegular",placeholder:"Title",onChange:function(t){return l(t.currentTarget.value)},value:f}),React.createElement("h5",null,"Block Interval:"),React.createElement("select",{className:"SelectRegular",onChange:function(t){return m(t.currentTarget.value)},value:v},Object.entries(t.dfoCore.getContextElement("blockIntervals")).map(function(e){return React.createElement("option",{key:e[0],value:e[1]},e[0])})),React.createElement("p",null,"The minimum amount of time that must pass between each execution")))},function(){return f===""||v===0}],[function(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"CheckboxQuestions"},React.createElement("label",null,React.createElement("h5",null,"Start Block"),React.createElement("input",{type:"checkbox",checked:T,onChange:H}),React.createElement("p",null,"If selected, the first operation of the inflation contract will become executable immediately after the chosen block ends. If not, the operation will become executable immediately after the contract’s deployment block ends.")),T&&React.createElement("input",{type:"number",className:"TextRegular",placeholder:"Start Block",label:"Start Block:",min:"0",onChange:function(t){return p(parseInt(t.target.value))},value:h})))},function(){return!(!T||h>0)}],[function(){return React.createElement(React.Fragment,null,React.createElement("h6",null,React.createElement("b",null,"Operations:")),o.length===0&&React.createElement("div",{className:"CreateList"},React.createElement("p",null,"No operations")),k===null&&o.map(function(e,t){return React.createElement("div",{key:t,className:"CreateListOp"},React.createElement("p",null,e.actionType," ",e.amount!==0?e.amount:e.percentage+"% (supply)"," ",e.inputToken.symbol," to ",e.receivers.length," receiver(s)"),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{className:"web2ActionBTN",onClick:function(){return A(t)}},React.createElement("b",null,"EDIT")),React.createElement("a",{className:"web2ActionBTN",onClick:function(){return _(t)}},React.createElement("b",null,"X"))))}),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:A,className:"web2ActionBTN"},"+")))},function(){return o.length===0}],[function(){return React.createElement(React.Fragment,null,React.createElement("div",{className:"CheckboxQuestions"},React.createElement("label",null,React.createElement("h5",null,"Executor Reward"),React.createElement("input",{type:"checkbox",checked:E,onChange:P}),React.createElement("p",null,"Anyone can execute an operation, and a % of either token involved can be earned a reward.")),E&&React.createElement("div",{className:"SpecialInputPerch"},React.createElement("aside",null,"%"),React.createElement("input",{className:"TextRegular",placeholder:"Executor Reward Perchentage (%)",label:"Caller reward %:",min:"0",max:"100",onChange:D,value:y}))))},function(){return!(!E||y>0&&y<100)}]];return k!=null?React.createElement(_CreateOrEditFixedInflationEntryOperation.default,{operation:o[k],cancelEditOperation:O,saveEditOperation:M}):React.createElement(React.Fragment,null,React.createElement("div",{className:"CreateList"},React.createElement("h6",null,React.createElement("b",null," ",f)),B[r][0]()),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:t.cancelEdit,className:"backActionBTN"},"Cancel"),r!==0&&React.createElement("a",{onClick:function(){return i(r-1)},className:"backActionBTN"},"Back"),r!==B.length-1&&React.createElement("a",{disabled:B[r][1](),onClick:function(){return!B[r][1]()&&i(r+1)},className:"web2ActionBTN"+(B[r][1]()?" disabled":"")},"Next"),r===B.length-1&&React.createElement("a",{disabled:B[r][1](),onClick:function(){return!B[r][1]()&&t.saveEntry(f,h,v,y,o)},className:"web2ActionBTN"+(B[r][1]()?" disabled":"")},"Save")))},mapStateToProps=function(t){var n=t.core,r=t.session,i=n.dfoCore,s=r.inflationSetups;return{dfoCore:i,inflationSetups:s}},_default=(0,_reactRedux.connect)(mapStateToProps)(CreateOrEditFixedInflationEntry);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_actions=require("../../../../store/actions"),_shared=require("../../../../components/shared"),_Loading=_interopRequireDefault(require("../../../../components/shared/Loading")),CreateOrEditFixedInflationEntryOperation=function(t){function nt(e){R(e.currentTarget.value==="true"),G(e.currentTarget.value==="true"?window.voidEthereumAddress:null),e.currentTarget.value==="true"&&g("reserve"),e.currentTarget.value==="true"&&at({target:{value:"amount"}})}function rt(e){W(e.currentTarget.value==="true")}function at(e){x(""),C(""),w(e.target.value)}function ft(e){var t=M.length===1,n=M.filter(function(t,n){return n!==e});_(n),t&&Q(null),W(!1),$(!q&&n.length>0&&n[n.length-1].outputTokenAddress===K.ethAddress&&K.ethAddress!==window.voidEthereumAddress)}var n=t.entry,r=t.onCancel,i=t.onFinish,s=t.operation,o=(0,_react.useState)(0),u=o[0],a=o[1],f=(0,_react.useState)(""),l=f[0],c=f[1],h=(0,_react.useState)(null),p=h[0],d=h[1],v=(0,_react.useState)(""),m=v[0],g=v[1],y=(0,_react.useState)(""),b=y[0],w=y[1],E=(0,_react.useState)(0),S=E[0],x=E[1],T=(0,_react.useState)(0),N=T[0],C=T[1],k=(0,_react.useState)(""),L=k[0],A=k[1],O=(0,_react.useState)([]),M=O[0],_=O[1],D=(0,_react.useState)([]),P=D[0],H=D[1],B=(0,_react.useState)(!1),j=B[0],F=B[1],I=(0,_react.useState)(!1),q=I[0],R=I[1],U=(0,_react.useState)(!1),z=U[0],W=U[1],X=(0,_react.useState)(!1),V=X[0],$=X[1],J=(0,_react.useState)(!1),K=J[0],Q=J[1];(0,_react.useEffect)(function(){if(s){var e=s.inputToken?s.inputToken.address?s.inputToken.address:s.inputToken:null;c(s.actionType),G(e),g(s.inputTokenMethod),C(s.amount),x(s.percentage),w(s.transferType),H(s.receivers),_(s.pathTokens),R(s.enterInETH||e===window.voidEthereumAddress),W(s.exitInETH||!1),$(s.exitInETH||!1),Q(s.amm)}},[]);var G=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var r,i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:Q(null),_([]),W(!1),$(!1);if(e){o.next=6;break}return o.abrupt("return",d(null));case 6:return F(!0),o.next=9,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),t.dfoCore.web3.utils.toChecksumAddress(e));case 9:r=o.sent;if(e!==window.voidEthereumAddress){o.next=14;break}o.t0="ETH",o.next=17;break;case 14:return o.next=16,r.methods.symbol().call();case 16:o.t0=o.sent;case 17:i=o.t0;if(e!==window.voidEthereumAddress){o.next=22;break}o.t1="18",o.next=25;break;case 22:return o.next=24,r.methods.decimals().call();case 24:o.t1=o.sent;case 25:s=o.t1,d({symbol:i,address:t.dfoCore.web3.utils.toChecksumAddress(e),decimals:s}),F(!1);case 28:case"end":return o.stop()}},n,this)}));return function(n){return e.apply(this,arguments)}}(),Y=function(){var t=!1;for(var n=P,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var s;if(r){if(i>=n.length)break;s=n[i++]}else{i=n.next();if(i.done)break;s=i.value}var o=s,u=window.formatNumber(o.percentage);if(u<=0||u>100)t=!0}var a=P.map(function(e){return window.formatNumber(e.percentage)}).reduce(function(e,t){return e+t});return a==100&&!t},Z=function(t,n){var r=n=parseInt(n),i=P.map(function(e,i){return i===t?_extends({},e,{percentage:n}):i===P.length-1?_extends({},e,{percentage:100-r}):(r+=e.percentage,e)});H(i)},et=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var r,i,s,o,u,a,f,l,c,h,d,v,m,g,y,b,w,E,S;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(e){x.next=2;break}return x.abrupt("return");case 2:return F(!0),x.prev=3,x.next=6,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMAggregatorABI"),t.dfoCore.getContextElement("ammAggregatorAddress"));case 6:return r=x.sent,x.next=9,r.methods.info(e).call();case 9:return i=x.sent,x.next=12,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMABI"),i.amm);case 12:return s=x.sent,x.next=15,s.methods.data().call();case 15:o=x.sent,u=t.dfoCore.web3.utils.toChecksumAddress(o[0]),a=t.dfoCore.web3.utils.toChecksumAddress(q?u:p.address);if(!K||K.ammContract.options.address===s.options.address){x.next=20;break}return x.abrupt("return");case 20:if(!(M.filter(function(t){return t.address===e}).length>0)){x.next=22;break}return x.abrupt("return");case 22:return f=t.dfoCore.web3.utils.toChecksumAddress(M.length===0?a:M[M.length-1].outputTokenAddress),x.next=25,s.methods.byLiquidityPool(e).call();case 25:l=x.sent,c=l[2],h=[],d=null,v=!1,m=0;case 31:if(!(m<c.length)){x.next=47;break}g=t.dfoCore.web3.utils.toChecksumAddress(c[m]),d=d?d:g!==f?g:null;if(g===window.voidEthereumAddress){x.next=42;break}return x.next=37,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),g);case 37:return y=x.sent,x.next=40,y.methods.symbol().call();case 40:b=x.sent,h.push(b);case 42:u===g&&(h[h.length-1]="ETH ("+h[h.length-1]+")"),f===g&&(v=!0);case 44:m++,x.next=31;break;case 47:if(v){x.next=49;break}return x.abrupt("return");case 49:return!K&&Q({ammAggregator:r,info:i,ammContract:s,ammData:o,ethAddress:u}),x.next=52,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),e);case 52:return w=x.sent,x.next=55,w.methods.symbol().call();case 55:return E=x.sent,x.next=58,w.methods.decimals().call();case 58:S=x.sent,_(M.concat({symbol:E,address:e,decimals:S,output:null,outputTokenAddress:d,lpTokensAddresses:c,symbols:h})),W(d===u),$(!q&&d===u&&u!==window.voidEthereumAddress),x.next=67;break;case 64:x.prev=64,x.t0=x["catch"](3),console.error(x.t0);case 67:return x.prev=67,F(!1),x.finish(67);case 70:case"end":return x.stop()}},n,this,[[3,64,67,70]])}));return function(n){return e.apply(this,arguments)}}(),tt=function(){return{actionType:l,inputToken:p,inputTokenMethod:m,amount:N,percentage:S,transferType:b,receivers:P,pathTokens:M,index:s?s.index:-1,enterInETH:q,exitInETH:z,amm:K}},it=function(){switch(u){case 0:return st();case 1:return ot();case 2:return ct();case 3:return ht();default:return React.createElement("div",null)}},st=function(){var n=!l;return React.createElement("div",{className:"InputForm"},React.createElement("h6",null,React.createElement("b",null,"Add new Operation by:")),React.createElement("select",{className:"SelectRegular",value:l,onChange:function(t){return c(t.target.value)}},React.createElement("option",{value:""},"Operation type"),React.createElement("option",{value:"transfer"},"Transfer"),React.createElement("option",{value:"swap"},"Swap")),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){c(""),t.cancelEditOperation()},className:"backActionBTN"},"Cancel"),React.createElement("a",{onClick:function(){return!n&&a(1)},disabled:n,className:"web2ActionBTN"+(n?" disabled":"")},"Next")))},ot=function(){var t,n=!p||!m;return React.createElement("div",{className:"InputForm"},React.createElement("select",{className:"SelectRegular",value:q&&q.toString()||"false",onChange:nt},React.createElement("option",{value:"false"},"Token or Item"),React.createElement("option",{value:"true"},"Ethereum")),!q&&React.createElement("div",{className:"CreateList CreateListS"},React.createElement(_shared.TokenInput,(t={placeholder:"Token address",tokenAddress:p?p.address:"",label:"Input token"},t.placeholder="Input token address",t.width=60,t.onClick=function(t){return G(t)},t.text="Load",t))),j?React.createElement("div",{className:"row justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"}))):React.createElement(React.Fragment,null,p&&React.createElement("div",{className:"TokenInflLoaded"},React.createElement("h5",null,p.symbol)," ",React.createElement(_shared.Coin,{address:p.address,className:"TokenInflLoaded"})),React.createElement("select",{value:m,onChange:function(t){return g(t.target.value)},className:"SelectRegular"},React.createElement("option",{value:""},"Select method"),!q&&React.createElement("option",{value:"mint"},"By mint"),React.createElement("option",{value:"reserve"},"By reserve")),React.createElement("p",null,"If “by reserve” is selected, the input token will be sent from a wallet. If “by mint” is selected, it will be minted and then sent. The logic of this action must be carefully coded into the extension! To learn more, read the ",React.createElement("a",null,"Documentation (coming Soon)"))),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){return a(u-1)},className:"backActionBTN"},"Back"),React.createElement("a",{onClick:function(){return!n&&a(2)},disabled:n,className:"web2ActionBTN"+(n?" disabled":"")},"Next")))},ut=function(){return React.createElement(React.Fragment,null,React.createElement("h6",null,React.createElement("b",null,"Transfer")),React.createElement("select",{value:b,onChange:function(t){return w(t.target.value)},className:"SelectRegular"},React.createElement("option",{value:""},"Select type"),!q&&React.createElement("option",{value:"percentage"},"Percentage"),React.createElement("option",{value:"amount"},"Amount")),b?b=="percentage"?React.createElement("div",{className:"SpecialInputPerch"},React.createElement("aside",null,"%"),React.createElement("input",{type:"number",min:0,max:100,value:S,onChange:function(t){return x(t.target.value)},className:"TextRegular"}),React.createElement("p",null,"Of ",p.symbol," Existing Supply")):React.createElement("div",{className:"InputTokensRegular"},React.createElement("div",{className:"InputTokenRegular"},React.createElement(_shared.Input,{showCoin:!0,address:p.address,name:p.symbol,value:N,onChange:function(t){return C(t.target.value)}}))):React.createElement("div",null),b?React.createElement(React.Fragment,null,React.createElement("h6",null,React.createElement("b",null,"Receiver")),React.createElement("div",{className:"CheckboxQuestions"},React.createElement("input",{type:"text",value:L,onChange:function(t){return A(t.target.value)},className:"TextRegular",placeholder:"Address","aria-label":"Receiver","aria-describedby":"button-add"})),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){if(!window.isEthereumAddress(L))return;var t=P.filter(function(e){return e.address===L}).length>0;if(t)return;H(P.concat({address:L,percentage:P.length===0?100:0})),A("")},className:"web2ActionBTN",type:"button",id:"button-add"},"+")),React.createElement("div",{className:"ReceiversList"},P.map(function(e,t){return React.createElement("div",{key:e.address,className:"ReceiverSingle"},React.createElement("p",null,e.address),React.createElement("div",{className:"DeleteAddress"},React.createElement("a",{onClick:function(){return H(P.filter(function(e,n){return n!==t}))},className:"web2ActionBTN"},"X")),t!==P.length-1&&React.createElement("div",{className:"SpecialInputPerch"},React.createElement("aside",null,"%"),React.createElement("input",{type:"number",min:0,max:100,onChange:function(n){return Z(t,n.target.value)},className:"TextRegular",value:e.percentage})),t===P.length-1&&P.length!==1&&React.createElement("span",null,e.percentage))}))):React.createElement("div",null))},lt=function(){return React.createElement(React.Fragment,null,React.createElement("h6",null,React.createElement("b",null,"Swap")),React.createElement("select",{value:b,onChange:at,className:"SelectRegular"},React.createElement("option",{value:""},"Select type"),!q&&React.createElement("option",{value:"percentage"},"Percentage"),React.createElement("option",{value:"amount"},"Amount")),b?b=="percentage"?React.createElement("div",{className:"SpecialInputPerch"},React.createElement("aside",null,"%"),React.createElement("input",{type:"number",min:0,max:100,value:S,onChange:function(t){return x(t.target.value)},className:"TextRegular"}),React.createElement("p",null,"Of ",p.symbol," Existing Supply")):React.createElement("div",{className:"InputTokensRegular"},React.createElement("div",{className:"InputTokenRegular"},React.createElement(_shared.Input,{showCoin:!0,address:p.address,name:p.symbol,value:N,onChange:function(t){return C(t.target.value)}}))):React.createElement("div",null),b&&j&&React.createElement(_Loading.default,null),b&&!j&&M.map(function(e,n){var r=t.dfoCore.web3.utils.toChecksumAddress(q?K.ethAddress:p.address),i=t.dfoCore.web3.utils.toChecksumAddress(M.length===1?r:M[M.length-2].outputTokenAddress);return React.createElement(_react.Fragment,{key:e.address},e&&React.createElement("div",{className:"PathSelected"},React.createElement("p",null,e.symbol," ",e.symbols.map(function(e){return React.createElement("span",null,e," ")}))," ",n===M.length-1?React.createElement("a",{className:"backActionBTN",onClick:function(){return ft(n)}},"x"):React.createElement("div",null)),React.createElement("div",{className:"PathSelected"},React.createElement("select",{value:e.outputTokenAddress,disabled:n!==M.length-1,onChange:function(t){return _(M.map(function(e,r){return r===n?_extends({},e,{outputTokenAddress:t.target.value}):e}))},className:"SelectRegular"},e.lpTokensAddresses.filter(function(e){return n!==M.length-1?!0:t.dfoCore.web3.utils.toChecksumAddress(e)!==i}).map(function(t){return React.createElement("option",{value:t},e.symbols[e.lpTokensAddresses.indexOf(t)])}))))}),!1,b&&React.createElement("div",{className:"CreateList CreateListS"},React.createElement(_shared.TokenInput,{label:"Path",placeholder:"Pool Address",deleteAfterInsert:!0,onClick:function(t){return et(t)},text:"Load"}),React.createElement("p",null,"Insert the address of the Liquidity Pool where the swap operation will occur")),b?React.createElement(React.Fragment,null,React.createElement("h6",null,React.createElement("b",null,"Receiver(s)")),React.createElement("div",{className:"CheckboxQuestions"},React.createElement("input",{type:"text",value:L,onChange:function(t){return A(t.target.value)},className:"TextRegular",placeholder:"Address","aria-label":"Receiver","aria-describedby":"button-add"}),React.createElement("div",{className:"Web2ActionsBTNs"}),React.createElement("a",{onClick:function(){var t=P.filter(function(e){return e.address===L}).length>0;if(t)return;H(P.concat({address:L,percentage:P.length===0?100:0})),A("")},className:"Web2ActionBTN",type:"button",id:"button-add"},"+")),React.createElement("div",{className:"ReceiversList"},P.map(function(e,t){return React.createElement("div",{key:e.address,className:"ReceiverSingle"},React.createElement("p",null,e.address),React.createElement("div",{className:"DeleteAddress"},React.createElement("a",{onClick:function(){return H(P.filter(function(e,n){return n!==t}))},className:"web2ActionBTN"},"X")),t!==P.length-1&&React.createElement("div",{className:"SpecialInputPerch"},React.createElement("aside",null,"%"),React.createElement("input",{type:"number",min:0,max:100,onChange:function(n){return Z(t,n.target.value)},className:"TextRegular",value:e.percentage})),t===P.length-1&&P.length!==1&&React.createElement("span",null,e.percentage))}))):React.createElement("div",null))},ct=function(){var n=!N&&!S||!b||P.length===0||!Y()||l==="swap"&&M.length===0;return React.createElement("div",{className:"InputForm"},l==="transfer"?ut():lt(),React.createElement("div",{className:"Web2ActionsBTNs"},React.createElement("a",{onClick:function(){return a(u-1)},className:"backActionBTN"},"Back"),React.createElement("a",{onClick:function(){return!n&&t.saveEditOperation(tt())},disabled:n,className:"web2ActionBTN"+(n?" disabled":"")},"Add")))},ht=function(){return React.createElement("div",null)};return it()},mapStateToProps=function(t){var n=t.core,r=t.session,i=n.dfoCore,s=r.inflationSetups;return{dfoCore:i,inflationSetups:s}},mapDispatchToProps=function(t){return{addEntry:function(n,r){return t((0,_actions.addEntry)(n,r))}}},_default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(CreateOrEditFixedInflationEntryOperation);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_components=require("../../../../components"),_Loading=_interopRequireDefault(require("../../../../components/shared/Loading")),Explore=function(t){function d(e,n){var r={0:{},1:{}};return Object.entries(e[0]).forEach(function(e){return r[0][e[0]]=e[1]}),Object.entries(e[1]).forEach(function(e){return r[1][e[0]]=e[1]}),t.dfoCore.web3.utils.toChecksumAddress(n)==="0x1CB9F190247C8745DFFc751b1604BC3b3Bcd2175"&&(r[0].name="EthOS - WIMD Weekly Fixed Inflation"),r}var n=(0,_react.useState)(!1),r=n[0],i=n[1],s=(0,_react.useState)([]),o=s[0],u=s[1],a=(0,_react.useState)([]),f=a[0],l=a[1],c=(0,_react.useState)(!0),h=c[0],p=c[1];(0,_react.useEffect)(function(){t.dfoCore&&v()},[]);var v=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return p(!0),r.prev=1,r.next=4,t.dfoCore.loadDeployedFixedInflationContracts();case 4:return e=[],r.next=7,Promise.all(t.dfoCore.deployedFixedInflationContracts.map(function(){var n=_asyncToGenerator(regeneratorRuntime.mark(function r(n){var i,s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.dfoCore.getContract(t.dfoCore.getContextElement("FixedInflationABI"),n.address);case 2:return i=a.sent,a.t0=d,a.next=6,i.methods.entry().call();case 6:return a.t1=a.sent,a.t2=n.address,s=(0,a.t0)(a.t1,a.t2),a.t3=t.dfoCore,a.t4=t.dfoCore.getContextElement("FixedInflationExtensionABI"),a.next=13,i.methods.extension().call();case 13:return a.t5=a.sent,a.next=16,a.t3.getContract.call(a.t3,a.t4,a.t5);case 16:return o=a.sent,u=!0,a.prev=18,a.next=21,o.methods.active().call();case 21:u=a.sent,a.next=26;break;case 24:a.prev=24,a.t6=a["catch"](18);case 26:u&&e.push({contract:i,entry:s[0],operations:s[1]});case 27:case"end":return a.stop()}},r,this,[[18,24]])}));return function(e){return n.apply(this,arguments)}}()));case 7:u(e),l(e),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](1),console.error(r.t0),u([]);case 15:return r.prev=15,p(!1),r.finish(15);case 18:case"end":return r.stop()}},n,this,[[1,11,15,18]])}));return function(){return e.apply(this,arguments)}}();return h?React.createElement(_Loading.default,null):React.createElement("div",{className:"MainExploration"},React.createElement("div",{className:"ListOfThings"},o.length===0&&React.createElement("div",{className:"col-12 text-left"},React.createElement("h6",null,React.createElement("b",null,"No fixed inflation contracts!"))),o.sort(function(e,t){return e.entry.name<t.entry.name?-1:e.entry.name>t.entry.name?1:0}).map(function(e,n){var r=e.contract,i=e.entry,s=e.operations;return React.createElement(_components.FixedInflationComponent,{key:i.name+"_"+n,className:"InflationContract",contract:r,entry:i,operations:s,showButton:!0,hasBorder:!0,edit:t.edit})})))},mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(Explore);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _react=require("react"),_reactRedux=require("react-redux"),_components=require("../../../../components"),_reactRouterDom=require("react-router-dom"),_Loading=_interopRequireDefault(require("../../../../components/shared/Loading")),_shared=require("../../../../components/shared"),ExploreInflationContract=function(t){var n=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i,s,o,u;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return v(!0),f.prev=1,r={from:t.dfoCore.address},i=a.methods.execute(g),f.next=6,i.estimateGas(r);case 6:return s=f.sent,r.gasLimit=s,f.next=10,i.send(r);case 10:return o=f.sent,f.next=13,window.web3.eth.getTransactionReceipt(o.transactionHash);case 13:o=f.sent,u=window.web3.eth.abi.decodeParameter("bool",o.logs.filter(function(e){return e.topics[0]===window.web3.utils.sha3("Executed(bool)")})[0].data),e=u?e:"Operation not executed, extension has been deactivated",f.next=21;break;case 18:f.prev=18,f.t0=f["catch"](1),e=f.t0;case 21:v(!1),w(),e&&alert(e.message||e);case 24:case"end":return f.stop()}},n,this,[[1,18]])}));return function(){return e.apply(this,arguments)}}(),r=t.dfoCore,i=(0,_react.useState)([]),s=i[0],o=i[1],u=(0,_react.useState)(null),a=u[0],f=u[1],l=(0,_react.useState)(null),c=l[0],h=l[1],p=(0,_react.useState)(!1),d=p[0],v=p[1],m=(0,_react.useState)(!1),g=m[0],y=m[1],b=(0,_reactRouterDom.useLocation)().pathname.split("/");(0,_react.useEffect)(function(){w()},[]);var w=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,i,s,o,u,a,l,c,p,d,v,m,g,y,w,E,S,x,T,N,C,k,L;return regeneratorRuntime.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.prev=0,e=b[b.length-1],A.next=4,t.dfoCore.getContract(t.dfoCore.getContextElement("FixedInflationABI"),e);case 4:return i=A.sent,f(i),A.next=8,i.methods.entry().call();case 8:s=A.sent,o=s[0],u=s[1].map(function(e){var t={};return Object.entries(e).forEach(function(e){return t[e[0]]=e[1]}),t}),a=u,l=Array.isArray(a),c=0,a=l?a:a[Symbol.iterator]();case 12:if(!l){A.next=18;break}if(!(c>=a.length)){A.next=15;break}return A.abrupt("break",98);case 15:p=a[c++],A.next=22;break;case 18:c=a.next();if(!c.done){A.next=21;break}return A.abrupt("break",98);case 21:p=c.value;case 22:d=p;if(d.ammPlugin===window.voidEthereumAddress){A.next=35;break}return A.next=26,t.dfoCore.getContract(t.dfoCore.getContextElement("AMMABI"),d.ammPlugin);case 26:return v=A.sent,A.t0=v,A.next=30,v.methods.info().call();case 30:return A.t1=A.sent,A.next=33,v.methods.data().call();case 33:A.t2=A.sent,d.amm={contract:A.t0,info:A.t1,data:A.t2};case 35:return A.next=37,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),d.inputTokenAddress);case 37:m=A.sent,A.t3=m;if(!(d.inputTokenAddress===window.voidEthereumAddress||d.amm&&d.enterInETH&&d.inputTokenAddress===d.amm.data[0])){A.next=43;break}A.t4="ETH",A.next=46;break;case 43:return A.next=45,m.methods.symbol().call();case 45:A.t4=A.sent;case 46:A.t5=A.t4;if(!(d.inputTokenAddress===window.voidEthereumAddress||d.amm&&d.enterInETH&&d.inputTokenAddress===d.amm.data[0])){A.next=51;break}A.t6="18",A.next=54;break;case 51:return A.next=53,m.methods.decimals().call();case 53:A.t6=A.sent;case 54:A.t7=A.t6,A.t8=d.inputTokenAddress===window.voidEthereumAddress||d.amm&&d.enterInETH&&d.inputTokenAddress===d.amm.data[0]?window.voidEthereumAddress:d.inputTokenAddress,d.inputToken={contract:A.t3,symbol:A.t5,decimals:A.t7,address:A.t8},A.t9=regeneratorRuntime.keys(d.swapPath);case 58:if((A.t10=A.t9()).done){A.next=96;break}return g=A.t10.value,y=d.swapPath[g=parseInt(g)],A.next=63,t.dfoCore.getContract(t.dfoCore.getContextElement("ERC20ABI"),y);case 63:return w=A.sent,A.t11=w,A.next=67,w.methods.symbol().call();case 67:return A.t12=A.sent,A.next=70,w.methods.decimals().call();case 70:A.t13=A.sent,A.t14=y,E={contract:A.t11,symbol:A.t12,decimals:A.t13,address:A.t14};if(!d.amm||!d.exitInETH||g!==d.swapPath.length-1){A.next=93;break}A.t15=w;if(y!==d.amm.data[0]){A.next=79;break}A.t16="ETH",A.next=82;break;case 79:return A.next=81,w.methods.symbol().call();case 81:A.t16=A.sent;case 82:A.t17=A.t16;if(y!==d.amm.data[0]){A.next=87;break}A.t18="18",A.next=90;break;case 87:return A.next=89,w.methods.decimals().call();case 89:A.t18=A.sent;case 90:A.t19=A.t18,A.t20=y===d.amm.data[0]?window.voidEthereumAddress:y,E={contract:A.t15,symbol:A.t17,decimals:A.t19,address:A.t20};case 93:(d.swapTokens=d.swapTokens||[]).push(E),A.next=58;break;case 96:A.next=12;break;case 98:return S=Object.entries(r.getContextElement("blockIntervals")).filter(function(e){var t=e[0],n=e[1];return n===o.blockInterval}),A.next=101,i.methods.ONE_HUNDRED().call();case 101:return x=A.sent,T=o.callerRewardPercentage/x*100,A.t21=parseInt,A.next=106,window.web3.eth.getBlockNumber();case 106:return A.t22=A.sent,N=(0,A.t21)(A.t22),C=parseInt(o.lastBlock)+parseInt(o.blockInterval),A.t23=t.dfoCore,A.t24=t.dfoCore.getContextElement("FixedInflationExtensionABI"),A.next=113,i.methods.extension().call();case 113:return A.t25=A.sent,A.next=116,A.t23.getContract.call(A.t23,A.t24,A.t25);case 116:return k=A.sent,L=!0,A.prev=118,A.next=121,k.methods.active().call();case 121:L=A.sent,A.next=126;break;case 124:A.prev=124,A.t26=A["catch"](118);case 126:return A.t27=h,A.t28=o,A.t29=o.name,A.t30=S[0],A.t31=T,A.t32=u,A.next=134,i.methods.extension().call();case 134:A.t33=A.sent,A.t34=i.options.address,A.t35=L&&N>=C,A.t36=L,A.t37=i,A.t38=x,A.t39=C,A.t40={entry:A.t28,name:A.t29,period:A.t30,executorReward:A.t31,operations:A.t32,extension:A.t33,contractAddress:A.t34,executable:A.t35,active:A.t36,contract:A.t37,oneHundred:A.t38,nextBlock:A.t39},(0,A.t27)(A.t40),A.next=148;break;case 145:A.prev=145,A.t41=A["catch"](0),console.error(A.t41);case 148:case"end":return A.stop()}},n,this,[[0,145],[118,124]])}));return function(){return e.apply(this,arguments)}}();return c?React.createElement("div",{className:"InflationContractAll"},React.createElement("div",{className:"InflationContractOpen"},React.createElement("h3",null,c.entry.name),React.createElement("div",{className:"InflationContractOpenBack"},React.createElement(_reactRouterDom.Link,{to:"/inflation/dapp",className:"backActionBTN"},"Back"))),c.operations.map(function(e,n){var r=window.fromDecimals(e.inputTokenAmount,e.inputTokenAmountIsPercentage?"18":e.inputToken.decimals,!0);return r=e.inputTokenAmountIsPercentage?parseFloat(r)*100:r,React.createElement(_react.Fragment,{key:n},React.createElement("div",{className:"TokenOperation"},React.createElement("h6",null,"Operation ",n+1),React.createElement("div",{className:"TokenOperationLinks"},e.ammPlugin!==window.voidEthereumAddress&&React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"address/"+e.ammPlugin},e.amm.info[0]),e.receivers.map(function(n,r){var i=r===e.receiversPercentages.length?c.oneHundred:e.receiversPercentages[r];if(r===e.receiversPercentages.length)for(var s=e.receiversPercentages,o=Array.isArray(s),u=0,s=o?s:s[Symbol.iterator]();;){var a;if(o){if(u>=s.length)break;a=s[u++]}else{u=s.next();if(u.done)break;a=u.value}var f=a;i=window.web3.utils.toBN(i).sub(window.web3.utils.toBN(f)).toString()}return React.createElement(_react.Fragment,{key:n},React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"address/"+n},window.formatMoney(parseFloat(window.fromDecimals(i,18,!0))*100),"% Receiver"))}),React.createElement("a",{target:"_blank",href:t.dfoCore.getContextElement("etherscanURL")+"address/"+c.extension},"Sender")),React.createElement("p",null,React.createElement("b",null,e.inputTokenAmountIsByMint?"Mint ":"Transfer ")," ",window.formatMoney(r)!="0"?window.formatMoney(r):r," ",e.inputTokenAmountIsPercentage?"% of ":" "," ",e.inputToken.symbol," ",React.createElement(_shared.Coin,{address:e.inputToken.address})," ",e.inputTokenAmountIsPercentage?" Supply ":"",e.ammPlugin!==window.voidEthereumAddress&&React.createElement(React.Fragment,null,"and ",React.createElement("b",null,"swap"),React.createElement("span",null," "," > "," "),e.swapTokens.map(function(t,n){return React.createElement(React.Fragment,null,t.symbol,React.createElement(_shared.Coin,{address:t.address}),n!==e.swapTokens.length-1&&" > ")})))))}),React.createElement("div",{className:"TokenOperationExecute"},c.executorReward!==0&&React.createElement("h5",null," ",window.formatMoney(c.executorReward),"% reward by"),c.executable&&!d&&React.createElement("select",{className:"SelectRegular",value:g,onChange:function(t){return y(t.currentTarget.value==="true")}},React.createElement("option",{value:"true"},"Input"),React.createElement("option",{value:"false"},"Output"))),React.createElement("h5",null,"Next Execution Block: ",React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"block/"+c.nextBlock,target:"_blank"},React.createElement("b",null,"#",c.nextBlock))),c.executable&&!d&&React.createElement("a",{className:"Web3ActionBTN",onClick:n},"Execute"),d&&React.createElement(_Loading.default,null)):React.createElement(_Loading.default,null)},mapStateToProps=function(t){return{dfoCore:t.core.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(ExploreInflationContract);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _propTypes=_interopRequireDefault(require("prop-types")),_reactRouterDom=require("react-router-dom"),_react=require("react"),_reactRedux=require("react-redux"),_Loading=_interopRequireDefault(require("../Loading")),FixedInflationComponent=function(t){var n=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,i,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return y(!0),a.prev=1,r={from:t.dfoCore.address},i=s.methods.execute([o.id],[w]),a.next=6,i.estimateGas(r);case 6:return u=a.sent,r.gasLimit=u,a.next=10,i.send(r);case 10:a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](1),e=a.t0;case 15:y(!1),e&&alert(e.message);case 17:case"end":return a.stop()}},n,this,[[1,12]])}));return function(){return e.apply(this,arguments)}}(),r=t.className,i=t.dfoCore,s=t.contract,o=t.entry,u=t.operations,a=t.showButton,f=t.hasBorder,l=(0,_react.useState)(null),c=l[0],h=l[1],p=(0,_react.useState)(!0),d=p[0],v=p[1],m=(0,_react.useState)(!1),g=m[0],y=m[1],b=(0,_react.useState)(!1),w=b[0],E=b[1];(0,_react.useEffect)(function(){S()},[]);var S=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){var e,r,a,f,l,c,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return v(!0),d.prev=1,e=Object.entries(i.getContextElement("blockIntervals")).filter(function(e){var t=e[0],n=e[1];return n===o.blockInterval}),d.next=5,s.methods.ONE_HUNDRED().call();case 5:return r=d.sent,a=o.callerRewardPercentage/r*100,d.t0=parseInt,d.next=10,window.web3.eth.getBlockNumber();case 10:return d.t1=d.sent,f=(0,d.t0)(d.t1),l=parseInt(o.lastBlock)+parseInt(o.blockInterval),d.t2=t.dfoCore,d.t3=t.dfoCore.getContextElement("FixedInflationExtensionABI"),d.next=17,s.methods.extension().call();case 17:return d.t4=d.sent,d.next=20,d.t2.getContract.call(d.t2,d.t3,d.t4);case 20:return c=d.sent,p=!0,d.prev=22,d.next=25,c.methods.active().call();case 25:p=d.sent,d.next=30;break;case 28:d.prev=28,d.t5=d["catch"](22);case 30:return d.t6=h,d.t7=o,d.t8=o.name,d.t9=e[0],d.t10=a,d.t11=u,d.next=38,s.methods.extension().call();case 38:d.t12=d.sent,d.t13=s.options.address,d.t14=p&&f>=l,d.t15=p,d.t16={entry:d.t7,name:d.t8,period:d.t9,executorReward:d.t10,operations:d.t11,extension:d.t12,contractAddress:d.t13,executable:d.t14,active:d.t15},(0,d.t6)(d.t16),d.next=49;break;case 46:d.prev=46,d.t17=d["catch"](1),console.error(d.t17);case 49:return d.prev=49,v(!1),d.finish(49);case 52:case"end":return d.stop()}},n,this,[[1,46,49,52],[22,28]])}));return function(){return e.apply(this,arguments)}}();return React.createElement("div",{className:r},c?React.createElement(React.Fragment,null,React.createElement("h4",null,c.name),React.createElement("div",{className:"InflationContractLinks"},React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"address/"+c.extension,target:"_blank"},"Host"),React.createElement("a",{href:t.dfoCore.getContextElement("etherscanURL")+"address/"+c.contractAddress,target:"_blank"},"Contract"),t.edit&&React.createElement("a",{href:"javascript:;",onClick:function(){return $.publish("fixedInflation/edit/open",[c.contractAddress])}},"Edit")),c.executorReward!==0&&React.createElement("p",null,window.formatMoney(c.executorReward),"% Reward to execute ",c.operations.length," operations"),c.executorReward===0&&React.createElement("p",null,c.operations.length," Operations"),React.createElement("div",{className:"InflationContractButton"},a?React.createElement(_reactRouterDom.Link,{to:"/inflation/dapp/"+c.contractAddress,className:"web2ActionBTN"},"Open"):React.createElement("div",null),!1,!1)):React.createElement("div",{className:"col-12 justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"}))))};FixedInflationComponent.propTypes={className:_propTypes.default.string,entry:_propTypes.default.any.isRequired,hasBorder:_propTypes.default.bool};var mapStateToProps=function(t){var n=t.core;return{dfoCore:n.dfoCore}},_default=(0,_reactRedux.connect)(mapStateToProps)(FixedInflationComponent);exports.default=_default;function _extends(){return _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_extends.apply(this,arguments)}function require(e){if(e==="react")return React;if(e==="prop-types")return PropTypes;if(e==="react-redux")return{connect:function(){return function(t){window[t.name]=function(e){return t(injectGlobalProps(e))}}}};if(e==="react-router")return{useParams:function(){return{}}};var t=e.substring(e.lastIndexOf("/")+1);return t==="context.json"?_extends({},window.context,{"default":window.context}):t.endsWith(".png")?"assets/img/"+t:t.substring(0)===t.substring(0).toLowerCase()?window:window[t]}function injectGlobalProps(e){var t=_extends({},e);return t.dfoCore=_extends({},window,t.dfoCore),t.dfoCore.address=window.walletAddress,t.dfoCore.web3=window.web3,t.dfoCore.networkId=window.networkId,t.dfoCore.getContextElement=function(t){return window.getNetworkElement(t)||window.context[t]},t.dfoCore.getContract=function(t,n){return new Promise(function(e){e(window.newContract(t,n||undefined))})},t.dfoCore.toDecimals=function(){return window.fromDecimals.apply(window,arguments)},t.dfoCore.fromDecimals=function(){return window.toDecimals.apply(window,arguments)},t.dfoCore.toFixed=function(t){return window.numberToString(t)},t.dfoCore.getBlockNumber=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=parseInt,t.next=3,window.web3.eth.getBlockNumber();case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}},n,this)}));return t}(),t.dfoCore.tryRetrieveWellKnownTokenImage=function(t){var n=this;t=window.web3.utils.toChecksumAddress(t||this.voidEthereumAddress);var r=window.context.wellKnownTokens||{},i=JSON.parse(JSON.stringify(r));return r={},Object.entries(i).forEach(function(e){return r[n.web3.utils.toChecksumAddress(e[0]||n.voidEthereumAddress)]=window.formatLink(e[1])}),r[t]},t.dfoCore.loadFarmingSetup=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,t){var r,i,s,o,u,a,f;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,e.methods.setup(t).call();case 3:return l.abrupt("return",l.sent);case 6:l.prev=6,l.t0=l["catch"](0);case 8:return r={setup:{types:["uint256","bool","uint256","uint256","uint256","uint256","uint256","uint256"],names:["infoIndex","active","startBlock","endBlock","lastUpdateBlock","objectId","rewardPerBlock","totalSupply"]},info:{types:["bool","uint256","uint256","uint256","uint256","uint256","address","address","address","address","bool","uint256","uint256","uint256"],names:["free","blockDuration","originalRewardPerBlock","minStakeable","maxStakeable","renewTimes","ammPlugin","liquidityPoolTokenAddress","mainTokenAddress","ethereumAddress","involvingETH","penaltyFee","setupsCount","lastSetupIndex"]}},l.next=11,this.web3.eth.call({to:e.options.address,data:e.methods.setup(t).encodeABI()});case 11:i=l.sent,s=["tuple("+r.setup.types.join(",")+")","tuple("+r.info.types.join(",")+")"];try{i=abi.decode(s,i)}catch(c){}o={};for(t in r.setup.names)u=r.setup.names[t],a=i[0][t],a!==!0&&a!==!1&&(a=a.toString()),o[u]=a;f={};for(t in r.info.names)u=r.info.names[t],a=i[1][t],a!==!0&&a!==!1&&(a=a.toString()),f[u]=a;return f.startBlock=f.startBlock||"0",l.abrupt("return",[o,f]);case 20:case"end":return l.stop()}},n,this,[[0,6]])}));return t}(),t}function ImportReact(e){var t=e.name||e.displayName,n=e.render;return window[t]=window[t]||React.createClass(_extends({},e,{displayName:t,render:function(){var r={};return this.props&&Object.entries(this.props).forEach(function(e){return r[e[0]]=e[1]}),this.state&&Object.entries(this.state).forEach(function(e){return r[e[0]]=e[1]}),r.props&&Object.entries(r.props).forEach(function(e){return r[e[0]]=e[1]}),delete r.props,r.parentReactElement=this,r.element=this.props.element,React.createElement("div",{className:e.className},React.createElement(window[n],injectGlobalProps(r)))}}))}window.exports=window.exports||{};function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _propTypes=_interopRequireDefault(require("prop-types")),_react=require("react"),ApproveButton=function(t){var n=t.contract,r=t.spender,i=t.from,s=t.text,o=t.onApproval,u=t.isERC1155,a=t.onError,f=t.disabled,l=(0,_react.useState)(!1),c=l[0],h=l[1],p=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,s,f,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:h(!0);if(u){c.next=19;break}return c.prev=2,c.next=5,n.methods.approve(r,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff").estimateGas({from:i});case 5:return e=c.sent,c.next=8,n.methods.approve(r,"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff").send({from:i,gas:e});case 8:s=c.sent,h(!1),o(s),c.next=17;break;case 13:c.prev=13,c.t0=c["catch"](2),h(!1),a(c.t0);case 17:c.next=34;break;case 19:return c.prev=19,c.next=22,n.methods.setApprovalForAll(r,!0).estimateGas({from:i});case 22:return f=c.sent,c.next=25,n.methods.setApprovalForAll(r,!0).send({from:i,gas:f});case 25:l=c.sent,h(!1),o(l),c.next=34;break;case 30:c.prev=30,c.t1=c["catch"](19),h(!1),a(c.t1);case 34:case"end":return c.stop()}},t,this,[[2,13],[19,30]])}));return function(){return e.apply(this,arguments)}}();return c?React.createElement("a",{className:"ApproveBTN",disabled:c},React.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):React.createElement("a",{onClick:function(){return p()},disabled:f,className:"ApproveBTN"},s||"Approve")};ApproveButton.propTypes={from:_propTypes.default.string,contract:_propTypes.default.any,spender:_propTypes.default.string,text:_propTypes.default.string,onApproval:_propTypes.default.func,onError:_propTypes.default.func};var _default=ApproveButton;exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _propTypes=_interopRequireDefault(require("prop-types")),_react=require("react"),_defaultLogo=_interopRequireDefault(require("../../../assets/images/default-logo.png")),_eth=_interopRequireDefault(require("../../../assets/images/eth.png")),_reactRedux=require("react-redux"),Coin=function(t){var n=t.forcedImage,r=t.height,i=(0,_react.useState)(t.dfoCore.getContextElement("trustwalletImgURLTemplate").split("{0}").join(window.web3.utils.toChecksumAddress(t.address))),s=i[0],o=i[1],u=require("../../../data/context.json").default.icons,a=t.dfoCore.tryRetrieveWellKnownTokenImage(t.address),f=t.address===window.voidEthereumAddress?_eth.default:s,l=t.dfoCore.web3.utils.toChecksumAddress(t.address),c=t.dfoCore.itemsTokens.filter(function(e){return e.address===l})[0];c&&(f=c.logoURI);var h=function(){if(a)return o(a);u[t.address.toLowerCase()]?o(u[t.address.toLowerCase()]):o(_defaultLogo.default)};return React.createElement("img",{className:t.className,height:r||24,src:n||f,onError:function(t){return h()}})};Coin.propTypes={className:_propTypes.default.string,address:_propTypes.default.string,height:_propTypes.default.number};var mapStateToProps=function(t){var n=t.core,r=t.session,i=n.dfoCore,s=r.inflationSetups;return{dfoCore:i,inflationSetups:s}},_default=(0,_reactRedux.connect)(mapStateToProps)(Coin);exports.default=_default;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _Coin=_interopRequireDefault(require("../coin/Coin")),_propTypes=_interopRequireDefault(require("prop-types")),_react=require("react"),Input=function(t){var n=t.label,r=t.min,i=t.max,s=t.value,o=t.onChange,u=t.showBalance,a=t.balance,f=t.showMax,l=t.showCoin,c=t.address,h=t.name,p=t.tokenImage,d=t.extra,v=(0,_react.useState)(s),m=v[0],g=v[1];(0,_react.useEffect)(function(){g(s)},[s]);var y=function(t){g(t),o(b(t))},b=function(t,n){return n?{target:{value:a}}:t?{target:{value:t}}:{target:{value:0}}};return React.createElement(React.Fragment,null,n&&React.createElement("h6",null,React.createElement("b",null,n)),React.createElement("div",{className:"input-group",tabIndex:0},React.createElement("input",{disabled:t.disabled,type:"number",lang:"en-US",step:"any",className:"form-control "+(u&&parseFloat(m)>window.formatNumber(a)?"is-invalid":""),value:m,min:r,max:i||a,onChange:function(t){return y(t.target.value)}}),l&&React.createElement("div",{className:"input-group-append"},React.createElement("span",{className:"input-group-text "+(u&&parseFloat(m)>window.formatNumber(a)?"is-invalid":""),id:""},React.createElement(_Coin.default,{address:c,forcedImage:p})," ",h))),React.createElement("aside",null,f&&React.createElement("a",{onClick:function(){return o(b(0,a))},type:"button"},"MAX"),u&&React.createElement("span",{className:"BalanceImputPRCD"},"Balance: ",a.indexOf("0.00")===0?a:window.formatMoney(a,2)," ",h," ",d?d:"")))},_default=Input;exports.default=_default;function Link(e){return React.createElement("a",{target:"_blank",href:e.href||window.context.covenantsURL+e.to,className:e.className},e.children)};function Loading(){return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-12"},React.createElement("div",{className:"row justify-content-center"},React.createElement("div",{className:"spinner-border text-secondary",role:"status"},React.createElement("span",{className:"visually-hidden"})))))}exports.__esModule=!0,exports.default=Loading;function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0,exports.default=void 0;var _propTypes=_interopRequireDefault(require("prop-types")),_react=require("react"),TokenInput=function(t){function l(){if(!a)return;n(a),t.deleteAfterInsert&&f("")}var n=t.onClick,r=t.placeholder,i=t.text,s=t.width,o=t.label,u=(0,_react.useState)(t.tokenAddress||""),a=u[0],f=u[1];return React.createElement("div",{className:"LoadInput"},o&&React.createElement("h6",null,React.createElement("b",null,o)),React.createElement("input",{type:"text",className:"TextRegular",value:a,onChange:function(t){return f(t.target.value)},placeholder:r,"aria-label":r}),React.createElement("a",{className:"web2ActionBTN",onClick:l},i))};TokenInput.propTypes={label:_propTypes.default.string,onClick:_propTypes.default.func.isRequired,placeholder:_propTypes.default.string,text:_propTypes.default.string.isRequired,width:_propTypes.default.number};var _default=TokenInput;exports.default=_default;var IndexController=function(t){var n=this;n.view=t,n.tryLoadDFO=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(isEthereumAddress(e)){r.next=2;break}throw"Insert a valid DFO Address";case 2:return t=window.newContract(window.context.proxyAbi,e),r.next=5,window.blockchainCall(t.methods.getFunctionalitiesAmount);case 5:r.t0=r.sent;if(r.t0!==0){r.next=8;break}return r.abrupt("return","This Address is not a DFO");case 8:return r.abrupt("return",t);case 9:case"end":return r.stop()}},n,this)}));return t}()};var Index=React.createClass({displayName:"Index",requiredModules:["spa/deploy","spa/dFOList"],requiredScripts:["spa/messages.jsx","spa/loader.jsx","spa/walletEnablerButton.jsx","spa/noWeb3Loader.jsx","spa/imported/ReactImporter.jsx"],getDefaultSubscriptions:function(){var t=this;return{"dfo/deploy":this.onDFO,"dfo/deploy/cancel":function(){return t.setState({deploy:null})},"ethereum/ping":function(){return t.forceUpdate()},"index/fullscreen":this.onFullscreen,"stake/close":function(){return t.state&&t.state.optionalPage&&t.setState({optionalPage:null})},"stake/load":function(n){return window.tryLoadStaking(t,n)}}},onFullscreen:function(t){this.header.removeClass("HeaderTop"),t&&this.header.addClass("HeaderTop"),window.onScrollFunction&&window.onScrollFunction()},onDFO:function(t){var n=this;n.setState({dFO:t,deploy:null},function(){n.address&&(n.address.value=t.options.address)&&this.load({target:{dataset:{timeout:"0"}}}),window.history.pushState({},"",window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=="443"&&window.location.port!=="80"?":"+window.location.port:"")+"/?addr="+t.options.address)})},load:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.target.dataset.timeout;n=n?parseInt(n):700,this.loadTimeout&&window.clearTimeout(this.loadTimeout);var r=this;r.loadTimeout=setTimeout(function(){r.setState({dFO:null,deploy:null},function(){r.onFullscreen(),r.emit("search",r.address.value)})},n)},deploy:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);var n=this;n.setState({dFO:null,toggle:null,deploy:n.state&&n.state.deploy?!1:!0},function(){return n.onFullscreen(!0)})},componentDidMount:function(){var t="";try{t=window.addressBarParams.addr}catch(n){}isEthereumAddress(t)&&(this.address.value=t)&&this.load({target:{dataset:{timeout:"700"}}}),window.tryLoadStaking(this,window.addressBarParams.staking)},toggleLightMode:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0),$(t.target).html("&#"+(this.domRoot.toggleClass("DarkMode").hasClass("DarkMode")?"128161":"127769")+";"),window.localStorage.setItem("lightMode",this.domRoot.hasClass("DarkMode")?"false":"true")},compareGotcha:function(t){t&&setTimeout(function(){t.innerHTML='<a href="javascript:;" onclick="$(this).parent().parent().parent().hide()">Gotcha!</a>'},3e3)},toggleAdditionalViews:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(t.currentTarget.className.indexOf("Editing")!==-1)return this.setState({toggle:null});this.setState({toggle:t.currentTarget.dataset.toggle,deploy:!1})},render:function(){var t=this;return React.createElement("div",{className:"Main"+(window.localStorage.lightMode==="true"?"":" DarkMode")},React.createElement("section",{ref:function(n){return t.header=$(n)},className:"Explorer"},React.createElement("header",{className:"HeaderDFO"},React.createElement("ul",null,React.createElement("li",{className:"BrandLi"},React.createElement("a",{href:"javascript:;",onClick:function(){return window.location.reload()}},"👻",React.createElement("span",{className:"BODL"},"DFO"),React.createElement("span",null,"hub"))," ",React.createElement("a",{className:"BrandLiInfo",href:"https://dfohub.com",target:"_blank"}," ℹ")),React.createElement("li",{className:"SearchLi"},React.createElement("input",{ref:function(n){return t.address=n},placeholder:"Search by Address",onChange:this.load}),React.createElement("a",{href:"javascript:;",type:"button","data-timeout":"0",onClick:this.load},React.createElement("div",{className:"search"},React.createElement("div",{className:"search__circle"}),React.createElement("div",{"class":"search__rectangle"})))),React.createElement("li",{className:"DeployLi"},React.createElement(WalletEnablerButton,{className:"LinkVisualButton LinkVisualButtonB"+(this.state&&this.state.deploy?" Editing":""),onClick:this.deploy},this.state&&this.state.deploy?"Back":"New"),React.createElement("a",{className:"ChangeViewDtoW",href:"javascript:;",onClick:this.toggleLightMode,ref:function(t){return t&&(t.innerHTML="&#"+(window.localStorage.lightMode==="true"?"127769":"128161")+";")}},"🌙")))),(!this.state||!this.state.optionalPage)&&!window.context.bypassBetaBanner&&React.createElement("div",{className:"BETABANNER"},React.createElement("section",null,React.createElement("h1",null,"👻"),React.createElement("h2",null,"Welcome to the DFOhub ",React.createElement("span",null,window.context.dappVersion)),React.createElement("p",null,"To follow our Developing and Bug Fixing: ",React.createElement("a",{href:"https://www.notion.so/dfohub/DFOhub-Project-05787c6c7e2f49c5bd3a767c020583e8",target:"_blank"},"DevStatus")," If you want to be an active part of our Developing, we scheduled some fancy rewards! Read the ",React.createElement("a",{href:"https://www.notion.so/dfohub/Community-Guidelines-a03ceeab28254eb3944ab85320be70de",target:"_blank"},"Community Guidelines")," and join our ",React.createElement("a",{href:"https://discord.gg/B9V9CM4",target:"_blank"},"Discord Server")),React.createElement("section",{className:"BugUpdateBunner TheDappInfoX"},React.createElement("h2",null,"🛎 Dev Notes:"),React.createElement("p",null,"ENS Integration is working! But due to the early state of ENS, we're discussing an ",React.createElement("a",{href:"https://github.com/MetaMask/metamask-extension/pull/7740",target:"_blank"},"Improvement Proposal")," with the Metamask team, to manage DFO's ENS in a decentralized way. In the meantime, Metamask can't redirect the ENS properly."),React.createElement("p",null,"DFOhub is a USDT free dapp. USDT is not an ",React.createElement("a",{target:"_blank",href:"https://forum.openzeppelin.com/t/can-not-call-the-function-approve-of-the-usdt-contract/2130"},"ERC20 standard"),". We strongly recomend to don't use USDT in DFOs."),React.createElement("p",null,"DFOs wallets in this release don't support ERC1155, If you want to store ERC1155 in a DFO remember to wrap it before into an ITEM via ",React.createElement("a",{target:"_blank",href:"https://ethitem.com"},"ethitem.com"))),React.createElement("section",{className:"BugUpdateBunner TheDappInfoXYZ"},React.createElement("h2",null,"Simple View"),React.createElement("p",null,"During the R&D for the new DFOhub front-end V2, you can use this simplified front-end experience. Here you can use every DFOhub features (farming, voting etc), but to propose updates, you need to use a desktop.")),React.createElement("section",{ref:this.compareGotcha},React.createElement("span",{className:"loaderMinimino"})))),this.state&&this.state.deploy&&!this.state.toggle&&React.createElement(Deploy,null),(!this.state||!this.state.deploy&&!this.state.toggle)&&React.createElement(DFOList,null),this.state&&this.state.toggle&&React.createElement("br",null)),this.state&&this.state.optionalPage&&!this.state.toggle&&React.createElement(this.state.optionalPage.component,this.state.optionalPage.props),React.createElement(Messages,null),React.createElement(Loader,null))}});var Loader=React.createClass({displayName:"Loader",requiredScripts:["spa/sequentialOps.jsx"],getDefaultSubscriptions:function(){return{"loader/toggle":this.onToggle}},onToggle:function(t,n,r){this.setState({sequentialOps:n,initialContext:r,visible:t===!0||t===!1?t:this.state&&this.state.visible?!this.state.visible:!0})},render:function(){return React.createElement("div",{className:"MainLoader",style:{display:this.state&&this.state.visible?"block":"none"}},React.createElement("article",{className:"MainLoaderAll"},this.state&&this.state.sequentialOps&&React.createElement(SequentialOps,{auto:"true",start:"true",showCancelButton:"true",initialContext:this.state.initialContext},this.state.sequentialOps)))}});var LoaderMini=React.createClass({displayName:"LoaderMini",render:function(){return React.createElement("div",{className:"LoaderChainPull"},React.createElement("div",{className:"lds-ellipsis"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)),this.props.message&&React.createElement("h5",null,this.props.message))}});var LoaderMinimino=React.createClass({displayName:"LoaderMinimino",render:function(){return React.createElement("section",{className:"loaderMinimino"})}});var Messages=React.createClass({displayName:"Messages",getDefaultSubscriptions:function(){return{message:this.onMessage}},onMessage:function(t,n){this.setState({message:t,className:n})},clear:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0),this.onMessage()},render:function(){var t=this;return React.createElement("div",{className:"MainMsg"+(this.state&&this.state.className?" MainMsg_"+this.state.className:""),style:{display:this.state&&this.state.message?"block":"none"}},this.state&&this.state.message&&typeof this.state.message=="string"&&React.createElement("p",{ref:function(n){return n&&(n.innerHTML=t.state.message)}}),this.state&&this.state.message&&typeof this.state.message!="string"&&this.state.message.message&&React.createElement("p",{ref:function(n){return n&&(n.innerHTML=t.state.message.message)}}),this.state&&this.state.message&&typeof this.state.message!="string"&&this.state.message.map&&this.state.message.map(function(e){return React.createElement("p",{key:e,ref:function(n){return n&&(n.innerHTML=e)}})}),React.createElement("a",{href:"javascript:;",onClick:this.clear},"Close"))}});var NewProposalController=function(t){var n=this;n.view=t,n.publish=function(){var t=n.checkData();if(!t)return;t.functionalitySourceId=n.view.editor.contentTokenValue,t.functionalityAddress=n.view.editor.functionalityAddressValue,t.editor=n.view.editor,t.element=n.view.props.element,t.title="New Proposal",window.showProposalLoader(t)},n.checkData=function(){n.view.emit("message","");var t=[],r=window.getData(n.view.domRoot);try{r.sourceCode=n.view.editor.editor.getValue().trim()}catch(i){}try{r.functionalityMethodSignature=r.functionalityMethodSignature.split("_"),r.functionalityMethodSignature.splice(0,1),r.functionalityOutputParameters=r.functionalityMethodSignature.splice(r.functionalityMethodSignature.length-1,1)[0],r.functionalityMethodSignature=r.functionalityMethodSignature.join("_")}catch(i){}r.selectedContract=n.view.selectedContract;var s=r.functionalityMethodSignature&&window.checkMandatoryFunctionalityProposalConstraints(r.selectedContract.abi,r.functionalityMethodSignature==="callOneTime(address)");s&&t.push.apply(t,s),!r.functionalityReplace&&!r.functionalityName&&r.functionalityMethodSignature!=="callOneTime(address)"&&t.push("Functionality name is mandatory"),(r.functionalityName||r.functionalityReplace)&&r.functionalityMethodSignature==="callOneTime(address)"&&t.push("Name and Replaces must be blank for OneTime functionalities"),r.functionalityName&&!r.selectedContract&&t.push("You need to insert a valid SmartCotract code and choose a method."),r.selectedContract&&r.selectedContract.bytecode==="0x"&&t.push("You need to insert a valid SmartCotract code and choose a method."),(r.functionalityName||!r.functionalityName&&!r.functionalityReplace)&&!r.functionalityDescription&&t.push("Description is mandatory"),(r.functionalityName||!r.functionalityName&&!r.functionalityReplace)&&!(new RegExp(window.urlRegex)).test(r.functionalityLink)&&t.push("Link must be a mandatory URL"),r.functionalityName&&r.functionalityReplace&&!r.functionalityDescriptionUpdate&&t.push("Update description is mandatory");try{r.constructorArguments=window.getData(n.view.constructorArguments,!0)}catch(i){t.push("Constructor arguments are mandatory")}if(t.length>0)throw t.join("\n");if(!n.view.needsSender.disabled&&!n.view.needsSender.checked&&!confirm("The 'Needs Sender' check is useful to preserve the original msg.sender of the Transaction, are you sure you want to continue without flagging it?"))return;return r},n.loadStandardTemplate=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,window.SolidityUtilities.getCompilers();case 2:return e=s.sent,t=Object.keys(e.releases)[0],s.next=6,window.AJAXRequest("data/MicroserviceTemplate.sol");case 6:i=s.sent,i=i.format(t);try{n.view.editor.editor.setValue(i)}catch(o){};case 9:case"end":return s.stop()}},r,this)}));return t}()};var NewProposal=React.createClass({displayName:"NewProposal",requiredModules:["spa/editor"],getDefaultSubscriptions:function(){var t=this;return{"smartContract/compilation":this.onCompilation,"smartContract/compiling":this.onCompiling,"comment/changed":function(n,r){return t[r.toLowerCase()].value=n.trim()}}},onCompiling:function(){$(this.compileButton).addClass("disabled"),$(this.publishButton).addClass("disabled")},compile:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),!$(t.currentTarget).hasClass("disabled")&&(this.editor.functionalityAddressValue=this.functionalityAddress&&this.functionalityAddress.value),!$(t.currentTarget).hasClass("disabled")&&this.editor.tryCompile()},onType:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);var n=t.target,r=n.dataset.type,i=this,s="onTypeTimeout_"+r;i[s]&&clearTimeout(i[s]),i[s]=setTimeout(function(){i.editor.commentChanged(n.value.trim(),r)},900)},onCompilation:function(t){var n=this;$(this.compileButton).removeClass("disabled");try{if(JSON.stringify(this.contracts.name?[this.contracts.abi]:Object.keys(this.contracts).map(function(e){return n.contracts[e].abi}))===JSON.stringify(t.name?[t.abi]:Object.keys(t).map(function(e){return t[e].abi})))return}catch(r){}delete this.selectedContract,delete this.contractConstructor,this.contracts=t;var i=this.functionalityContracts.value;this.functionalityContracts.innerHTML="";if(!this.contracts){this.functionalityContractMethods.innerHTML="",this.onMethod();return}$(this.publishButton).removeClass("disabled"),t.name?this.functionalityContracts.innerHTML='<option value="'+t.name+'">'+t.name+"</option>":this.functionalityContracts.innerHTML=Object.keys(t).map(function(e){return t[e].bytecode!=="0x"&&'<option value="'+e+'">'+e+"</option>"}).join(""),i&&t[i]&&(this.functionalityContracts.value=i),this.onContract(),this.onMethod()},onContract:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);var n=this;delete n.contractConstructor;if(this.functionalityContracts.innerHTML==="")return;var r=parseInt(this.functionalityContractMethods.value),i="";try{i=this.functionalityContractMethods.children[r].innerHTML}catch(t){}this.functionalityContractMethods.innerHTML="",this.selectedContract=this.contracts.name?this.contracts:this.contracts[this.functionalityContracts.value];if(!this.selectedContract)return;var s=this.selectedContract.abi;this.functionalityContractMethods.innerHTML=s.map(function(e,t){var s=!1;try{s=t===r&&e.name===i}catch(o){}if(e.type==="constructor")return;if(e.name==="onStart"&&e.stateMutability!=="view"&&e.stateMutability!=="pure"&&e.inputs.length===2&&e.inputs[0].type==="address"&&e.inputs[1].type==="address")return;if(e.name==="onStop"&&e.stateMutability!=="view"&&e.stateMutability!=="pure"&&e.inputs.length===1&&e.inputs[0].type==="address")return;if(e.name==="getMetadataLink"&&e.stateMutability==="view"&&e.inputs.length===0&&e.outputs.length===1&&e.outputs[0].type==="string")return;var u=(e.type==="function"?e.name+"("+e.inputs.map(function(e){return e.type}).join(",").trim()+")":"").split(" ").join("").split(",)").join(")"),a=(e.type!=="function"?"[]":JSON.stringify(e.outputs.map(function(e){return e.type}))).split(" ").join("");return e.type==="constructor"&&(n.contractConstructor=e),e.type!=="function"?"":"<option value='"+t+"_"+u+"_"+a+"'"+(s?" selected":"")+">"+u+"</option>"}).join(""),this.functionalityContractMethods.innerHTML||(delete this.selectedContract,delete this.contractConstructor),this.onMethod(),this.contracts.name&&delete this.contractConstructor,this.forceUpdate()},onMethod:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0),this.submitable.checked=!1,this.internal.checked=!1,this.needsSender.checked=!1,this.internal.disabled=!0,this.needsSender.disabled=!0;if(this.functionalityContractMethods.innerHTML==="")return;var n=this.functionalityContractMethods.value.split("_")[1];this.internal.disabled=n==="callOneTime(address)";var r=(this.contracts.name?this.contracts:this.contracts[this.functionalityContracts.value]).abi[this.functionalityContractMethods.value.split("_")[0]];this.submitable.checked=r.stateMutability!=="view"&&r.stateMutability!=="pure",this.submitable.checked&&r.inputs.length>=2&&(this.needsSender.disabled=r.inputs[0].type!=="address"||r.inputs[1].type!=="uint256"),!this.submitable.checked&&r.inputs.length>=1&&(this.needsSender.disabled=r.inputs[0].type!=="address")},publish:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);if($(this.publishButton).hasClass("disabled"))return;try{this.controller.publish()}catch(t){this.emit("message",t.message||t,"error")}},componentDidMount:function(){var t=this;t.onReplace(),window.loadFunctionalities(t.props.element,undefined,!0);try{blockchainCall(t.props.element.functionalitiesManager.methods.functionalityNames).then(JSON.parse).then(function(e){return t.props.element.functionalityNames=e}).then(function(){return t.forceUpdate()}).catch(function(e){})}catch(n){}},onReplace:function(t){t&&t.preventDefault(!0)&&t.stopPropagation(!0);var n=this.functionalityReplace.value,r=$(this.updateDescriptionLabel).hide(),i=$(this.update).hide();n&&r.show()&&i.show();try{!n&&this.editor.commentChanged(this.update.value="","Update")}catch(t){}},getFunctionality:function(){try{for(var t in this.props.element.functionalities){var n=this.props.element.functionalities[t];if(n.codeName===this.props.codeName)return n}}catch(r){}},onEditor:function(t){var n=this,r=this;this.editor=t;if(!this.editor||this.props.delete)return;try{var i=this.getFunctionality();i&&this.enqueue(function(){return n.editor.loadContent(i.sourceLocationId,i.sourceLocation)})}catch(s){}r.props.oneTimeProposal&&window.SolidityUtilities.getCompilers().then(function(e){return Object.keys(e.releases)[0]}).then(function(e){var t=JSON.parse(JSON.stringify(window.context.oneTimeProposalTemplate));t.unshift(""),t.unshift("pragma solidity ^"+e+";"),r.enqueue(function(){return r.editor.editor.setValue(t.join("\n"))},300)}),setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.editor.editor.getValue().trim()===""){t.next=2;break}return t.abrupt("return");case 2:r.controller.loadStandardTemplate();case 3:case"end":return t.stop()}},o,this)})),600)},render:function(){var t=this,n=this,r=this.getFunctionality();return React.createElement("section",{className:"NewProposalIndex"},React.createElement("section",{className:"TheDappInfoXYZ"},React.createElement("section",{className:"AllertBanner"},React.createElement("p",null,"To propose changes, open this website with a desktop or a tablet"))),React.createElement("section",{className:"AllertBanner TheDappInfoX"},React.createElement("p",null,"If you're deploying a new perpetual functionality, be sure to add both onStart(address,address) and onStop(address) into the Smart Contract.")),React.createElement("section",{className:"SideViewCode TheDappInfoX"},React.createElement(Editor,{ref:this.onEditor,className:"NewProposalCode",readonly:this.props.delete||this.props.oneTimeCode,sourceLocation:this.props.sourceLocation,sourceLocationId:this.props.sourceLocationId,firstCode:this.props.oneTimeCode,compileAtStart:this.props.oneTimeCode!==undefined&&this.props.oneTimeCode!==null})),React.createElement("section",{className:"DFOItOptions TheDappInfoX"},React.createElement("p",null,"Name"),React.createElement("input",{className:"ProposeTitle",id:"functionalityName",type:"text",ref:function(n){return n&&(n.disabled=r||t.props.delete||t.props.oneTimeCode||t.props.oneTimeProposal?!0:!1)&&(n.value=!t.props.delete&&r&&r.codeName||"")}}),React.createElement("p",null,"Discussion Link"),React.createElement("input",{className:"ProposeLink",id:"functionalityLink","data-type":"Discussion",type:"text",ref:function(n){return t.discussion=n},onChange:this.onType}),React.createElement("p",null,"Function Description"),React.createElement("textarea",{id:"functionalityDescription","data-type":"Description",ref:function(n){return(t.description=n)&&(n.disabled=t.props.oneTimeCode!==undefined&&t.props.oneTimeCode!==null)},onChange:this.onType}),React.createElement("p",{ref:function(n){return t.updateDescriptionLabel=n}},"Update Description"),React.createElement("textarea",{id:"functionalityDescriptionUpdate","data-type":"Update",ref:function(n){return t.update=n},onChange:this.onType}),React.createElement("select",{id:"contractName",ref:function(n){return t.functionalityContracts=n},onChange:this.onContract}),React.createElement("select",{id:"functionalityMethodSignature",ref:function(n){return t.functionalityContractMethods=n},onChange:this.onMethod}),React.createElement("label",{htmlFor:"functionalitySubmitable"},"Submitable"),React.createElement("input",{id:"functionalitySubmitable",type:"checkbox",ref:function(n){return t.submitable=n},disabled:!0}),React.createElement("label",{htmlFor:"functionalityInternal"},"Internal"),React.createElement("input",{id:"functionalityInternal",type:"checkbox",ref:function(n){return t.internal=n},disabled:!0}),React.createElement("label",{htmlFor:"functionalityNeedsSender"},"Needs Sender"),React.createElement("input",{id:"functionalityNeedsSender",type:"checkbox",ref:function(n){return t.needsSender=n},disabled:!0}),React.createElement("label",{htmlFor:"replacesCheck"},"Function replacing"),React.createElement("input",{id:"replacesCheck",type:"checkbox",ref:function(n){return n&&(n.checked=n.disabled=r||t.props.delete||t.props.oneTimeCode||t.props.oneTimeProposal?!0:!1)&&(n.checked=t.props.oneTimeProposal?!1:n.checked)},onChange:function(n){t.functionalityReplace.value="",t.functionalityReplace.disabled=!n.currentTarget.checked,n.currentTarget.checked?$(t.functionalityReplace).show():$(t.functionalityReplace).hide()}}),React.createElement("select",{id:"functionalityReplace",onChange:this.onReplace,ref:function(n){t.functionalityReplace=n,n&&(n.value=r&&r.codeName||""),n&&r&&r.codeName?$(n).show():$(n).hide()},disabled:!0},React.createElement("option",{value:""},"Replacing Functionality"),this.props.element.functionalityNames&&this.props.element.functionalityNames.map(function(e){return React.createElement("option",{key:e,value:e},e)})),this.contractConstructor&&this.contractConstructor.inputs.length>0&&React.createElement("div",null,React.createElement("p",null,"Constructor arguments"),React.createElement("ul",{ref:function(n){return t.constructorArguments=$(n)}},this.contractConstructor.inputs.map(function(e){return React.createElement("li",{key:e.name},(e.type==="bytes32"||e.type==="address"||e.type==="string"||e.type.indexOf("uint")==0)&&React.createElement("input",{type:e.type.indexOf("uint")==0?"number":"text",min:"0",placeholder:e.name}),e.type==="bool"&&React.createElement("select",null,React.createElement("option",{value:"false",selected:!0},"false"),React.createElement("option",{value:"true"},"true")))}))),React.createElement("div",null,React.createElement("a",{ref:function(n){return t.compileButton=n},className:"LinkVisualButton"+(this.props.delete?" disabled":""),href:"javascript:;",onClick:this.compile},"Compile"),React.createElement(WalletEnablerButton,{inactiveClassName:"LinkVisualButtonPre",className:this.props.delete?"":"disabled",onClick:this.publish,ref:function(n){return t.publishButton=n&&n.domRoot[0]||undefined}},"Publish")),React.createElement("h4",null,"Advanced"),React.createElement("label",{htmlFor:"emergency"},"Emergency"),React.createElement("input",{id:"emergency",type:"checkbox",onChange:function(){return $(t.publishButton).toggleClass("emergency")}}),React.createElement("label",{htmlFor:"deployed"},"Deployed Contract?"),React.createElement("input",{id:"deployed",type:"checkbox",ref:function(n){return t.deployedCheckbox=n},onChange:function(){t.deployed.toggle(),t.editor&&(t.editor.functionalityAddressValue=""),t.functionalityAddress&&(t.functionalityAddress.value="")}}),React.createElement("section",{ref:function(n){return(t.deployed=$(n))&&n&&(!t.deployedCheckbox||!t.deployedCheckbox.checked)&&t.deployed.hide()}},React.createElement("input",{id:"functionalityAddress",placeholder:"Smart Contract Address",type:"text",ref:function(n){return t.functionalityAddress=n},onChange:function(){t.onCompilation(),t.editor.functionalityAddressValue=""}}),React.createElement("a",{onClick:this.compile},"Load"))))}});var NoWeb3Loader=React.createClass({displayName:"NoWeb3Loader",render:function(){return React.createElement("article",{className:"NoWeb3",style:{position:"fixed","z-index":"300000",top:"0",width:"100%",height:"100%",background:"white","margin-top":"0"}},React.createElement("h1",null,React.createElement("img",{src:"assets/img/ghostload.gif"})),React.createElement("section",{className:"DisclamerWeb3"},React.createElement("h2",null,"DFOhub")))}});var OkBoomer=React.createClass({displayName:"OkBoomer",render:function(){return this.props.okBoomer?React.createElement("p",{className:"OkBoomer"},this.props.okBoomer&&this.props.children,React.createElement("div",{className:"BoomerTriangle"})):React.createElement("span",{style:{display:"none"}})}});var OverviewController=function(t){var n=this;n.view=t,n.indexChange=function(t){t.index=t.index||0,t.link=t.link||"";if(!t.indexFile&&!t.link)return n.view.emit("message","You must specify an index or a Link to proceed","error");if(t.index===n.view.props.element.index&&t.link===n.view.props.element.link)return;t.linkCheck&&n.changeDistributed(t),t.indexCheck&&n.changeDecentralized(t)},n.changeDistributed=function(t){if(t.link!==n.view.props.element.link&&!(new RegExp(window.urlRegex)).test(t.link))return n.view.emit("message","Inserted link is not a valid URL","error");var r=["DFO Hub - Utilities - Get Distributed Index","This functionality provides the link page which locates the DFO"],i=["Setting Distributed Index value to "+t.link];!n.view.props.element.link&&r.push(i[0]),t.link||(i=["Clearing Distributed Index"]);var s=t.link?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("string memory").split("value").join('\\"'+t.link+'\\"')):undefined;window.sendGeneratedProposal(n.view.props.element,{title:i[0],functionalityName:t.link?"getLink":"",functionalityMethodSignature:t.link?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:t.link&&n.view.props.element.link?"getLink":"",functionalityOutputParameters:t.link?'["string"]':""},s,undefined,r,i)},n.changeDecentralized=function(t){var r=["DFO Hub - Utilities - Get Decentralized Index","This functionality provides the Base64 index containing the Decentralized Index page representing this DFO"],i=["Setting Decentralized Index value"];t.index||(i=["Clearing Decentralized Index"]);var s=t.index?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256")):undefined,o=isNaN(t.index)?window.split(t.index):undefined;window.sendGeneratedProposal(n.view.props.element,{title:i[0],functionalityName:t.index?"getIndex":"",functionalityMethodSignature:t.index?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:!t.index||n.view.props.element.index?"getIndex":"",functionalityOutputParameters:t.index?'["uint256"]':"",sequentialOps:o&&[{name:"Minting Index page ("+o.length+" Txns)",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,window.mint(o);case 2:t.index=s.sent,t.updates=["Setting Decentralized Index value to "+t.index],!n.view.props.element.index&&r.push(i[0]),t.template=JSON.parse(JSON.stringify(t.template).split("value").join(window.numberToString(t.index)));case 6:case"end":return s.stop()}},s,this)}))()}}]},s,undefined,r,i)},n.proposalLengthChange=function(t){if(t.proposalLength===parseInt(n.view.props.element.blocks))return;if(!t.proposalLength||isNaN(t.proposalLength)||t.proposalLength<1)return n.view.emit("message","You must specify a number greater than 0 to proceed","error");var r=JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getMinimumBlockNumberForSurvey()").split("type").join("uint256").split("value").join(t.proposalLength));window.sendGeneratedProposal(n.view.props.element,{title:"Updating Proposal Length",functionalityName:"getMinimumBlockNumberForSurvey",functionalitySubmitable:!1,functionalityMethodSignature:"getMinimumBlockNumberForSurvey()",functionalityReplace:"getMinimumBlockNumberForSurvey",functionalityOutputParameters:'["uint256"]'},r,undefined,["Survey Length"],["Survey Length updated to "+t.proposalLength+" blocks"])},n.emergencyLengthChange=function(t){if(t.minimumBlockNumberForEmergencySurvey===parseInt(n.view.props.element.minimumBlockNumberForEmergencySurvey))return;if(!t.minimumBlockNumberForEmergencySurvey||isNaN(t.minimumBlockNumberForEmergencySurvey)||t.minimumBlockNumberForEmergencySurvey<1)return n.view.emit("message","You must specify a number greater than 0 to proceed","error");var r=JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getMinimumBlockNumberForEmergencySurvey()").split("type").join("uint256").split("value").join(t.minimumBlockNumberForEmergencySurvey));window.sendGeneratedProposal(n.view.props.element,{title:"Updating Emergency Proposal Length",functionalityName:"getMinimumBlockNumberForEmergencySurvey",functionalitySubmitable:!1,functionalityMethodSignature:"getMinimumBlockNumberForEmergencySurvey()",functionalityReplace:"getMinimumBlockNumberForEmergencySurvey",functionalityOutputParameters:'["uint256"]'},r,undefined,["Emergency Survey Length"],["Emergency Survey Length updated to "+t.minimumBlockNumberForEmergencySurvey+" blocks"])},n.emergencyPenaltyChange=function(t){var r=window.toDecimals(t.emergencySurveyStaking,n.view.props.element.decimals);t.emergencySurveyStaking=parseInt(r);if(t.emergencySurveyStaking===parseInt(n.view.props.element.emergencySurveyStaking))return;if(isNaN(t.emergencySurveyStaking)||t.emergencySurveyStaking<0)return n.view.emit("message","You must specify a number greater or equal to 0 to proceed","error");if(t.emergencySurveyStaking>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var i=JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getEmergencySurveyStaking()").split("type").join("uint256").split("value").join(r));window.sendGeneratedProposal(n.view.props.element,{title:"Updating Emergency Proposal Stake",functionalityName:"getEmergencySurveyStaking",functionalitySubmitable:!1,functionalityMethodSignature:"getEmergencySurveyStaking()",functionalityReplace:"getEmergencySurveyStaking",functionalityOutputParameters:'["uint256"]'},i,undefined,["Emergency Survey Staking"],["Emergency Survey Staking updated to "+window.fromDecimals(t.emergencySurveyStaking,n.view.props.element.decimals)+" Voting Tokens"])},n.quorumChange=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=window.numberToString(e.quorum),i=window.toDecimals(e.quorum,n.view.props.element.decimals),e.quorum=parseInt(i);if(e.quorum!==parseInt(n.view.props.element.quorum)){a.next=5;break}return a.abrupt("return");case 5:if(!(isNaN(e.quorum)||e.quorum<0)){a.next=7;break}return a.abrupt("return",n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error"));case 7:if(!(e.quorum>parseInt(n.view.props.element.totalSupply))){a.next=9;break}return a.abrupt("return",n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error"));case 9:s=["DFO Hub - Utilities - Get Quorum","This functionality returns the quorum value needed to accept a Survey"],o=["Setting quorum value to "+t+" "+n.view.props.element.symbol],!n.view.props.element.quorum&&s.push(o[0]),e.quorum===0&&(o=["Clearing quorum"]),u=e.quorum?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256").split("value").join(i)):undefined,window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:e.quorum?"getQuorum":"",functionalityMethodSignature:e.quorum?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:e.quorum===0||parseInt(n.view.props.element.quorum)?"getQuorum":"",functionalityOutputParameters:e.quorum?'["uint256"]':""},u,undefined,s,o);case 15:case"end":return a.stop()}},r,this)}));return t}(),n.proposalStakeChange=function(t){var r=window.numberToString(t.minimumStaking),i=window.toDecimals(t.minimumStaking,n.view.props.element.decimals);t.minimumStaking=parseInt(i);if(t.minimumStaking===parseInt(n.view.props.element.minimumStaking))return;if(isNaN(t.minimumStaking)||t.minimumStaking<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.minimumStaking>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Proposal Stake","This functionality provides the amount of voting tokens needed to be staked to make a new proposal"],o=["Setting Proposal Stake value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.minimumStaking&&s.push(o[0]),t.minimumStaking===0&&(o=["Clearing Proposal Stake"]);var u=t.minimumStaking?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.minimumStaking?"getMinimumStaking":"",functionalityMethodSignature:t.minimumStaking?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:t.minimumStaking===0||parseInt(n.view.props.element.minimumStaking)?"getMinimumStaking":"",functionalityOutputParameters:t.minimumStaking?'["uint256"]':""},u,undefined,s,o)},n.surveySingleRewardChange=function(t){var r=window.numberToString(t.surveySingleReward),i=window.toDecimals(t.surveySingleReward,n.view.props.element.decimals);t.surveySingleReward=parseInt(i);if(t.surveySingleReward===parseInt(n.view.props.element.surveySingleReward))return;if(isNaN(t.surveySingleReward)||t.surveySingleReward<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.surveySingleReward>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Dev Incentives","This functionality provides the amount of voting tokens needed to be staked to make a new proposal"],o=["Setting Dev Incentives value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.surveySingleReward&&s.push(o[0]),t.surveySingleReward===0&&(o=["Clearing Dev Incentives"]);var u=t.surveySingleReward?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.surveySingleReward?"getSurveySingleReward":"",functionalityMethodSignature:t.surveySingleReward?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:t.surveySingleReward===0||parseInt(n.view.props.element.surveySingleReward)?"getSurveySingleReward":"",functionalityOutputParameters:t.surveySingleReward?'["uint256"]':""},u,undefined,s,o)},n.votesHardCapChange=function(t){var r=window.numberToString(t.votesHardCap),i=window.toDecimals(t.votesHardCap,n.view.props.element.decimals);t.votesHardCap=parseInt(i);if(t.votesHardCap===parseInt(n.view.props.element.votesHardCap))return;if(isNaN(t.votesHardCap)||t.votesHardCap<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.votesHardCap>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Votes Hard Cap",'If a proposal reaches a fixed number of voting tokens (example the 90% of the total Token supply) for "Approve" or "Disapprove" it, the proposal automatically ends, independently from the duration rule.'],o=["Setting Votes Hard Cap value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.votesHardCap&&s.push(o[0]),t.votesHardCap===0&&(o=["Clearing Votes Hard Cap"]);var u=t.votesHardCap?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getVotesHardCap()").split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.votesHardCap?"getVotesHardCap":"",functionalityMethodSignature:t.votesHardCap?"getVotesHardCap()":"",functionalitySubmitable:!1,functionalityReplace:t.votesHardCap===0||parseInt(n.view.props.element.votesHardCap)?"getVotesHardCap":"",functionalityOutputParameters:t.votesHardCap?'["uint256"]':""},u,undefined,s,o)},n.votesHardCapChange=function(t){var r=window.numberToString(t.votesHardCap),i=window.toDecimals(t.votesHardCap,n.view.props.element.decimals);t.votesHardCap=parseInt(i);if(t.votesHardCap===parseInt(n.view.props.element.votesHardCap))return;if(isNaN(t.votesHardCap)||t.votesHardCap<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.votesHardCap>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Votes Hard Cap",'If a proposal reaches a fixed number of voting tokens (example the 90% of the total Token supply) for "Approve" or "Disapprove" it, the proposal automatically ends, independently from the duration rule.'],o=["Setting Votes Hard Cap value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.votesHardCap&&s.push(o[0]),t.votesHardCap===0&&(o=["Clearing Votes Hard Cap"]);var u=t.votesHardCap?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getVotesHardCap()").split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.votesHardCap?"getVotesHardCap":"",functionalityMethodSignature:t.votesHardCap?"getVotesHardCap()":"",functionalitySubmitable:!1,functionalityReplace:t.votesHardCap===0||parseInt(n.view.props.element.votesHardCap)?"getVotesHardCap":"",functionalityOutputParameters:t.votesHardCap?'["uint256"]':""},u,undefined,s,o)},n.checkStakingAndFixedInflaction=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u,a;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:e=e||n.view;if(e.mounted){f.next=3;break}return f.abrupt("return");case 3:if(e.props.element.stateHolder){f.next=5;break}return f.abrupt("return",setTimeout(function(){return n.checkStakingAndFixedInflaction(e)},300));case 5:return f.next=7,window.blockchainCall(e.props.element.stateHolder.methods.getUint256,"fixedInflation.transfers.length");case 7:f.t0=f.sent;if(!(f.t0>0)){f.next=12;break}f.t1="active",f.next=13;break;case 12:f.t1="unset";case 13:return t=f.t1,i="loading",e.setState({fixedInflationStatus:t,liquidityMiningStatus:i}),f.prev=16,f.next=19,window.blockchainCall(e.props.element.stateHolder.methods.toJSON);case 19:s=f.sent;if(e.mounted){f.next=22;break}return f.abrupt("return");case 22:s=JSON.parse(s.endsWith(",]")?s.substring(0,s.lastIndexOf(",]"))+"]":s),f.t2=regeneratorRuntime.keys(s);case 24:if((f.t3=f.t2()).done){f.next=38;break}return o=f.t3.value,u=s[o],a="get"+u.type.substring(0,1).toUpperCase()+u.type.substring(1),f.next=30,window.blockchainCall(e.props.element.stateHolder.methods[a],u.name);case 30:u.value=f.sent,u.name.indexOf("staking.transfer.authorized.")===0&&u.value&&(i="active");if(e.mounted){f.next=34;break}return f.abrupt("return");case 34:if(t!=="active"||i!=="active"){f.next=36;break}return f.abrupt("break",38);case 36:f.next=24;break;case 38:f.next=42;break;case 40:f.prev=40,f.t4=f["catch"](16);case 42:e.setState({fixedInflationStatus:t==="loading"?"unset":t,liquidityMiningStatus:i==="loading"?"unset":i});case 43:case"end":return f.stop()}},r,this,[[16,40]])}));return t}()};var Overview=React.createClass({displayName:"Overview",requiredModules:["spa/editor","spa/dFOMetadata"],requiredScripts:["spa/loaderMini.jsx","spa/okBoomer.jsx","spa/loaderMinimino.jsx"],uploadFile:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget.files[0],r=this,i=new FileReader;i.addEventListener("load",function(){r.indexValue.value=i.result},!1),i.readAsDataURL(n)},changeElementInfo:function(t){if(!t)return;t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=window.getData($($(t.currentTarget).parent()).parent());this.controller[this.state.change+"Change"](n)},componentDidMount:function(){var t=this;delete t.props.element.updating,window.updateInfo(t,t.props.element),this.controller.checkStakingAndFixedInflaction()},renderChangeButton:function(t){var n=this;if(!n.props.edit)return;return React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB"+(n.state&&n.state.change===t?" Editing":""),href:"javascript:;",onClick:function(){return n.setState({change:n.state&&n.state.change===t?null:t})}},"Change")},renderChanger:function(t){var n=this;if(!n.props.edit||!n.state||!n.state.change)return;for(var r in t){var i=t[r];if(n.state.change===i){var s=n["render"+i.substring(0,1).toUpperCase()+i.substring(1)+"Changer"];return React.createElement("section",{className:"DFOFunctionIndexIcon"},s&&s(),React.createElement("aside",null,React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualButtonB",onClick:n.changeElementInfo},"Propose")))}}},renderIndexChanger:function(){var t=this;return React.createElement("ul",null,React.createElement("li",null,React.createElement("p",{className:"GIGIMIO"},'DFOs Front-End is designed to work in two layers, the "Distributed Layer" and the "Decentralized Layer." The Distributed Layer is a version of the Front-End deployed via IPFS or Swarn, for fast and free updates. The Decentralized Layer is a version of the Front-End via On-Chain files, expensive but critical to making a DFO Censorship Resistant. The ENS automatically redirects users to the Distributed Layer and if it\'s Censored to the Decentralized Layer.')),React.createElement("li",null,React.createElement("section",null,React.createElement("a",{href:this.props.element.link?"javascript:;":undefined,className:this.props.element.link?"LinkVisualButton"+(this.state&&this.state.indexShow==="link"?" Editing":""):undefined,onClick:function(){return t.props.element.link&&t.setState({indexShow:t.state&&t.state.indexShow==="link"?null:"link"})}},"Code"),React.createElement("input",{id:"linkCheck",type:"checkbox",className:"DFOFunctionIndexIconSelector",ref:function(n){return t.linkCheck=n},onChange:function(n){t.linkValue.value=t.props.element.link||"",t.linkValue.disabled=!n.currentTarget.checked,t.indexCheck.checked=!1,t.indexFile.disabled=!0}}),React.createElement("label",{htmlFor:"linkCheck"},"Distributed Layer"),React.createElement("input",{className:"DFOFunctionIndexIconText",id:"link",type:"text",placeholder:"Link IPFS Swarm",ref:function(n){return(t.linkValue=n)&&(n.value=t.props.element.link||"")},disabled:!0})),React.createElement("section",null,React.createElement("a",{href:this.props.element.index?"javascript:;":undefined,className:this.props.element.index?"LinkVisualButton"+(this.state&&this.state.indexShow==="index"?" Editing":""):undefined,onClick:function(){return t.props.element.index&&t.props.element.index!=="0"&&t.setState({indexShow:t.state&&t.state.indexShow==="index"?null:"index"})}},"Code"),React.createElement("input",{type:"hidden",id:"index",ref:function(n){return(t.indexValue=n)&&(n.value=t.props.element.index)}}),React.createElement("input",{id:"indexCheck",type:"checkbox",className:"DFOFunctionIndexIconSelector",ref:function(n){return t.indexCheck=n},onChange:function(n){t.indexValue.value=t.props.element.index,t.indexFile.value="",t.indexFile.disabled=!n.currentTarget.checked,t.linkCheck.checked=!1,t.linkValue.disabled=!0}}),React.createElement("label",{htmlFor:"indexCheck"},"Decentralized Layer"),React.createElement("input",{className:"DFOFunctionIndexIconUpload",id:"indexFile",type:"file",accept:".html,.htm",ref:function(n){return t.indexFile=n},disabled:!0,onChange:this.uploadFile}))),this.state&&this.state.indexShow&&React.createElement("section",null,this.state.indexShow==="index"&&React.createElement(Editor,{lang:"html",readonly:"true",first:this.state.indexShow==="index"?this.props.element.index:undefined}),this.state.indexShow==="link"&&React.createElement(Editor,{lang:"html",readonly:"true",link:this.state.indexShow==="link"?this.props.element.link:undefined})))},renderSurveySingleRewardChanger:function(){return this.renderDefaultChanger("The number of Voting Tokens as a reward to the issuer for every single Successful Proposal.","Dev Incentives","surveySingleReward",window.fromDecimals(this.props.element.surveySingleReward,this.props.element.decimals))},renderProposalLengthChanger:function(){return this.renderDefaultChanger("Every survey has a length expressed in Blocks. Here you can set the duration of Surveys for this DFO.","Proposal Length","proposalLength",this.props.element.blocks)},renderEmergencyLengthChanger:function(){return this.renderDefaultChanger("The length in Blocks for Emergency Surveys.","Emergency Length","minimumBlockNumberForEmergencySurvey",this.props.element.minimumBlockNumberForEmergencySurvey)},renderEmergencyPenaltyChanger:function(){return this.renderDefaultChanger("The Fee that Emergency Proposal Issuer must stake to propose it. This stake will be lost if the Proposal fails.","Emergency Penalty","emergencySurveyStaking",window.fromDecimals(this.props.element.emergencySurveyStaking,this.props.element.decimals))},renderQuorumChanger:function(){return this.renderDefaultChanger("The Quorum is a minimum number of Voting Tokens staked in a survey to reach the success status.","Quorum","quorum",window.fromDecimals(this.props.element.quorum,this.props.element.decimals))},renderProposalStakeChanger:function(){return this.renderDefaultChanger("The minimum of Token Stacked needed to create a new Proposal.","Proposal Stake","minimumStaking",window.fromDecimals(this.props.element.minimumStaking,this.props.element.decimals))},renderVotesHardCapChanger:function(){return this.renderDefaultChanger('If a proposal reaches a fixed number of voting tokens (example the 90% of the total Token supply) for "Approve" or "Disapprove" it, the proposal automatically ends, independently from the duration rule.',"Hard Cap","votesHardCap",window.fromDecimals(this.props.element.votesHardCap,this.props.element.decimals))},renderDefaultChanger:function(t,n,r,i){return React.createElement("ul",null,React.createElement("li",null,React.createElement("p",{ref:function(n){return n&&(n.innerHTML=t)}},t)),React.createElement("li",null,React.createElement("section",null,React.createElement("label",{htmlFor:r,ref:function(t){return t&&(t.innerHTML=n)}},n),React.createElement("input",{className:"DFOFunctionIndexIconText",id:r,type:"number",min:"0",ref:function(t){return t&&(t.value=i)}}))))},render:function(){var t=this,n=this;return n.props.element.token?React.createElement("section",{className:"DFOOverview"},React.createElement(DFOMetadata,{element:n.props.element,edit:n.props.edit}),React.createElement("ul",{className:"DFOHosting TheDappInfoX"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Decentralized Application")),React.createElement("li",{className:"TheDappInfo1"},React.createElement("h5",{className:"DFOHostingTitle"},"🙋 Voting Token"),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,n.props.element.symbol&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Ticker: ",React.createElement("b",null,n.props.element.symbol))),React.createElement(AsyncValue,null,n.props.element.name&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Name: ",React.createElement("b",null,n.props.element.name)))),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,n.props.element.symbol&&n.props.element.totalSupply&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Supply: ",React.createElement("b",null,window.fromDecimals(n.props.element.totalSupply,n.props.element.decimals))))),React.createElement("section",{className:"DFOTitleSection"},React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",href:"javascript:;",onClick:function(){return n.emit("section/change","Token")}},"View"),React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"token/"+n.props.element.token.options.address,target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"💎 Etherscan"),React.createElement("a",{href:window.context.uniSwapInfoURL+this.props.element.token.options.address,target:"_blank",className:"LinkVisualButton LinkVisualUni"},"🦄 Info"),React.createElement("a",{href:window.context.uniSwapSwapURLTemplate.format(this.props.element.token.options.address),target:"_blank",className:"LinkVisualButton LinkVisualUni"},"🦄 Swap"),React.createElement("a",{href:window.context.penSwapSwapURLTemplate.format(this.props.element.token.options.address),target:"_blank",className:"LinkVisualButton LinkVisualUni LinkVisualUniPEN"},"🐧 Swap"))),React.createElement("li",{className:"TheDappInfo05"},React.createElement("h5",{className:"DFOHostingTitle"},"🤖 Core:"),React.createElement("section",{className:"DFOTitleSection"},React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",target:"_blank",href:window.getNetworkElement("etherscanURL")+"address/"+n.props.element.dFO.options.address},"💎 Etherscan")),React.createElement("br",null),React.createElement("h5",{className:"DFOHostingTitle"},"👨🏻‍💻 Wallet:"),React.createElement("section",{className:"DFOTitleSection"},React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",href:"javascript:;",onClick:function(){return n.emit("section/change","Wallet")}},"View"),React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",target:"_blank",href:window.getNetworkElement("etherscanURL")+"tokenHoldings?a="+n.props.element.walletAddress},"💎 Etherscan"))),React.createElement("li",{className:"TheDappInfo1 TheDappInfoX"},React.createElement("h5",{className:"DFOHostingTitle"},"🔮 ENS: "),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,n.props.element.ens!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},React.createElement("a",{className:"LinkVisualStandard",target:"_blank",href:"https://"+(n.props.element.ens&&n.props.element.ens.toLowerCase()+"."||"")+"dfohub.eth?ensd="+(n.props.element.ens&&n.props.element.ens.toLowerCase()+"."||"")+"dfohub.eth"},n.props.element.ens&&n.props.element.ens.toLowerCase()+"."||"","dfohub.eth")))),React.createElement("br",null),React.createElement("h5",{className:"DFOHostingTitle"},"📲 Front-end: "),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,React.createElement("a",{className:"LinkVisualButton",href:"javascript:;",onClick:function(){return(n.props.element.link||n.props.element.index)&&t.setState({change:t.state&&t.state.change==="showCode"?null:"showCode"})}},"Code")),n.renderChangeButton("index"))),React.createElement("li",{className:"TheDappInfo05 TheDappInfoX"},React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitle2"},"🛠 DFO Link: "),React.createElement("section",{className:"DFOTitleSection"},React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",target:"_blank",href:window.getHomepageLink("?addr="+this.props.element.dFO.options.address)},"Navigate")),React.createElement("h5",{className:"DFOHostingTitle DFOHostingTitle2"},"🛠 Functions: "),React.createElement("section",{className:"DFOTitleSection"},React.createElement("p",{className:"LinkVisualStandard MiiiiFunctionalities"},React.createElement(AsyncValue,null,n.props.element.functionalitiesAmount)),React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",onClick:function(){return n.emit("section/change","Functions")},href:"javascript:;"},"View All"))),n.renderChanger(["index"]),this.state&&this.state.change==="showCode"&&React.createElement("section",{className:"IndexShowCode"},React.createElement("section",{className:"IndexShowCodeEditorBox"},React.createElement("h5",null,"Distributed Layer"),React.createElement(Editor,{lang:"html",readonly:"true",link:n.props.element.link,firstCode:n.props.element.link?undefined:"Distributed Index is actually unset"})),React.createElement("section",{className:"IndexShowCodeEditorBox"},React.createElement("h5",null,"Decentralized Layer"),React.createElement(Editor,{lang:"html",readonly:"true",first:n.props.element.index,firstCode:n.props.element.index?undefined:"Decentralized Index is actually unset"})))),React.createElement("ul",{className:"DFOHosting TheDappInfoX"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Rules and funds")),React.createElement("li",{className:"TheDappInfo1"},React.createElement("h5",{className:"DFOHostingTitle"},"🏰 Regular Proposals: "),React.createElement("section",{className:"DFOTitleSection"},n.props.element.blocks===undefined&&React.createElement(LoaderMinimino,null),n.props.element.blocks!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Length: ",React.createElement("b",null,n.props.element.blocks),React.createElement("aside",null," Blocks "))),React.createElement("h5",{className:"DFOHostingTitle"},"🚨 Emergency Proposals: "),React.createElement("section",{className:"DFOTitleSection"},n.props.element.minimumBlockNumberForEmergencySurvey===undefined&&React.createElement(LoaderMinimino,null),n.props.element.minimumBlockNumberForEmergencySurvey!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Length: ",React.createElement("b",null,n.props.element.minimumBlockNumberForEmergencySurvey)," ",React.createElement("aside",null,"Blocks")),React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",onClick:function(){return n.emit("section/change","Rules")},href:"javascript:;"},"View All"))),React.createElement("li",{className:"TheDappInfo1"},React.createElement("h5",{className:"DFOHostingTitle"},"🧮 Assets: "),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,n.props.element.symbol&&n.props.element.totalSupply&&n.props.element.communityTokens&&React.createElement("p",{className:"DFOLabelTitleInfo DFOLabelTitleInfoS"},React.createElement("b",null,window.tokenPercentage(n.props.element.communityTokens,n.props.element.totalSupply)),React.createElement("aside",null," (",React.createElement("b",null,window.fromDecimals(n.props.element.communityTokens,n.props.element.decimals))," ",n.props.element.symbol,")")))),React.createElement("section",{className:"DFOTitleSection"},React.createElement("p",{className:"DFOLabelTitleInfo DFOLabelTitleInfoS"},React.createElement("b",null,window.fromDecimals(n.props.element.walletETH,18)),React.createElement("aside",null," ETH"))),React.createElement("section",{className:"DFOTitleSection"},React.createElement("p",{className:"DFOLabelTitleInfo DFOLabelTitleInfoS"},React.createElement("b",null,window.fromDecimals(n.props.element.walletUSDC,6)),React.createElement("aside",null," USDC"))),React.createElement("section",{className:"DFOTitleSection"},React.createElement("p",{className:"DFOLabelTitleInfo DFOLabelTitleInfoS"},React.createElement("b",null,window.fromDecimals(n.props.element.walletDAI,18)),React.createElement("aside",null," DAI"))),n.props.element!==window.dfoHub&&React.createElement("section",{className:"DFOTitleSection"},React.createElement("p",{className:"DFOLabelTitleInfo DFOLabelTitleInfoS"},React.createElement("b",null,window.fromDecimals(n.props.element.walletBUIDL,window.dfoHub.decimals)),React.createElement("aside",null," BUIDL"))),React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",onClick:function(){return n.emit("section/change","Wallet")},href:"javascript:;"},"View All")),React.createElement("li",{className:"TheDappInfo1"},React.createElement("h5",{className:"DFOHostingTitle"},"🖨 Fixed Inflation:"),React.createElement("section",{className:"DFOTitleSection"},this.state&&this.state.fixedInflationStatus==="loading"&&React.createElement(LoaderMinimino,null),this.state&&this.state.fixedInflationStatus==="active"&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Active"),this.state&&this.state.fixedInflationStatus==="unset"&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Not set"),React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",onClick:function(){return n.emit("section/change","Farming")},href:"javascript:;"},"More")),React.createElement("h5",{className:"DFOHostingTitle"},"🦄 Liquidity Mining:"),React.createElement("section",{className:"DFOTitleSection"},this.state&&this.state.liquidityMiningStatus==="loading"&&React.createElement(LoaderMinimino,null),this.state&&this.state.liquidityMiningStatus==="active"&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Active"),this.state&&this.state.liquidityMiningStatus==="unset"&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Not set"),React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",onClick:function(){return n.emit("section/change","Farming")},href:"javascript:;"},"More"))))):React.createElement(LoaderMini,null)}});var ProposalController=function(t){var n=this;n.view=t,n.transferTopic=window.web3.utils.sha3("Transfer(address,address,uint256)"),n.functionalitySetTopic=window.web3.utils.sha3("FunctionalitySet(string,address,string,address,uint256,address,bool,string,bool,bool,address)"),n.refreshVotes=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=this.state.survey;if(window.walletAddress){i.next=5;break}i.t0=["0","0"],i.next=8;break;case 5:return i.next=7,window.blockchainCall(e.contract.methods.getVote,window.walletAddress);case 7:i.t0=i.sent;case 8:t=i.t0,e.myAccepts=window.web3.utils.toBN(t[0]).toString(),e.myRefuses=window.web3.utils.toBN(t[1]).toString(),e.myVotes=window.web3.utils.toBN(t[0]).add(window.web3.utils.toBN(t[1])).toString(),n.view.setState({survey:e});case 13:case"end":return i.stop()}},r,this)}));return t}(),n.loadSurvey=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:e=n.view.props.element;if(!!n.view&&!!n.view.mountDate&&e===n.view.props.element){f.next=3;break}return f.abrupt("return");case 3:t=n.view.mountDate,i={},Object.keys(n.view.state.survey).forEach(function(e){return i[e]=n.view.state.survey[e]}),delete i.withdrawed,f.prev=7;if(i.contract){f.next=18;break}return i.contract=window.newContract(window.context.propsalAbi,i.address),i.contract.data=i,f.next=13,window.blockchainCall(i.contract.methods.toJSON);case 13:s=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=16;break}return f.abrupt("return");case 16:s=JSON.parse(s.split('"returnAbiParametersArray":,').join('"returnAbiParametersArray":[],')),Object.keys(s).forEach(function(e){return i[e]=s[e]});case 18:return f.prev=18,f.t0=window,f.next=22,window.blockchainCall(window.newContract(window.context.IFunctionalityAbi,i.location).methods.getMetadataLink);case 22:f.t1=f.sent,i.metadataLink=f.t0.formatLink.call(f.t0,f.t1);if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=26;break}return f.abrupt("return");case 26:return f.next=28,window.AJAXRequest(i.metadataLink);case 28:i.metadata=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=31;break}return f.abrupt("return");case 31:Object.entries(i.metadata).forEach(function(e){return i[e[0]]=e[1]}),i.description=window.extractHTMLDescription(i.description||i.code,!0),f.next=37;break;case 35:f.prev=35,f.t2=f["catch"](18);case 37:return i.surveyEnd=i.endBlock<=n.view.props.currentBlock+1,f.next=40,window.blockchainCall(i.contract.methods.getVotes);case 40:o=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=43;break}return f.abrupt("return");case 43:i.accepted=window.web3.utils.toBN(o[0]).toString(),i.refused=window.web3.utils.toBN(o[1]).toString(),i.allVotes=window.web3.utils.toBN(o[0]).add(window.web3.utils.toBN(o[1])).toString();if(window.walletAddress){f.next=50;break}f.t3=["0","0"],f.next=53;break;case 50:return f.next=52,window.blockchainCall(i.contract.methods.getVote,window.walletAddress);case 52:f.t3=f.sent;case 53:u=f.t3;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=56;break}return f.abrupt("return");case 56:i.myAccepts=window.web3.utils.toBN(u[0]).toString(),i.myRefuses=window.web3.utils.toBN(u[1]).toString(),i.myVotes=window.web3.utils.toBN(u[0]).add(window.web3.utils.toBN(u[1])).toString();if(!!i.surveyEnd&&!!i.terminationData){f.next=75;break}return i.leading=!1,f.prev=61,f.next=64,window.blockchainCall(e.dFO.methods.read,"checkSurveyResult",window.web3.eth.abi.encodeParameter("address",i.address));case 64:i.leading=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=67;break}return f.abrupt("return");case 67:return i.leading=window.web3.eth.abi.decodeParameter("bool",i.leading),f.next=70,window.blockchainCall(i.contract.methods.isVotesHardCapReached);case 70:i.hardCapReached=f.sent,f.next=75;break;case 73:f.prev=73,f.t4=f["catch"](61);case 75:if(!(i.checkedTimes>0)){f.next=88;break}i.terminationData&&(i.terminationTransactionHash=i.terminationData.transactionHash),i.terminationData&&(i.result=window.web3.eth.abi.decodeParameter("bool",i.terminationData.data)),i.terminationData&&(i.resultBlock=i.terminationData.blockNumber);if(!(i.withdrawed===undefined&&parseInt(i.myVotes)>0)){f.next=88;break}i.withdrawed=!0;if(!window.walletAddress||i.raisedBy!==e.dFO.options.address.toLowerCase()){f.next=88;break}return f.next=84,window.getLogs({address:e.token.options.address,topics:[n.transferTopic,window.web3.eth.abi.encodeParameter("address",i.address),window.web3.eth.abi.encodeParameter("address",window.walletAddress)],fromBlock:i.startBlock});case 84:a=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=87;break}return f.abrupt("return");case 87:i.withdrawed=a.length>0;case 88:n.view.setState({survey:i});if(!i.codeName&&!!i.replaces||!!i.code){f.next=103;break}return f.prev=90,f.next=93,window.loadContent(i.sourceLocationId,i.sourceLocation);case 93:i.code=f.sent,i.codeName!=="getEmergencySurveyStaking"&&i.sourceLocationId===0&&delete i.code,f.next=99;break;case 97:f.prev=97,f.t5=f["catch"](90);case 99:if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=101;break}return f.abrupt("return");case 101:i.description=window.extractHTMLDescription(i.code,!0),n.view.setState({survey:i});case 103:if(i.compareErrors){f.next=116;break}return f.next=106,window.searchForCodeErrors(i.location,i.code,i.codeName,i.methodSignature,i.replaces,!0);case 106:i.compareErrors=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=109;break}return f.abrupt("return");case 109:return n.view.setState({survey:i}),f.next=112,window.searchForCodeErrors(i.location,i.code,i.codeName,i.methodSignature,i.replaces);case 112:i.compareErrors=f.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){f.next=115;break}return f.abrupt("return");case 115:n.view.setState({survey:i});case 116:f.next=121;break;case 118:f.prev=118,f.t6=f["catch"](7),console.error(f.t6);case 121:case"end":return f.stop()}},r,this,[[7,118],[18,35],[61,73],[90,97]])}));return t}(),n.tryLoadDiff=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a,f,l,c,h,p,d;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:e=n.view.props.element;if(!!n.view&&!!n.view.mountDate&&e===n.view.props.element){v.next=3;break}return v.abrupt("return");case 3:t=n.view.mountDate,i={},Object.keys(n.view.state.survey).forEach(function(e){return i[e]=n.view.state.survey[e]});if(!!i.replaces&&i.replacesCode===undefined){v.next=8;break}return v.abrupt("return");case 8:v.prev=8,s=i.replacedCodeSourceLocationId,o=i.replacedCodeSourceLocation;if(i.terminated){v.next=21;break}return v.next=14,window.blockchainCall(n.view.props.element.functionalitiesManager.methods.getFunctionalityData,i.replaces);case 14:u=v.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){v.next=17;break}return v.abrupt("return");case 17:o=u[3],s=u[4],v.next=46;break;case 21:return v.next=23,window.web3.eth.getTransactionReceipt(i.terminationTransactionHash);case 23:a=v.sent;if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){v.next=26;break}return v.abrupt("return");case 26:f=a.logs,l=Array.isArray(f),c=0,f=l?f:f[Symbol.iterator]();case 27:if(!l){v.next=33;break}if(!(c>=f.length)){v.next=30;break}return v.abrupt("break",46);case 30:h=f[c++],v.next=37;break;case 33:c=f.next();if(!c.done){v.next=36;break}return v.abrupt("break",46);case 36:h=c.value;case 37:p=h;if(p.topics[0].toLowerCase()===n.functionalitySetTopic.toLowerCase()){v.next=40;break}return v.abrupt("continue",44);case 40:return d=window.web3.eth.abi.decodeParameters(["string","string","address","uint256","bool","string","bool","bool"],p.data),o=d[2],s=d[3],v.abrupt("break",46);case 44:v.next=27;break;case 46:return v.prev=46,v.next=49,window.loadContent(s,o);case 49:i.replacesCode=v.sent,v.next=55;break;case 52:v.prev=52,v.t0=v["catch"](46),i.replacesCode=null;case 55:if(!!n.view&&n.view.mountDate===t&&e===n.view.props.element){v.next=57;break}return v.abrupt("return");case 57:n.view.setState({survey:i}),v.next=63;break;case 60:v.prev=60,v.t1=v["catch"](8),console.error(v.t1);case 63:case"end":return v.stop()}},r,this,[[8,60],[46,52]])}));return t}(),n.interact=function(){function t(t,n,r,i){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i,s){var o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:o=e.contract.methods[t==="Withdraw All"?"retireAll":t==="Vote"?i.toLowerCase():t.toLowerCase().split("switch").join("moveTo").split("withdraw").join("retire")+i],n.view.emit("message","Performing "+t+"...");if(t!=="Withdraw All"){u.next=7;break}return u.next=5,window.blockchainCall(o);case 5:u.next=9;break;case 7:return u.next=9,window.blockchainCall(o,s);case 9:n.view.emit("message","Operation completed!"),n.view.emit("element/update",n.view.props.element),n.loadSurvey(),n.view.emit("surveys/refresh"),n.view.emit("balances/refresh",n.view.props.element);case 14:case"end":return u.stop()}},r,this)}));return t}(),n.finalize=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,i=$(e.currentTarget),s=$('<section class="loaderMinimino"/>').insertAfter(i.hide()),n.view.emit("message","Finalizing Survey..."),o.next=6,window.blockchainCall(t.contract.methods.terminate);case 6:n.view.emit("message","Survey Finalized! Enjoy Your Brand new Functionality! &#128526;"),n.view.emit("element/update",n.view.props.element),n.loadSurvey(),n.view.emit("surveys/refresh"),n.view.emit("balances/refresh",n.view.props.element),o.next=16;break;case 13:o.prev=13,o.t0=o["catch"](0),n.view.emit("message",o.t0.message||o.t0,"error");case 16:s.remove(),i.show();case 18:case"end":return o.stop()}},r,this,[[0,13]])}));return t}(),n.withdraw=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u,a;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(window.walletAddress){f.next=2;break}return f.abrupt("return");case 2:i=n.view.props.element,s=!1;if(!t.raisedBy!==i.dFO.options.address.toLowerCase()){f.next=6;break}return f.abrupt("return",alert("This proposal was made using an older version of this DFO's core and cannot be withdrawn any more"));case 6:return f.prev=6,f.next=9,window.getLogs({address:i.token.options.address,topics:[n.transferTopic,window.web3.eth.abi.encodeParameter("address",t.address),window.web3.eth.abi.encodeParameter("address",window.walletAddress)],fromBlock:t.startBlock});case 9:o=f.sent,s=o.length>0,f.next=15;break;case 13:f.prev=13,f.t0=f["catch"](6);case 15:if(!s){f.next=17;break}return f.abrupt("return",alert("You already withdrawn your tokens"));case 17:return f.prev=17,u=$(e.currentTarget),a=$('<section class="loaderMinimino"/>').insertAfter(u.hide()),n.view.emit("message","Withdrawing..."),f.next=23,window.blockchainCall(t.contract.methods.withdraw);case 23:n.view.emit("message","Operation completed!"),n.view.emit("element/update",n.view.props.element),n.loadSurvey(),n.view.emit("surveys/refresh"),n.view.emit("balances/refresh",n.view.props.element),f.next=33;break;case 30:f.prev=30,f.t1=f["catch"](17),n.view.emit("message",f.t1.message||f.t1,"error");case 33:a.remove(),u.show();case 35:case"end":return f.stop()}},r,this,[[6,13],[17,30]])}));return t}()};var Proposal=React.createClass({displayName:"Proposal",requiredModules:["spa/editor"],requiredScripts:["spa/loaderMinimino.jsx"],getInitialState:function(){return{survey:this.props.survey}},getDefaultSubscriptions:function(){return{"ethereum/ping":this.componentDidMount}},switchRef:function(t){this.switch=t;var n=this;n.switch&&(n.switch.onchange=function(e){e&&e.preventDefault(!0)&&e.stopPropagation(!0),n.switchFrom.innerHTML="&#99"+(n.switch.value==="Refuse"?"89":"40")+";"})},componentDidMount:function(){this.mountDate=(new Date).getTime()+"_"+Math.random(),this.controller.loadSurvey()},componentWillUnmount:function(){delete this.mountDate},interact:function(t,n){this.emit("message",""),t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var r=$(t.currentTarget),i=$('<section class="loaderMinimino"/>').insertAfter(r.hide()),s=r.html(),o=r.parents("section"),u=undefined,a=undefined,f=function(){return i.remove(),r.show(),!0};try{if(o.children("input").length>0){u=parseFloat(o.children("input").val()),a=o.children("select").val();if(isNaN(u)||u<=0)return f()&&this.emit("message","Insert a valid amount greater than zero to proceed","error")}}catch(t){}var l=this;this.controller.interact(n,s,a,window.toDecimals(u,this.props.element.decimals)).then(f).catch(function(e){return f()&&l.emit("message",e.message||e,"error")})},renderTerminated:function(t,n){var r=this,i=r.state.survey,s=[React.createElement("section",{className:"ProposalPool"},React.createElement("h6",null,(i.result||i.leading)&&React.createElement("span",null,"✅ Accepted")," ",!i.result&&!i.leading&&React.createElement("span",null,"⛔ Refused")),React.createElement("p",null,!i.resultBlock&&"Last Checked ","Block: ",React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"block/"+(i.resultBlock||i.lastCheckedBlock),target:"_blank"},i.resultBlock||i.lastCheckedBlock)),React.createElement("p",null,"Total Votes: ",window.fromDecimals(i.allVotes,r.props.element.decimals)," ",r.props.element.symbol),!i.withdrawed&&React.createElement("p",{className:"AllRed"},"To Withdraw: ",window.fromDecimals(i.myVotes,r.props.element.decimals)," ",r.props.element.symbol),React.createElement("section",null,(i.surveyEnd||i.hardCapReached)&&!i.terminationData&&React.createElement("section",{className:"MutoStai"},React.createElement("p",null,"Sometime Web 3 providers can't estimate correctly the Max Gas needed for complex transactions. Finalizing a Proposal, you execute the code in the EVM, be sure to add the right Max Gas required for its execution. Do it at your own risk. ",React.createElement("a",{href:"https://blockgeeks.com/guides/ethereum-gas/"},"More")),React.createElement(WalletEnablerButton,{className:"LinkVisualButton LinkVisualButtonB ProposalPoolWithdraw",onClick:function(t){return r.controller.finalize(t,i)}},"Finalize")),i.terminationData&&parseInt(i.myVotes)>0&&React.createElement(WalletEnablerButton,{className:"LinkVisualButton ProposalPoolWithdraw",onClick:function(t){return r.controller.withdraw(t,i)}},"Withdraw All"),React.createElement("a",{className:"LinkVisualButton"+(r.props.toggle==="info_"+i.key?" Editing":""),href:"javascript:;",onClick:function(){return r.emit("toggle",r.props.toggle==="info_"+i.key?null:"info_"+i.key)}},"Info"),(i.code||i.replacesCode)&&React.createElement("a",{className:"LinkVisualButton"+(r.props.toggle==="code_"+i.key?" Editing":""),href:"javascript:;",onClick:function(){return r.controller.tryLoadDiff().then(function(){return r.emit("toggle",r.props.toggle==="code_"+i.key?null:"code_"+i.key)})}},"Code")),React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"address/"+i.address,target:"_blank"},"Proposal"),React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"address/"+i.location,target:"_blank"},"Contract"))];return r.props.toggle==="info_"+i.key&&s.push(React.createElement("section",{className:"ProposalVote"},React.createElement("section",{className:"ProposalVoteINFO"},React.createElement("section",{className:"ProposalVoteToken"},React.createElement("h6",null,"Results by Token:"),React.createElement("section",{className:"ProposalPoolReview"},React.createElement("section",{className:"ProposalPoolReviewEm"},React.createElement("p",null,"✅")),React.createElement("section",{className:"ProposalPoolReviewPercentage"},React.createElement("p",{className:"ProposalPoolReviewPercentageY",style:{width:t}},t))),React.createElement("p",null,window.fromDecimals(i.accepted,r.props.element.decimals)," ",r.props.element.symbol),React.createElement("section",{className:"ProposalPoolReview"},React.createElement("section",{className:"ProposalPoolReviewEm"},React.createElement("p",null,"⛔")),React.createElement("section",{className:"ProposalPoolReviewPercentage"},React.createElement("p",{className:"ProposalPoolReviewPercentageN",style:{width:n}},n))),React.createElement("p",null,window.fromDecimals(i.refused,r.props.element.decimals)," ",r.props.element.symbol))))),s},renderRunning:function(t,n){var r=this,i=r.state.survey,s=[React.createElement("section",{className:"ProposalAction ProposalPool"},React.createElement("p",null,"Leading: ",i.leading&&React.createElement("span",null,"✅"),!i.leading&&React.createElement("span",null,"⛔")),React.createElement("p",null,"End Block:",React.createElement("a",{target:"_blank",href:window.getNetworkElement("etherscanURL")+"block/"+i.endBlock},i.endBlock)),!i.surveyEnd&&React.createElement(WalletEnablerButton,{className:"LinkVisualButton LinkVisualButtonB"+(r.state&&r.state.toggle==="vote_"+i.key?" Editing":""),onClick:function(){return r.emit("toggle",r.props.toggle==="vote_"+i.key?null:"vote_"+i.key)}},"Vote"),(i.code||i.replacesCode)&&React.createElement("a",{className:"LinkVisualButton"+(r.props.toggle==="code_"+i.key?" Editing":""),href:"javascript:;",onClick:function(){return r.controller.tryLoadDiff().then(function(){return r.emit("toggle",r.props.toggle==="code_"+i.key?null:"code_"+i.key)})}},"Code"),React.createElement("br",null),React.createElement("br",null),React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"address/"+i.address,target:"_blank"},"Proposal"),React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"address/"+i.location,target:"_blank"},"Contract"),i.surveyEnd&&!i.terminated&&React.createElement("section",{className:"MutoStai"},React.createElement("p",null,"Sometime Web 3 providers can't estimate correctly the Max Gas needed for complex transactions. Finalizing a Proposal, you execute the code in the EVM, be sure to add the right Max Gas required for its execution. Do it at your own risk. ",React.createElement("a",{href:"https://blockgeeks.com/guides/ethereum-gas/"},"More")),React.createElement(WalletEnablerButton,{className:"LinkVisualButton LinkVisualButtonB ProposalPoolWithdraw",onClick:function(t){return r.controller.finalize(t,i)}},"Finalize")))];return r.props.toggle==="vote_"+i.key&&s.push(React.createElement("section",{className:"ProposalVote"},React.createElement("section",{className:"ProposalVoteINFO"},React.createElement("section",{className:"ProposalVoteToken"},React.createElement("h6",null,"Status by Token:"),React.createElement("section",{className:"ProposalPoolReview"},React.createElement("section",{className:"ProposalPoolReviewEm"},React.createElement("p",null,"✅")),React.createElement("section",{className:"ProposalPoolReviewPercentage"},React.createElement("p",{className:"ProposalPoolReviewPercentageY",style:{width:t}},t))),React.createElement("p",null,window.fromDecimals(i.accepted,r.props.element.decimals)," ",r.props.element.symbol),React.createElement("section",{className:"ProposalPoolReview"},React.createElement("section",{className:"ProposalPoolReviewEm"},React.createElement("p",null,"⛔")),React.createElement("section",{className:"ProposalPoolReviewPercentage"},React.createElement("p",{className:"ProposalPoolReviewPercentageN",style:{width:n}},n))),React.createElement("p",null,window.fromDecimals(i.refused,r.props.element.decimals)," ",r.props.element.symbol)),React.createElement("section",{className:"ProposalVoteBalances"},React.createElement("h6",null,"Available Balance"),React.createElement("p",null,window.fromDecimals(r.props.myBalance,r.props.element.decimals)," ",r.props.element.symbol),React.createElement("h6",null,"Staked Balance"),React.createElement("p",null,"✅ | ",window.fromDecimals(i.myAccepts,r.props.element.decimals)," ",r.props.element.symbol),React.createElement("p",null,"⛔ | ",window.fromDecimals(i.myRefuses,r.props.element.decimals)," ",r.props.element.symbol))),React.createElement("section",{className:"ProposalVoteVoting"},React.createElement("section",{className:"ProposalVoteVotingNew"},React.createElement("p",null,"Vote to"),React.createElement("select",null,React.createElement("option",{value:"Accept"},"✅ Accept"),React.createElement("option",{value:"Refuse"},"⛔ Refuse")),React.createElement("input",{type:"number",min:"1",placeholder:"Amount"}),React.createElement("a",{className:"LinkVisualButton",href:"javascript:;",onClick:function(t){return r.interact(t,i)}},"Vote")),React.createElement("section",{className:"ProposalVoteVotingExit"},React.createElement("p",null,"Withdraw From"),React.createElement("select",null,React.createElement("option",{value:"Accept"},"✅"),React.createElement("option",{value:"Refuse"},"⛔")),React.createElement("input",{type:"number",min:"1",placeholder:"Amount"}),React.createElement("a",{className:"LinkVisualButton",href:"javascript:;",onClick:function(t){return r.interact(t,i)}},"Withdraw")),React.createElement("section",{className:"ProposalVoteVotingExit"},React.createElement("a",{className:"LinkVisualButton",href:"javascript:;",onClick:function(t){return r.interact(t,i)}},"Withdraw All")),React.createElement("section",{className:"ProposalVoteVotingExit TheDappInfoX"},React.createElement("p",null,"Switch To"),React.createElement("select",{ref:r.switchRef},React.createElement("option",{value:"Accept"},"✅"),React.createElement("option",{value:"Refuse"},"⛔")),React.createElement("p",null,"from ",React.createElement("span",{ref:function(t){return r.switchFrom=t}},"⛔")),React.createElement("input",{type:"number",min:"1",placeholder:"Amount"}),React.createElement("a",{className:"LinkVisualButton",href:"javascript:;",onClick:function(t){return r.interact(t,i)}},"Switch"))))),s},render:function(){if(!this.state.survey.hasOwnProperty("codeName"))return React.createElement("span",{style:{display:"none"}});var t=this,n=t.state.survey,r=n.description||"",i=r.length>window.descriptionWordLimit?window.descriptionWordLimit:r.length,s=t.props.toggle==="more_"+n.key,o=parseInt(n.accepted)/n.allVotes*100;o=(isNaN(o)?0:o)+"%";var u=parseInt(n.refused)/n.allVotes*100;u=(isNaN(u)?0:u)+"%";var a=[React.createElement("section",{className:"ProposalBio"},React.createElement("h5",null,n.emergency&&React.createElement("span",null,"🚨"," "),n.compareErrors===undefined&&React.createElement(LoaderMinimino,null),n.compareErrors&&n.compareErrors.length>0&&React.createElement("span",{title:(n.compareErrors[0].indexOf("data not available")!==-1?"":"There are some problems in this proposal:\n")+n.compareErrors.join(";\n").trim()},"☣️")," ",n.codeName?n.replaces?"Edit":"Add New":n.replaces?"Kill":"One Time",(n.codeName||n.replaces)&&[React.createElement("span",null," | "),React.createElement("span",null,n.codeName||n.replaces)]),React.createElement("p",null,React.createElement("span",{ref:function(t){return t&&(t.innerHTML=r.substring(0,s?r.length:i))}}),!s&&i<r.length&&["... ",React.createElement("a",{href:"javascript:;",onClick:function(){return t.emit("toggle","more_"+n.key)}},"More")],s&&i<r.length&&[" ",React.createElement("a",{href:"javascript:;",onClick:function(){return t.emit("toggle",null)}},"Less")]))];return a.push((n.checkedTimes>0?this.renderTerminated:this.renderRunning)(o,u)),t.props.toggle==="code_"+n.key&&a.push(React.createElement("section",{className:"AllViewCode"},React.createElement("section",{className:"AllViewCodeEditor"},React.createElement(Editor,{className:"AllViewCode",firstCode:n.replacesCode||n.code,secondCode:n.replacesCode&&n.code||undefined})))),a}});var ProposalsController=function(t){var n=this;n.view=t,n.proposalTopic=window.web3.utils.sha3("Proposal(address)"),n.proposalCheckedTopic=window.web3.utils.sha3("ProposalCheck(address)"),n.proposalSetTopic=window.web3.utils.sha3("ProposalSet(address,bool)"),n.blockLimit=4e4,n.updateBalance=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n.view;if(window.walletAddress){t.next=5;break}t.t1="0",t.next=8;break;case 5:return t.next=7,window.blockchainCall(n.view.props.element.token.methods.balanceOf,window.walletAddress);case 7:t.t1=t.sent;case 8:t.t2=t.t1,t.t3={myBalance:t.t2},t.t0.setState.call(t.t0,t.t3);case 11:case"end":return t.stop()}},r,this)}));return t}(),n.loadSurveys=function(){function t(t,n,r,i,s,o){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i,s,o,u){var a,f,l,c;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!!n.view&&!!n.view.mountDate){h.next=2;break}return h.abrupt("return");case 2:a=n.view.mountDate,e||(n.loading=!0,n.view.setState({surveys:null,terminatedSurveys:null})),e=e||n.view.props.element;if(e===n.view.props.element){h.next=7;break}return h.abrupt("return");case 7:if(!!s&&!!o){h.next=29;break}if(!s&&!!window.walletAddress){h.next=12;break}h.t0="0",h.next=15;break;case 12:return h.next=14,window.blockchainCall(e.token.methods.balanceOf,window.walletAddress);case 14:h.t0=h.sent;case 15:s=h.t0;if(!!n.view&&n.view.mountDate===a&&e===n.view.props.element){h.next=18;break}return h.abrupt("return");case 18:h.t1=o;if(h.t1){h.next=25;break}return h.t2=parseInt,h.next=23,window.web3.eth.getBlockNumber();case 23:h.t3=h.sent,h.t1=(0,h.t2)(h.t3);case 25:o=h.t1;if(!!n.view&&n.view.mountDate===a&&e===n.view.props.element){h.next=28;break}return h.abrupt("return");case 28:n.view.setState({myBalance:s,currentBlock:o});case 29:t=t||{},i=i||{},u=u||o;if(!(u<=e.startBlock)){h.next=35;break}return delete n.loading,h.abrupt("return",n.view.setState({surveys:t,terminatedSurveys:i}));case 35:return h.prev=35,f=u-n.blockLimit,f=f<e.startBlock?e.startBlock:f,h.next=40,window.getLogs({address:e.dFO.options.allAddresses,topics:[n.proposalTopic],fromBlock:f,toBlock:u});case 40:l=h.sent;if(!!n.view&&n.view.mountDate===a&&e===n.view.props.element){h.next=43;break}return h.abrupt("return");case 43:c=l.length-1;case 44:if(!(c>=0)){h.next=53;break}return h.next=47,n.loadSurvey(e,l[c],o,t,i,a);case 47:if(!!n.view&&n.view.mountDate===a&&e===n.view.props.element){h.next=49;break}return h.abrupt("return");case 49:n.view.setState({surveys:n.loading&&(!t||Object.keys(t).length===0)?null:t,terminatedSurveys:n.loading&&(!i||Object.keys(i).length===0)?null:i});case 50:c--,h.next=44;break;case 53:return h.abrupt("return",n.loadSurveys(e,t,i,s,o,f));case 56:h.prev=56,h.t4=h["catch"](35),n.view.emit("message",h.t4.message||h.t4,"error");case 59:case"end":return h.stop()}},r,this,[[35,56]])}));return t}(),n.loadSurvey=function(){function t(t,n,r,i,s,o){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i,s,o,u){var a,f,l,c,h;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:p.prev=0;if(!!n.view&&n.view.mountDate===u&&e===n.view.props.element){p.next=3;break}return p.abrupt("return");case 3:a=window.web3.eth.abi.decodeParameter("address",t.data);if(!!a&&a!==window.voidEthereumAddress){p.next=6;break}return p.abrupt("return");case 6:return f=t.blockNumber+"_"+t.id,l=s[f]||o[f]||{},delete s[f],delete o[f],l.key=f,l.id=t.id,l.raisedBy=t.address.toLowerCase(),l.address=a,l.startBlock=t.blockNumber,p.next=17,window.getLogs({address:e.dFO.options.allAddresses,topics:[n.proposalSetTopic,window.web3.eth.abi.encodeParameter("address",l.address)],fromBlock:e.startBlock,toBlock:i});case 17:c=p.sent;if(!!n.view&&n.view.mountDate===u&&e===n.view.props.element){p.next=20;break}return p.abrupt("return");case 20:return l.terminated=(l.checkedTimes=c.length)>0,c.length>0&&(l.terminationData=c[0]),p.next=24,window.getLogs({address:e.dFO.options.allAddresses,topics:[n.proposalCheckedTopic,window.web3.eth.abi.encodeParameter("address",l.address)],fromBlock:e.startBlock,toBlock:i});case 24:h=p.sent;if(!!n.view&&n.view.mountDate===u&&e===n.view.props.element){p.next=27;break}return p.abrupt("return");case 27:return l.checkedTimes=h.length,h.length>0&&(l.lastCheckedBlock=h[h.length-1].blockNumber),!l.checkedTimes&&l.terminated&&(l.checkedTimes=1),p.abrupt("return",(l.checkedTimes?o:s)[f]=l);case 33:p.prev=33,p.t0=p["catch"](0),console.error(p.t0);case 36:case"end":return p.stop()}},r,this,[[0,33]])}));return t}()};var Proposals=React.createClass({displayName:"Proposals",requiredModules:["spa/proposal"],requiredScripts:["spa/loaderMini.jsx"],getDefaultSubscriptions:function(){var t=this;return{"surveys/refresh":function(){return t.controller.loadSurveys(t.props.element,t.state.surveys,t.state.terminatedSurveys)},toggle:function(n){return t.setState({toggle:n})},"ethereum/ping":this.controller.updateBalance}},componentDidMount:function(){this.mountDate=(new Date).getTime()+"_"+Math.random(),this.controller.loadSurveys()},componentWillUnmount:function(){delete this.controller.loading,delete this.mountDate},sortSurveys:function(t){return Object.values(t).sort(function(e,t){var n=parseInt(e.key.substring(0,e.key.indexOf("_"))),r=t?parseInt(t.key.substring(0,t.key.indexOf("_"))):0;return n<r?1:n>r?-1:0})},render:function(){var t=this;return React.createElement("section",{className:"ProposalsIndex"},React.createElement("section",{className:"ProposalsActiveIndex"},React.createElement("h2",null,"Active Proposals"),t.state&&t.state.surveys&&Object.keys(t.state.surveys).length===0&&React.createElement("span",null,"No active proposals right now"),React.createElement("ul",null,t.state&&t.state.surveys&&t.sortSurveys(t.state.surveys).map(function(e){return React.createElement("li",{key:e.key},React.createElement(Proposal,{toggle:t.state.toggle,newController:!0,element:t.props.element,survey:e,myBalance:t.state.myBalance,currentBlock:t.state.currentBlock}))})),(!t.controller||t.controller.loading)&&React.createElement(LoaderMini,{message:"Loading Active Proposals"})),React.createElement("section",{className:"ProposalsOldIndex"},React.createElement("h2",null,"Proposals History"),t.state&&t.state.terminatedSurveys&&Object.keys(t.state.terminatedSurveys).length===0&&React.createElement("span",null,"No Proposal History right now"),React.createElement("ul",null,t.state&&t.state.terminatedSurveys&&t.sortSurveys(t.state.terminatedSurveys).map(function(e){return React.createElement("li",{key:e.key},React.createElement(Proposal,{toggle:t.state.toggle,newController:!0,element:t.props.element,survey:e,myBalance:t.state.myBalance,currentBlock:t.state.currentBlock}))})),(!t.controller||t.controller.loading)&&React.createElement(LoaderMini,{message:"Loading Proposals History"})))}});var RulesController=function(t){var n=this;n.view=t,n.indexChange=function(t){t.index=t.index||0,t.link=t.link||"";if(!t.indexFile&&!t.link)return n.view.emit("message","You must specify an index or a Link to proceed","error");if(t.index===n.view.props.element.index&&t.link===n.view.props.element.link)return;t.linkCheck&&n.changeDistributed(t),t.indexCheck&&n.changeDecentralized(t)},n.changeDistributed=function(t){if(t.link!==n.view.props.element.link&&!(new RegExp(window.urlRegex)).test(t.link))return n.view.emit("message","Inserted link is not a valid URL","error");var r=["DFO Hub - Utilities - Get Distributed Index","This functionality provides the link page which locates the DFO"],i=["Setting Distributed Index value to "+t.link];!n.view.props.element.link&&r.push(i[0]),t.link||(i=["Clearing Distributed Index"]);var s=t.link?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("string memory").split("value").join('\\"'+t.link+'\\"')):undefined;window.sendGeneratedProposal(n.view.props.element,{title:i[0],functionalityName:t.link?"getLink":"",functionalityMethodSignature:t.link?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:t.link&&n.view.props.element.link?"getLink":"",functionalityOutputParameters:t.link?'["string"]':""},s,undefined,r,i)},n.changeDecentralized=function(t){var r=["DFO Hub - Utilities - Get Decentralized Index","This functionality provides the Base64 index containing the Decentralized Index page representing this DFO"],i=["Setting Decentralized Index value"];t.index||(i=["Clearing Decentralized Index"]);var s=t.index?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256")):undefined,o=isNaN(t.index)?window.split(t.index):undefined;window.sendGeneratedProposal(n.view.props.element,{title:i[0],functionalityName:t.index?"getIndex":"",functionalityMethodSignature:t.index?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:!t.index||n.view.props.element.index?"getIndex":"",functionalityOutputParameters:t.index?'["uint256"]':"",sequentialOps:o&&[{name:"Minting Index page ("+o.length+" Txns)",call:function(t){return _asyncToGenerator(regeneratorRuntime.mark(function s(){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,window.mint(o);case 2:t.index=s.sent,t.updates=["Setting Decentralized Index value to "+t.index],!n.view.props.element.index&&r.push(i[0]),t.template=JSON.parse(JSON.stringify(t.template).split("value").join(window.numberToString(t.index)));case 6:case"end":return s.stop()}},s,this)}))()}}]},s,undefined,r,i)},n.proposalLengthChange=function(t){if(t.proposalLength===parseInt(n.view.props.element.blocks))return;if(!t.proposalLength||isNaN(t.proposalLength)||t.proposalLength<1)return n.view.emit("message","You must specify a number greater than 0 to proceed","error");var r=JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getMinimumBlockNumberForSurvey()").split("type").join("uint256").split("value").join(t.proposalLength));window.sendGeneratedProposal(n.view.props.element,{title:"Updating Proposal Length",functionalityName:"getMinimumBlockNumberForSurvey",functionalitySubmitable:!1,functionalityMethodSignature:"getMinimumBlockNumberForSurvey()",functionalityReplace:"getMinimumBlockNumberForSurvey",functionalityOutputParameters:'["uint256"]'},r,undefined,["Survey Length"],["Survey Length updated to "+t.proposalLength+" blocks"])},n.emergencyLengthChange=function(t){if(t.minimumBlockNumberForEmergencySurvey===parseInt(n.view.props.element.minimumBlockNumberForEmergencySurvey))return;if(!t.minimumBlockNumberForEmergencySurvey||isNaN(t.minimumBlockNumberForEmergencySurvey)||t.minimumBlockNumberForEmergencySurvey<1)return n.view.emit("message","You must specify a number greater than 0 to proceed","error");var r=JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getMinimumBlockNumberForEmergencySurvey()").split("type").join("uint256").split("value").join(t.minimumBlockNumberForEmergencySurvey));window.sendGeneratedProposal(n.view.props.element,{title:"Updating Emergency Proposal Length",functionalityName:"getMinimumBlockNumberForEmergencySurvey",functionalitySubmitable:!1,functionalityMethodSignature:"getMinimumBlockNumberForEmergencySurvey()",functionalityReplace:"getMinimumBlockNumberForEmergencySurvey",functionalityOutputParameters:'["uint256"]'},r,undefined,["Emergency Survey Length"],["Emergency Survey Length updated to "+t.minimumBlockNumberForEmergencySurvey+" blocks"])},n.emergencyPenaltyChange=function(t){var r=window.toDecimals(t.emergencySurveyStaking,n.view.props.element.decimals);t.emergencySurveyStaking=parseInt(r);if(t.emergencySurveyStaking===parseInt(n.view.props.element.emergencySurveyStaking))return;if(isNaN(t.emergencySurveyStaking)||t.emergencySurveyStaking<0)return n.view.emit("message","You must specify a number greater or equal to 0 to proceed","error");if(t.emergencySurveyStaking>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var i=JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getEmergencySurveyStaking()").split("type").join("uint256").split("value").join(r));window.sendGeneratedProposal(n.view.props.element,{title:"Updating Emergency Proposal Stake",functionalityName:"getEmergencySurveyStaking",functionalitySubmitable:!1,functionalityMethodSignature:"getEmergencySurveyStaking()",functionalityReplace:"getEmergencySurveyStaking",functionalityOutputParameters:'["uint256"]'},i,undefined,["Emergency Survey Staking"],["Emergency Survey Staking updated to "+window.fromDecimals(t.emergencySurveyStaking,n.view.props.element.decimals)+" Voting Tokens"])},n.quorumChange=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=window.numberToString(e.quorum),i=window.toDecimals(e.quorum,n.view.props.element.decimals),e.quorum=parseInt(i);if(e.quorum!==parseInt(n.view.props.element.quorum)){a.next=5;break}return a.abrupt("return");case 5:if(!(isNaN(e.quorum)||e.quorum<0)){a.next=7;break}return a.abrupt("return",n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error"));case 7:if(!(e.quorum>parseInt(n.view.props.element.totalSupply))){a.next=9;break}return a.abrupt("return",n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error"));case 9:s=["DFO Hub - Utilities - Get Quorum","This functionality returns the quorum value needed to accept a Survey"],o=["Setting quorum value to "+t+" "+n.view.props.element.symbol],!n.view.props.element.quorum&&s.push(o[0]),e.quorum===0&&(o=["Clearing quorum"]),u=e.quorum?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256").split("value").join(i)):undefined,window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:e.quorum?"getQuorum":"",functionalityMethodSignature:e.quorum?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:e.quorum===0||parseInt(n.view.props.element.quorum)?"getQuorum":"",functionalityOutputParameters:e.quorum?'["uint256"]':""},u,undefined,s,o);case 15:case"end":return a.stop()}},r,this)}));return t}(),n.proposalStakeChange=function(t){var r=window.numberToString(t.minimumStaking),i=window.toDecimals(t.minimumStaking,n.view.props.element.decimals);t.minimumStaking=parseInt(i);if(t.minimumStaking===parseInt(n.view.props.element.minimumStaking))return;if(isNaN(t.minimumStaking)||t.minimumStaking<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.minimumStaking>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Proposal Stake","This functionality provides the amount of voting tokens needed to be staked to make a new proposal"],o=["Setting Proposal Stake value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.minimumStaking&&s.push(o[0]),t.minimumStaking===0&&(o=["Clearing Proposal Stake"]);var u=t.minimumStaking?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.minimumStaking?"getMinimumStaking":"",functionalityMethodSignature:t.minimumStaking?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:t.minimumStaking===0||parseInt(n.view.props.element.minimumStaking)?"getMinimumStaking":"",functionalityOutputParameters:t.minimumStaking?'["uint256"]':""},u,undefined,s,o)},n.surveySingleRewardChange=function(t){var r=window.numberToString(t.surveySingleReward),i=window.toDecimals(t.surveySingleReward,n.view.props.element.decimals);t.surveySingleReward=parseInt(i);if(t.surveySingleReward===parseInt(n.view.props.element.surveySingleReward))return;if(isNaN(t.surveySingleReward)||t.surveySingleReward<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.surveySingleReward>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Dev Incentives","This functionality provides the amount of voting tokens needed to be staked to make a new proposal"],o=["Setting Dev Incentives value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.surveySingleReward&&s.push(o[0]),t.surveySingleReward===0&&(o=["Clearing Dev Incentives"]);var u=t.surveySingleReward?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.surveySingleReward?"getSurveySingleReward":"",functionalityMethodSignature:t.surveySingleReward?"getValue()":"",functionalitySubmitable:!1,functionalityReplace:t.surveySingleReward===0||parseInt(n.view.props.element.surveySingleReward)?"getSurveySingleReward":"",functionalityOutputParameters:t.surveySingleReward?'["uint256"]':""},u,undefined,s,o)},n.votesHardCapChange=function(t){var r=window.numberToString(t.votesHardCap),i=window.toDecimals(t.votesHardCap,n.view.props.element.decimals);t.votesHardCap=parseInt(i);if(t.votesHardCap===parseInt(n.view.props.element.votesHardCap))return;if(isNaN(t.votesHardCap)||t.votesHardCap<0)return n.view.emit("message","You must specify a number greater than or equal to 0 to proceed","error");if(t.votesHardCap>parseInt(n.view.props.element.totalSupply))return n.view.emit("message","Specified amount exceedes Total Voting Token Supply","error");var s=["DFO Hub - Utilities - Get Votes Hard Cap",'If a proposal reaches a fixed number of voting tokens (example the 90% of the total Token supply) for "Approve" or "Disapprove" it, the proposal automatically ends, independently from the duration rule.'],o=["Setting Votes Hard Cap value to "+r+" "+n.view.props.element.symbol];!n.view.props.element.votesHardCap&&s.push(o[0]),t.votesHardCap===0&&(o=["Clearing Votes Hard Cap"]);var u=t.votesHardCap?JSON.parse(JSON.stringify(window.context.simpleValueProposalTemplate).split("getValue()").join("getVotesHardCap()").split("type").join("uint256").split("value").join(i)):undefined;window.sendGeneratedProposal(n.view.props.element,{title:o[0],functionalityName:t.votesHardCap?"getVotesHardCap":"",functionalityMethodSignature:t.votesHardCap?"getVotesHardCap()":"",functionalitySubmitable:!1,functionalityReplace:t.votesHardCap===0||parseInt(n.view.props.element.votesHardCap)?"getVotesHardCap":"",functionalityOutputParameters:t.votesHardCap?'["uint256"]':""},u,undefined,s,o)}};var Rules=React.createClass({displayName:"Rules",requiredModules:["spa/editor"],requiredScripts:["spa/loaderMini.jsx","spa/okBoomer.jsx","spa/loaderMinimino"],uploadFile:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget.files[0],r=this,i=new FileReader;i.addEventListener("load",function(){r.indexValue.value=i.result},!1),i.readAsDataURL(n)},changeElementInfo:function(t){if(!t)return;t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=window.getData($($(t.currentTarget).parent()).parent());this.controller[this.state.change+"Change"](n)},componentDidMount:function(){var t=this;window.blockchainCall(t.props.element.dFO.methods.read,"getMinimumBlockNumberForSurvey","0x").then(function(e){t.props.element.blocks=window.web3.eth.abi.decodeParameters(["uint256"],e)[0],t.forceUpdate()})},renderChangeButton:function(t){var n=this;if(!n.props.edit)return;return React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB"+(n.state&&n.state.change===t?" Editing":""),href:"javascript:;",onClick:function(){return n.setState({change:n.state&&n.state.change===t?null:t})}},"Change")},renderChanger:function(t){var n=this;if(!n.props.edit||!n.state||!n.state.change)return;for(var r in t){var i=t[r];if(n.state.change===i){var s=n["render"+i.substring(0,1).toUpperCase()+i.substring(1)+"Changer"];return React.createElement("section",{className:"DFOFunctionIndexIcon"},s&&s(),React.createElement("aside",null,React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualButtonB",onClick:n.changeElementInfo},"Propose")))}}},renderIndexChanger:function(){var t=this;return React.createElement("ul",null,React.createElement("li",null,React.createElement("p",null,'DFOs Front-End is designed to work in two layers, the "Distributed Layer" and the "Decentralized Layer." The Distributed Layer is a version of the Front-End deployed via IPFS or Swarn, for fast and free updates. The Decentralized Layer is a version of the Front-End via On-Chain files, expensive but critical to making a DFO Censorship Resistant. The ENS automatically redirects users to the Distributed Layer and if it\'s Censored to the Decentralized Layer.')),React.createElement("li",null,React.createElement("section",null,React.createElement("a",{href:this.props.element.link?"javascript:;":undefined,className:this.props.element.link?"LinkVisualButton"+(this.state&&this.state.indexShow==="link"?" Editing":""):undefined,onClick:function(){return t.props.element.link&&t.setState({indexShow:t.state&&t.state.indexShow==="link"?null:"link"})}},"Code"),React.createElement("input",{id:"linkCheck",type:"checkbox",className:"DFOFunctionIndexIconSelector",ref:function(n){return t.linkCheck=n},onChange:function(n){t.linkValue.value=t.props.element.link||"",t.linkValue.disabled=!n.currentTarget.checked,t.indexCheck.checked=!1,t.indexFile.disabled=!0}}),React.createElement("label",{htmlFor:"linkCheck"},"Distributed Layer"),React.createElement("input",{className:"DFOFunctionIndexIconText",id:"link",type:"text",placeholder:"Link IPFS Swarm",ref:function(n){return(t.linkValue=n)&&(n.value=t.props.element.link||"")},disabled:!0})),React.createElement("section",null,React.createElement("a",{href:this.props.element.index?"javascript:;":undefined,className:this.props.element.index?"LinkVisualButton"+(this.state&&this.state.indexShow==="index"?" Editing":""):undefined,onClick:function(){return t.props.element.index&&t.props.element.index!=="0"&&t.setState({indexShow:t.state&&t.state.indexShow==="index"?null:"index"})}},"Code"),React.createElement("input",{type:"hidden",id:"index",ref:function(n){return(t.indexValue=n)&&(n.value=t.props.element.index)}}),React.createElement("input",{id:"indexCheck",type:"checkbox",className:"DFOFunctionIndexIconSelector",ref:function(n){return t.indexCheck=n},onChange:function(n){t.indexValue.value=t.props.element.index,t.indexFile.value="",t.indexFile.disabled=!n.currentTarget.checked,t.linkCheck.checked=!1,t.linkValue.disabled=!0}}),React.createElement("label",{htmlFor:"indexCheck"},"Decentralized Layer"),React.createElement("input",{className:"DFOFunctionIndexIconUpload",id:"indexFile",type:"file",accept:".html,.htm",ref:function(n){return t.indexFile=n},disabled:!0,onChange:this.uploadFile}))),this.state&&this.state.indexShow&&React.createElement("section",null,this.state.indexShow==="index"&&React.createElement(Editor,{lang:"html",readonly:"true",first:this.state.indexShow==="index"?this.props.element.index:undefined}),this.state.indexShow==="link"&&React.createElement(Editor,{lang:"html",readonly:"true",link:this.state.indexShow==="link"?this.props.element.link:undefined})))},renderSurveySingleRewardChanger:function(){return this.renderDefaultChanger("The number of Voting Tokens as a reward to the issuer for every single Successful Proposal.","Dev Incentives","surveySingleReward",window.fromDecimals(this.props.element.surveySingleReward,this.props.element.decimals))},renderProposalLengthChanger:function(){return this.renderDefaultChanger("Every survey has a length expressed in Blocks. Here you can set the duration of Surveys for this DFO.","Proposal Length","proposalLength",this.props.element.blocks)},renderEmergencyLengthChanger:function(){return this.renderDefaultChanger("The length in Blocks for Emergency Surveys.","Emergency Length","minimumBlockNumberForEmergencySurvey",this.props.element.minimumBlockNumberForEmergencySurvey)},renderEmergencyPenaltyChanger:function(){return this.renderDefaultChanger("The Fee that Emergency Proposal Issuer must stake to propose it. This stake will be lost if the Proposal fails.","Emergency Penalty","emergencySurveyStaking",window.fromDecimals(this.props.element.emergencySurveyStaking,this.props.element.decimals))},renderQuorumChanger:function(){return this.renderDefaultChanger("The Quorum is a minimum number of Voting Tokens staked in a survey to reach the success status.","Quorum","quorum",window.fromDecimals(this.props.element.quorum,this.props.element.decimals))},renderProposalStakeChanger:function(){return this.renderDefaultChanger("The minimum of Token Stacked needed to create a new Proposal.","Proposal Stake","minimumStaking",window.fromDecimals(this.props.element.minimumStaking,this.props.element.decimals))},renderVotesHardCapChanger:function(){return this.renderDefaultChanger('If a proposal reaches a fixed number of voting tokens (example the 90% of the total Token supply) for "Approve" or "Disapprove" it, the proposal automatically ends, independently from the duration rule.',"Hard Cap","votesHardCap",window.fromDecimals(this.props.element.votesHardCap,this.props.element.decimals))},renderDefaultChanger:function(t,n,r,i){return React.createElement("ul",null,React.createElement("li",null,React.createElement("p",{ref:function(n){return n&&(n.innerHTML=t)}},t)),React.createElement("li",null,React.createElement("section",null,React.createElement("label",{htmlFor:r,ref:function(t){return t&&(t.innerHTML=n)}},n),React.createElement("input",{className:"DFOFunctionIndexIconText",id:r,type:"number",min:"0",ref:function(t){return t&&(t.value=i)}}))))},render:function(){var t=this;return React.createElement("section",{className:"DFOOverview"},React.createElement("ul",{className:"DFOHosting"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Governance Rules")),React.createElement("li",{className:"TheDappInfo2"},React.createElement("h5",{className:"DFOHostingTitle"},"🏰 Regular Proposals: ",React.createElement("a",{className:"EditDFOYoYO"+(t.dfoElement&&t.dfoElement.state&&t.dfoElement.state.okBoomer?" Editing":""),href:"javascript:;",onClick:function(){return t.emit("okBommer/toggle")}},"i")),React.createElement("section",{className:"DFOTitleSection"},t.props.element.blocks===undefined&&React.createElement(LoaderMinimino,null),t.props.element.blocks!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Length: ",React.createElement("b",null,t.props.element.blocks),React.createElement("aside",null," Blocks ")," ",t.renderChangeButton("proposalLength"))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"The duration of a Proposal"),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,t.props.element.symbol&&t.props.element.totalSupply&&t.props.element.quorum!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Quorum: ",React.createElement("b",null,window.tokenPercentage(t.props.element.quorum,t.props.element.totalSupply)),React.createElement("aside",null,React.createElement("b",null," (",window.fromDecimals(t.props.element.quorum,t.props.element.decimals))," ",t.props.element.symbol,")")," ",t.renderChangeButton("quorum")))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"The minimum number of Voting Tokens staked by voters to reach the a positive result."),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,t.props.element.symbol&&t.props.element.totalSupply&&t.props.element.minimumStaking!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Generation Stake: ",React.createElement("b",null,window.tokenPercentage(t.props.element.minimumStaking,t.props.element.totalSupply)),React.createElement("aside",null,React.createElement("b",null," (",window.fromDecimals(t.props.element.minimumStaking,t.props.element.decimals))," ",t.props.element.symbol,")")," ",t.renderChangeButton("proposalStake")))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"The minimum number of Voting Tokens staked to create a Proposal."),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,t.props.element.symbol&&t.props.element.totalSupply&&t.props.element.votesHardCap!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},"Hard Cap: ",React.createElement("b",null,window.tokenPercentage(t.props.element.votesHardCap,t.props.element.totalSupply)),React.createElement("aside",null,React.createElement("b",null," (",window.fromDecimals(t.props.element.votesHardCap,t.props.element.decimals))," ",t.props.element.symbol,")")," ",t.renderChangeButton("votesHardCap")))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"If a proposal reaches a fixed number of voting tokens (example the 90% of the total Token supply) for “Approve” or “Disapprove” it, the proposal automatically ends, independently from the duration rule."),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,t.props.element.symbol&&t.props.element.totalSupply&&t.props.element.surveySingleReward!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"}," Proposal Reward: ",React.createElement("b",null,window.fromDecimals(t.props.element.surveySingleReward,t.props.element.decimals))," ",React.createElement("aside",{className:"DFOOverviewPerch"},t.props.element.symbol)," ",t.renderChangeButton("surveySingleReward")))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"The number of Voting Tokens as a reward to the issuer for every single Successful Proposal.")),React.createElement("li",{className:"TheDappInfo2"},React.createElement("h5",{className:"DFOHostingTitle"},"🚨 Emergency Proposals: ",React.createElement("a",{className:"EditDFOYoYO"+(t.dfoElement&&t.dfoElement.state&&t.dfoElement.state.okBoomer?" Editing":""),href:"javascript:;",onClick:function(){return t.emit("okBommer/toggle")}},"i")),React.createElement("section",{className:"DFOTitleSection"},t.props.element.minimumBlockNumberForEmergencySurvey===undefined&&React.createElement(LoaderMinimino,null),t.props.element.minimumBlockNumberForEmergencySurvey!==undefined&&React.createElement("p",{className:"DFOLabelTitleInfo"},t.renderChangeButton("emergencyLength")," Length: ",React.createElement("b",null,t.props.element.minimumBlockNumberForEmergencySurvey)," ",React.createElement("aside",null,"Blocks"))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"The duration of an Emergency Proposal"),React.createElement("section",{className:"DFOTitleSection"},React.createElement(AsyncValue,null,t.props.element.symbol&&t.props.element.totalSupply&&t.props.element.emergencySurveyStaking&&React.createElement("p",{className:"DFOLabelTitleInfo"},t.renderChangeButton("emergencyPenalty")," Penalty fee: ",React.createElement("b",null,window.tokenPercentage(t.props.element.emergencySurveyStaking,t.props.element.totalSupply)),React.createElement("aside",null," (",React.createElement("b",null,window.fromDecimals(t.props.element.emergencySurveyStaking,t.props.element.decimals))," ",t.props.element.symbol,")")))),React.createElement(OkBoomer,{okBoomer:t.props.okBoomer},"The Fee that Emergency Proposal Issuer must stake to propose it. This stake will be lost if the Proposal fails.")),t.renderChanger(["proposalStake","emergencyLength","emergencyPenalty","quorum","proposalLength","votesHardCap","surveySingleReward"])))}});var SequentialOps=React.createClass({displayName:"SequentialOps",requiredScripts:["spa/loaderMini.jsx"],go:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this.goButton;if($(n).hasClass("disabled"))return;$(n).addClass("disabled"),this.cancelButton&&$(this.cancelButton).addClass("disabled");var r=this;for(var i in r.children){var s=r.children[i];delete s.loading,delete s.ko}var o=this.getIndex(),u=r.children[o];u.loading=!0,r.emit("message"),r.forceUpdate(function(){var e=function s(){r.unsubscribe("transaction/start",s),u.transacting=!0,r.forceUpdate()};r.subscribe("transaction/start",e);var t=$(r.list.children("li.child-"+o)[0]).children().find('input.include[type="checkbox"]')[0];t&&(t.disabled=!0);var i=$('input.transactionHash[type="text"][data-i="'+o+'"]')[0];i&&(i.disabled=!0),u.transactionHash=u.bypass===!0?undefined:u.transactionHash,(u.transactionHash?window.web3.eth.getTransactionReceipt(u.transactionHash).then(function(e){return u.onTransaction(r.ctx,e)}):u.call(r.ctx,u.bypass)).then(function(){r.unsubscribe("transaction/start",e),delete u.loading,delete u.transacting,n&&$(n).removeClass("disabled"),r.cancelButton&&$(r.cancelButton).removeClass("disabled"),u.ok=!0,r.forceUpdate(function(){r.props.onCallback&&r.props.onCallback(o,o===r.children.length-1)})}).catch(function(s){r.unsubscribe("transaction/start",e),delete u.loading,delete u.transacting,t&&(t.disabled=!1),i&&(i.disabled=!1),n&&$(n).removeClass("disabled"),r.cancelButton&&$(r.cancelButton).removeClass("disabled"),u.ko=(s.message||s)!=="stopped"&&(s.message||s).toLowerCase().indexOf("user denied")===-1,u.ko&&r.emit("message",s.message||s,"error"),r.forceUpdate()})})},stop:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.emit("transaction/stop"),this.cancelButton&&$(this.cancelButton).removeClass("disabled"),this.goButton&&$(this.goButton).removeClass("disabled");var n=this.getIndex();n=isNaN(n)?this.children.length-1:n,delete this.children[n].loading,delete this.children[n].transacting,this.forceUpdate()},onCancel:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if($(this.cancelButton).hasClass("disabled"))return;this.emit("message"),this.emit("loader/toggle",!1)},onBypassChange:function(t){this.children[t.currentTarget.dataset.i].bypass=!t.currentTarget.checked;var n=$('input.transactionHash[type="text"][data-i="'+t.currentTarget.dataset.i+'"]')[0];n&&(n.disabled=!t.currentTarget.checked),n&&(n.value=""),n&&delete this.children[t.currentTarget.dataset.i].transactionHash},onTransactionHash:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.children[t.currentTarget.dataset.i].transactionHash=t.currentTarget.value},getIndex:function(){var t;for(var n in this.children){var r=this.children[n];if(!r.ok){t=n;break}}return parseInt(t)},onRecovery:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this;if(n.children){var r=this.getIndex();r=isNaN(r)?n.children.length-1:r,(n.children[r].loading||n.children[r].transacting)&&this.stop(t)}if($(t.currentTarget).hasClass("disabled"))return;this.setState({advanced:!this.state||!this.state.advanced},function(){if(this.state.advanced)return;for(var e=0;e<n.children.length;e++){var t=n.children[e];t.ok||delete t.transactionHash}})},render:function(){var t=this,n=this,r=undefined,i=undefined;n.props.initialContext&&(r=n.props.initialContext.element,delete n.props.initialContext.element,i=n.props.initialContext.editor,delete n.props.initialContext.editor),n.ctx=n.ctx||(n.props.initialContext?JSON.parse(JSON.stringify(n.props.initialContext)):{}),r&&(n.ctx.element=r),r&&n.props.initialContext&&(n.props.initialContext.element=r),i&&(n.ctx.editor=i),i&&n.props.initialContext&&(n.props.initialContext.editor=i),n.children=n.children||n.props.children;var s=this.getIndex();s=isNaN(s)?n.children.length-1:s;var o=n.children[s].actionName||(s==0?"Start":s===n.children.length-1?"Finish":"Next");return React.createElement("div",null,React.createElement("aside",null,"Before leaving this page, make all the transactions listed. Otherwise the entire operation will not be completed successfully"),n.ctx.title&&React.createElement("h3",null,n.ctx.title),React.createElement("ol",{ref:function(t){return n.list=$(t)}},n.children.map(function(e,n){return React.createElement("li",{key:n,className:"child-"+n},React.createElement("label",null,e.bypassable&&React.createElement("input",{type:"checkbox",className:"include",ref:function(n){return n&&(n.checked=!e.bypass)},disabled:e.ok,"data-i":n,onChange:t.onBypassChange}),React.createElement("p",null,React.createElement("b",null,e.name)),e.onTransaction&&(t.state&&t.state.advanced&&!e.ok||e.ok&&e.transactionHash)&&[React.createElement("p",{className:"Pistombrillo"},React.createElement("label",null,"If you have already deployed this Smart Contract, you can paste here the transaction hash, to proceed without needs re-deploy it and pay additional ETH fees."),React.createElement("input",{type:"text",className:"transactionHash",ref:function(n){return n&&(n.value=e.transactionHash||"")},disabled:e.ok,"data-i":n,placeholder:"Transaction Hash",onKeyUp:t.onTransactionHash,onChange:t.onTransactionHash}))],React.createElement("span",{className:e.loading?"loaderMinimino":""},e.ok&&React.createElement("span",null,"✅"),e.ko&&React.createElement("span",null,"⛔")),!1,e.description&&React.createElement("span",{className:"Pistombrillo"},e.description)))})),n.props.hideGoButton+""!="true"&&React.createElement("div",{className:"LetsGoPika"},n.props.showCancelButton+""=="true"&&React.createElement("a",{href:"javascript:;",ref:function(n){return t.cancelButton=n},onClick:this.onCancel},"Cancel"),React.createElement("a",{href:"javascript:;",className:"LinkVisualButtonB",ref:function(n){return t.goButton=n},onClick:this.go},o),React.createElement("a",{href:"javascript:;",className:"LinkVisualButtonB LLinkVisualButtonSpecial"+(this.state&&this.state.advanced?" Edited":""),onClick:this.onRecovery,ref:function(n){return t.recoveryButton=n}},"Recovery")))}});var StakeController=function(t){var n=this;n.view=t,n.slippage=new UniswapFraction(window.context.slippageNumerator,window.context.slippageDenominator),n.calculateBalance=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 2:return t=s.sent,s.next=5,n.getSecondTokenData(e===undefined?n.pool.value.split("_")[0]:e);case 5:i=s.sent.balance,n.view.setState({firstBalance:t,secondBalance:i});case 7:case"end":return s.stop()}},r,this)}));return t}(),n.calculateApprove=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u,a,f,l,c;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=parseInt,h.next=3,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 3:return h.t1=h.sent,t=(0,h.t0)(h.t1),h.t2=parseInt,h.next=8,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.allowance,window.walletAddress,n.view.props.stakingData.stakingManager.options.address);case 8:h.t3=h.sent,i=(0,h.t2)(h.t3),s=i===0||i<t,o=!1,u=n.view.props.stakingData.pairs[e];if(u.symbol==="ETH"){h.next=25;break}return h.t4=parseInt,h.next=17,n.getSecondTokenData(e);case 17:return h.t5=h.sent.balance,a=(0,h.t4)(h.t5),h.t6=parseInt,h.next=22,window.blockchainCall(u.token.methods.allowance,window.walletAddress,n.view.props.stakingData.stakingManager.options.address);case 22:h.t7=h.sent,f=(0,h.t6)(h.t7),o=f===0||f<a?u.symbol:!1;case 25:return n.view.setState({approveFirst:s,approveSecond:o}),n.calculateBalance(e),h.t8=parseInt,h.next=30,window.blockchainCall(n.view.props.stakingData.rewardToken.token.methods.balanceOf,window.walletAddress);case 30:return h.t9=h.sent,l=(0,h.t8)(h.t9),h.t10=parseInt,h.next=35,window.blockchainCall(n.view.props.stakingData.rewardToken.token.methods.allowance,window.walletAddress,n.view.props.stakingData.stakingManager.options.address);case 35:h.t11=h.sent,c=(0,h.t10)(h.t11),n.view.setState({rewardApproved:c>=l});case 38:case"end":return h.stop()}},r,this)}));return t}(),n.approve=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.view.setState({loadingStake:!1,loadingApprove:!0}),i.prev=1,t=e==="reward"?n.view.props.stakingData.rewardToken.token:e==="mine"?n.view.props.stakingData.mainToken.token:n.view.props.stakingData.pairs[n.view.pool.value.split("_")[0]].token,i.t0=window,i.t1=t.methods.approve,i.t2=n.view.props.stakingData.stakingManager.options.address,i.next=8,window.blockchainCall(t.methods.totalSupply);case 8:return i.t3=i.sent,i.next=11,i.t0.blockchainCall.call(i.t0,i.t1,i.t2,i.t3);case 11:n.calculateApprove(parseInt(n.view.pool.value.split("_")[0])),i.next=16;break;case 14:i.prev=14,i.t4=i["catch"](1);case 16:n.view.setState({loadingStake:!1,loadingApprove:!1});case 17:case"end":return i.stop()}},r,this,[[1,14]])}));return t}(),n.max=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 2:s=a.sent;if(e!=="firstAmount"){a.next=8;break}return a.next=6,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.getStakingInfo,i);case 6:o=a.sent[1],parseInt(s)>parseInt(o)&&(s=o);case 8:return s=(new UniswapFraction(s,1)).divide(Math.pow(10,18)).toSignificant(6),a.t0=UniswapFraction,a.next=12,n.getSecondTokenData(t=t||0);case 12:a.t1=a.sent.balance,a.t2=Math.pow(10,t)===1?6:18,u=(new a.t0(a.t1,1)).divide(a.t2).toSignificant(6),n.view[e].value=e==="firstAmount"?s:u,e==="firstAmount"&&n.calculateReward(i),n.calculateOther(e,t,i);case 18:case"end":return a.stop()}},r,this)}));return t}(),n.changeSecond=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=n.view.props.stakingData.pairs[t],a.next=3,window.blockchainCall(window.uniswapV2Factory.methods.getPair,n.view.props.stakingData.mainToken.address,s.address);case 3:o=a.sent,u=o!==window.voidEthereumAddress,n.view.setState({secondHasPair:u}),u&&n.calculateOther(e,t,i);case 7:case"end":return a.stop()}},r,this)}));return t}(),n.calculateOther=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n.view.state.secondHasPair){a.next=4;break}return s=new UniswapFraction(window.toDecimals(n.view[e==="firstAmount"?"secondAmount":"firstAmount"].value.split(",").join(""),(e==="firstAmount"?n.view.props.stakingData.pairs[t]:n.view.props.stakingData.mainToken).decimals)),e==="firstAmount"&&n.calculateReward(i),a.abrupt("return",s);case 4:return a.t0=n,a.next=7,n.getSecondTokenData(t,!0);case 7:return a.t1=a.sent.token,a.t2=t,a.next=11,a.t0.calculateReserves.call(a.t0,a.t1,a.t2);case 11:return o=a.sent,s=o[e==="firstAmount"?"secondPerBuidl":"buidlPerSecond"].multiply(window.toDecimals(n.view[e].value.split(",").join("")||"0",t===1?n.view.props.stakingData.pairs[t].decimals:n.view.props.stakingData.mainToken.decimals)),s=new UniswapFraction(s.toSignificant(100).split(".")[0]),u=(e!=="firstAmount"?s:s.divide(Math.pow(10,n.view.props.stakingData.pairs[t].decimals))).toSignificant(6),n.view[e==="firstAmount"?"secondAmount":"firstAmount"].value=window.formatMoney(u,u.split(".")[1]&&u.split(".")[1].length),e==="firstAmount"&&n.calculateReward(i),a.abrupt("return",s);case 18:case"end":return a.stop()}},r,this)}));return t}(),n.calculateReserves=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.t0=window,d.t1=window.context.uniSwapV2PairAbi,d.next=4,window.blockchainCall(window.uniswapV2Factory.methods.getPair,n.view.props.stakingData.mainToken.address,e.options.address);case 4:return d.t2=d.sent,i=d.t0.newContract.call(d.t0,d.t1,d.t2),d.next=8,window.blockchainCall(i.methods.token0);case 8:d.t3=d.sent.toLowerCase(),d.t4=n.view.props.stakingData.mainToken.address.toLowerCase();if(d.t3!==d.t4){d.next=14;break}d.t5=0,d.next=15;break;case 14:d.t5=1;case 15:return s=d.t5,o=s==0?1:0,d.next=19,window.blockchainCall(i.methods.getReserves);case 19:return u=d.sent,d.t6=parseInt,d.next=23,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.decimals);case 23:d.t7=d.sent,a=(0,d.t6)(d.t7);if(t!==0){d.next=29;break}d.t8=18,d.next=34;break;case 29:return d.t9=parseInt,d.next=32,window.blockchainCall(e.methods.decimals);case 32:d.t10=d.sent,d.t8=(0,d.t9)(d.t10);case 34:f=d.t8;if(a>f){l=a-f,c=(new UniswapFraction(u[s],1)).divide(Math.pow(10,l)).toSignificant(6);while(c.indexOf(".")!==-1)l--,c=(new UniswapFraction(u[s],1)).divide(Math.pow(10,l)).toSignificant(6);u[s]=c}return h=new UniswapFraction(u[s],u[o]),p=new UniswapFraction(u[o],u[s]),d.abrupt("return",{buidlPerSecond:h,secondPerBuidl:p});case 39:case"end":return d.stop()}},r,this)}));return t}(),n.calculateReward=function(t){setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,n.getTierData();case 3:e=o.sent,e=[e[1][t],e[2][t],e[3][t]],i=window.web3.utils.toBN(window.toDecimals(n.view.firstAmount.value.split(",").join(""),18)).mul(window.web3.utils.toBN(e[0])).div(window.web3.utils.toBN(e[1])).toString(),n.view.reward.innerText=window.formatMoney(window.fromDecimals(i,n.view.props.stakingData.mainToken.decimals,!0),18),s=window.web3.utils.toBN(i).div(window.web3.utils.toBN(e[2])),n.view.splittedReward.innerText=window.formatMoney(window.fromDecimals(s,n.view.props.stakingData.mainToken.decimals,!0),18),o.next=13;break;case 11:o.prev=11,o.t0=o["catch"](0);case 13:case"end":return o.stop()}},r,this,[[0,11]])})))},n.getSecondTokenData=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:i=n.view.props.stakingData.pairs[e],o.t0=i.token;if(t!==!0){o.next=6;break}o.t1="0",o.next=9;break;case 6:return o.next=8,i.symbol==="ETH"?window.web3.eth.getBalance(window.walletAddress):window.blockchainCall(i.token.methods.balanceOf,window.walletAddress);case 8:o.t1=o.sent;case 9:return o.t2=o.t1,s={token:o.t0,balance:o.t2},isNaN(parseInt(s.balance))&&(s.balance="0"),o.abrupt("return",s);case 13:case"end":return o.stop()}},r,this)}));return t}(),n.getTierData=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0;if(n.view.tierData){t.next=5;break}return t.next=4,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.tierData);case 4:n.view.tierData=t.sent;case 5:return t.abrupt("return",JSON.parse(JSON.stringify(n.view.tierData)));case 8:return t.prev=8,t.t0=t["catch"](0),t.abrupt("return",[]);case 11:case"end":return t.stop()}},r,this,[[0,8]])}));return t}(),n.stake=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u,a,f,l,c,h;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return i=window.toDecimals(n.view.firstAmount.value.split(",").join(""),n.view.props.stakingData.mainToken.decimals),p.next=3,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.getStakingInfo,t);case 3:return s=p.sent,p.next=6,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 6:o=p.sent;if(!(parseInt(i)<parseInt(s[0]))){p.next=9;break}return p.abrupt("return",alert("Amount to stake is less than the current min cap"));case 9:if(!(parseInt(i)>parseInt(s[2]))){p.next=11;break}return p.abrupt("return",alert("Amount to stake must be less than the current remaining one"));case 11:if(!(parseInt(i)>parseInt(o))){p.next=13;break}return p.abrupt("return",alert("You don't have enough "+n.view.props.stakingData.mainToken.symbol+" balance to stake!"));case 13:return n.view.setState({staked:null,loadingStake:!0,loadingApprove:!1}),i=new UniswapFraction(i,1),p.next=17,n.calculateOther("firstAmount",e,t);case 17:return u=p.sent,a=i.subtract(i.multiply(n.slippage)).toSignificant(100).split(".")[0],f=u.subtract(u.multiply(n.slippage)).toSignificant(100).split(".")[0],i=i.toSignificant(100).split(".")[0],u=u.toSignificant(100).split(".")[0],p.t0=parseInt(u),p.t1=parseInt,p.next=26,n.getSecondTokenData(e);case 26:p.t2=p.sent,p.t3=(0,p.t1)(p.t2).balance;if(!(p.t0>p.t3)){p.next=30;break}return p.abrupt("return",alert("You don't have enough "+n.view.props.stakingData.pairs[e].symbol+" balance to stake!"));case 30:return p.t4=window.web3.utils,p.next=33,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.tokens);case 33:return p.t5=e,p.t6=p.sent[p.t5],l=p.t4.toChecksumAddress.call(p.t4,p.t6),c=l===window.wethAddress?u:undefined,h=l===window.wethAddress?"0":u,p.prev=38,p.next=41,window.blockchainCall(c,n.view.props.stakingData.stakingManager.methods.stake,t,e+"",i,a,h,f);case 41:n.view.setState({staked:{amount:n.view.firstAmount.value,period:n.view.props.stakingData.tiers[t].tierKey}},function(){n.view.emit("ethereum/ping"),n.view.emit("staking/refresh")}),p.next=47;break;case 44:p.prev=44,p.t7=p["catch"](38),(p.t7.message||p.t7).toLowerCase().indexOf("user denied")===-1&&alert(p.t7.message||p.t7);case 47:n.view.setState({loadingStake:!1,loadingApprove:!1});case 48:case"end":return p.stop()}},r,this,[[38,44]])}));return t}(),n.load=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(window.walletAddress){d.next=2;break}return d.abrupt("return");case 2:n.view.setState({loadingPosition:!0}),d.t0=n.view.pool;if(!d.t0){d.next=7;break}return d.next=7,n.changeSecond("firstAmount",parseInt(n.view.pool.value.split("_")[0]),n.view.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier);case 7:return d.next=9,n.calculateApprove(parseInt(n.view.pool?n.view.pool.value.split("_")[0]:0));case 9:return d.next=11,window.web3.eth.getBlockNumber();case 11:e=d.sent,t=[],i=0;case 14:if(!(i<n.view.props.stakingData.tiers.length)){d.next=60;break}return d.t1=parseInt,d.next=18,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.length,i);case 18:d.t2=d.sent,s=(0,d.t1)(d.t2),o=0;case 21:if(!(o<s)){d.next=57;break}return d.next=24,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.stakeInfo,i,o);case 24:u=d.sent;if(window.walletAddress.toLowerCase()===u[0].toLowerCase()){d.next=27;break}return d.abrupt("continue",54);case 27:a={position:o,tier:i,sender:u[0],poolPosition:u[1],firstAmount:u[2],secondAmount:u[3],poolAmount:u[4],reward:u[5],endBlock:u[6],partialRewardBlockTimes:u[7],splittedReward:u[8],cumulativeReward:"0"},a.poolAmountFromDecimals=(new UniswapFraction(a.poolAmount,1)).divide(Math.pow(10,18)).toSignificant(6),a.canWithdraw=e>=parseInt(a.endBlock),f=a.partialRewardBlockTimes,l=Array.isArray(f),c=0,f=l?f:f[Symbol.iterator]();case 31:if(!l){d.next=37;break}if(!(c>=f.length)){d.next=34;break}return d.abrupt("break",50);case 34:h=f[c++],d.next=41;break;case 37:c=f.next();if(!c.done){d.next=40;break}return d.abrupt("break",50);case 40:h=c.value;case 41:p=h;if(p!=="0"){d.next=44;break}return d.abrupt("continue",48);case 44:a.nextPartialReward=a.nextPartialReward||p;if(!(e<parseInt(p))){d.next=47;break}return d.abrupt("continue",48);case 47:a.cumulativeReward=window.web3.utils.toBN(a.cumulativeReward).add(window.web3.utils.toBN(a.splittedReward)).toString();case 48:d.next=31;break;case 50:return a.cumulativeReward=parseInt(a.cumulativeReward)>parseInt(a.reward)?a.reward:a.cumulativeReward,d.next=53,n.loadUniswapPoolAmounts(a);case 53:t.push(a);case 54:o++,d.next=21;break;case 57:i++,d.next=14;break;case 60:n.view.setState({loadingPosition:!1,stakingPositions:t});case 61:case"end":return d.stop()}},r,this)}));return t}(),n.loadUniswapPoolAmounts=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u,a,f,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=n.view.props.stakingData.pairs[e.poolPosition].address,c.t0=window,c.t1=window.context.uniSwapV2PairAbi,c.next=5,window.blockchainCall(window.uniswapV2Factory.methods.getPair,t,n.view.props.stakingData.mainToken.address);case 5:return c.t2=c.sent,i=c.t0.newContract.call(c.t0,c.t1,c.t2),c.next=9,window.blockchainCall(i.methods.token0);case 9:return s=c.sent,c.next=12,window.blockchainCall(i.methods.getReserves);case 12:return o=c.sent,c.next=15,window.blockchainCall(i.methods.totalSupply);case 15:u=c.sent,a=parseInt(e.poolAmount)/parseInt(u),f=window.numberToString(parseInt(o[0])*a).split(",").join("").split(".")[0],l=window.numberToString(parseInt(o[1])*a).split(",").join("").split(".")[0],s===n.view.props.stakingData.mainToken.address?(e.myBalance=f,e.otherBalance=l):(e.myBalance=l,e.otherBalance=f);case 20:case"end":return c.stop()}},r,this)}));return t}(),n.redeem=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0);if(!$(e.currentTarget).hasClass("NoRedeem")){s.next=3;break}return s.abrupt("return");case 3:return s.next=5,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.partialReward,t,i);case 5:n.load();case 6:case"end":return s.stop()}},r,this)}));return t}(),n.withdraw=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0);if(!$(e.currentTarget).hasClass("NoRedeem")){s.next=3;break}return s.abrupt("return");case 3:return s.next=5,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.withdraw,t,i);case 5:n.load();case 6:case"end":return s.stop()}},r,this)}));return t}(),n.unlock=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0);if(!$(e.currentTarget).hasClass("UnlockButtonDisabled")){s.next=3;break}return s.abrupt("return");case 3:return n.view.setState({unlocking:!0}),s.prev=4,s.next=7,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.unlock,t,i);case 7:n.load(),s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](4),(s.t0.message||s.t0).toLowerCase().indexOf("user denied")===-1&&alert("Transaction fail ("+(s.t0.message||s.t0)+"), maybe an old version of the Liquidity Mining Contract");case 13:n.view.setState({unlocking:!1});case 14:case"end":return s.stop()}},r,this,[[4,10]])}));return t}()};var Stake=React.createClass({displayName:"Stake",requiredScripts:["spa/loader.jsx","spa/bigLoader.jsx","spa/ghostLoader.jsx","spa/loaderMini.jsx"],requiredModules:["spa/stakingInfo"],getDefaultSubscriptions:function(){return{"ethereum/ping":this.controller.load}},getInitialState:function(){return{approveFirst:!0,approveSecond:!0}},onTier:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),$($(t.currentTarget).parent()).children("a").each(function(){$(this).removeClass("SelectedDutrationStake")}),$(t.currentTarget).addClass("SelectedDutrationStake"),this.controller.calculateReward(parseInt(t.currentTarget.dataset.tier))},changeSecond:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget.value.split("_");this.logo.src=window.formatLink(this.props.stakingData.pairs[n[0]].logo),this.controller.changeSecond("firstAmount",parseInt(this.pool.value.split("_")[0]),this.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier),this.controller.calculateApprove(parseInt(this.pool.value.split("_")[0]))},max:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.controller.max(t.currentTarget.dataset.target,parseInt(this.pool.value.split("_")[0]),this.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier)},onChangeAmount:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this,r=t.currentTarget;n.changeTimeout&&clearTimeout(n.changeTimeout),n.changeTimeout=setTimeout(function(){n.controller.calculateOther(r.dataset.target,parseInt(n.pool.value.split("_")[0]),n.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier)},window.context.inputChangeTimeout||300)},approve:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(!$(t.currentTarget).hasClass("active")||this.state.loadingStake||this.state.loadingApprove)return;this.controller.approve(t.currentTarget.dataset.target)},stake:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(!$(t.currentTarget).hasClass("active")||this.state.loadingStake||this.state.loadingApprove)return;this.controller.stake(parseInt(this.pool.value.split("_")[0]),this.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier)},componentDidMount:function(){window.history.pushState({},"",window.getLink()+"?staking="+this.props.stakingData.stakingManager.options.address),this.controller.load()},firstTier:function(t){$(t).children(".SelectedDutrationStake").length===0&&$($(t).children()[0]).addClass("SelectedDutrationStake")},getTierKey:function(t){var n=this.props.stakingData.tiers[t];return n.tierKey==="Custom"?n.blockNumber+" blocks":n.tierKey},close:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),window.history.pushState({},"",window.getLink()),this.emit("stake/close")},render:function(){var t=this,n=this;return React.createElement("section",{className:"StakeBigBoss STAKEALL",style:{position:"fixed"}},React.createElement("a",{className:"NoStakeBro",href:"javascript:;",onClick:this.close},"Close"),this.state&&this.state.staked&&React.createElement("section",{className:"boxAYORT"},React.createElement("section",{className:"boxAYORTTEXT"},React.createElement("h2",null,"🎉 🥩 Staked! 🥩 🎉"),React.createElement("p",null,"You have succesfully staked ",React.createElement("b",null,this.state.staked.amount)," ",this.props.stakingData.mainToken.symbol," for ",React.createElement("b",null,this.state.staked.period,"!")," Check the ",React.createElement("a",{href:"javascript:;",onClick:function(){return t.emit("view/change","Status")}},"Status")," page to manage your Staking Position. "))),this.props.stakingData.active&&React.createElement("section",{className:"switchBox"},React.createElement("h3",null,"Stake"),React.createElement("section",{className:"switchTools"},React.createElement("a",{"data-target":"firstAmount",href:"javascript:;",className:"switchAll",onClick:this.max},"Max"),React.createElement("input",{ref:function(n){return t.firstAmount=n},type:"text",placeholder:"0.00",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$","data-target":"firstAmount",onChange:this.onChangeAmount}),React.createElement("aside",{className:"switchLink",target:"_blank"},this.props.stakingData.mainToken.symbol),React.createElement("img",{src:window.formatLink(this.props.stakingData.mainToken.logo||this.props.stakingData.mainToken.logoURI)}),this.state&&this.state.firstBalance&&[React.createElement("br",null),React.createElement("br",null),React.createElement("section",{className:"BalanceLabel"},React.createElement("span",null,"Balance:"),React.createElement("span",null,window.fromDecimals(this.state.firstBalance,this.props.stakingData.mainToken.decimals)),React.createElement("span",null,this.props.stakingData.mainToken.symbol))]),React.createElement("section",{className:"switchTools switchTools2"},!this.state.secondHasPair&&React.createElement("a",{"data-target":"secondAmount",href:"javascript:;",className:"switchAll",onClick:this.max},"Max"),React.createElement("input",{className:"ETHUSDBLOW",ref:function(n){return t.secondAmount=n},type:"text",placeholder:"0.00",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$","data-target":"secondAmount",disabled:this.state.secondHasPair}),React.createElement("select",{ref:function(n){return t.pool=n},className:"switchLink",target:"_blank",onChange:this.changeSecond},this.props.stakingData.pairs.map(function(e,t){return React.createElement("option",{key:e.address,"data-index":t,value:t+"_"+e.symbol},e.symbol)})),React.createElement("img",{ref:function(n){return t.logo=n},src:window.formatLink(this.props.stakingData.pairs[0].logo)}),this.state&&this.state.secondBalance&&this.pool&&[React.createElement("br",null),React.createElement("br",null),React.createElement("section",{className:"BalanceLabel"},React.createElement("span",null,"Balance:"),React.createElement("span",null,window.fromDecimals(this.state.secondBalance,this.props.stakingData.pairs[this.pool.value.split("_")[0]].decimals)),React.createElement("span",null,this.props.stakingData.pairs[this.pool.value.split("_")[0]].symbol))]),!this.state.secondHasPair&&React.createElement("h3",null,"You are the first putting liquidity in this pair!"),React.createElement("h3",null,"⏳ Duration"),React.createElement("section",{className:"switchTools",ref:this.firstTier},this.props.stakingData.tiers.map(function(e,n){return React.createElement("a",{key:e.tierKey,"data-tier":n,className:"TimetoStake",href:"javascript:;",onClick:t.onTier},e.tierKey!=="Custom"?e.tierKey:"For "+e.blockNumber+" blocks")})),React.createElement("h3",null,"🎁 Total Reward"),React.createElement("section",{className:"switchTools"},React.createElement("span",{ref:function(n){return t.reward=n},className:"switchFinal"},window.formatMoney(0)),React.createElement("aside",{className:"switchLink"},this.props.stakingData.rewardToken.symbol),React.createElement("img",{src:window.formatLink(this.props.stakingData.rewardToken.logo||this.props.stakingData.rewardToken.logoURI)})),React.createElement("h3",{className:"switchWeek"},"Weekly"),React.createElement("section",{className:"switchTools switchToolsWeek"},React.createElement("span",{ref:function(n){return t.splittedReward=n},className:"switchFinal"},window.formatMoney(0)),React.createElement("aside",{className:"switchLink"},this.props.stakingData.rewardToken.symbol),React.createElement("img",{src:window.formatLink(this.props.stakingData.rewardToken.logo||this.props.stakingData.rewardToken.logoURI)})),React.createElement("section",{className:"switchActions"},window.walletAddress&&(this.state.approveFirst||!this.state.approveSecond)&&React.createElement("a",{"data-target":"mine",href:"javascript:;",className:"switchAction"+(this.state.approveFirst?" active":""),onClick:this.approve},this.state.loadingApprove&&React.createElement(GhostLoader,null),!this.state.loadingApprove&&"Approve "+this.props.stakingData.mainToken.symbol),window.walletAddress&&!this.state.approveFirst&&this.state.approveSecond&&React.createElement("a",{"data-target":"other",href:"javascript:;",className:"switchAction active",onClick:this.approve},this.state.loadingApprove&&React.createElement(GhostLoader,null),!this.state.loadingApprove&&"Approve "+this.state.approveSecond),window.walletAddress&&React.createElement("a",{href:"javascript:;",className:"switchAction"+(!this.state.approveFirst&&!this.state.approveSecond?" active":""),onClick:this.stake},this.state.loadingStake&&React.createElement(GhostLoader,null),!this.state.loadingStake&&"Stake"),!window.walletAddress&&React.createElement("a",{href:"javascript:;",onClick:function(){return window.ethereum.enable().then(function(){return window.getAddress()}).then(function(){return n.emit("ethereum/ping")})},className:"switchAction active"},"Connect")),React.createElement("p",null,"By Staking ",this.props.stakingData.mainToken.symbol," you'll earn from the Uniswap V2 Trading fees + the Staking Reward. Staking ",this.props.stakingData.mainToken.symbol," you're adding liquidity to Uniswap V2 and you'll recevie Pool Tokens."),React.createElement("p",null,"Disclamer: Staking ",this.props.stakingData.mainToken.symbol," is an irreversible action, you'll be able to redeem your locked Uniswap V2 tokens only after the selected locking period. Do it at your own risk")),React.createElement("section",null,React.createElement("section",{className:"statusBox"},React.createElement("h2",null,"Your Positions"),!window.walletAddress&&React.createElement("a",{href:"javascript:;",onClick:function(){return window.ethereum.enable().then(function(){return window.getAddress()}).then(function(){return n.emit("ethereum/ping")}).then(n.controller.load)},className:"switchAction active"},"Connect your Wallet"),window.walletAddress&&(!this.state||this.state.loadingPosition)&&React.createElement(LoaderMini,null),window.walletAddress&&(!this.state||!this.state.loadingPosition)&&this.state&&this.state.stakingPositions&&this.state.stakingPositions.map(function(e,r){return React.createElement("section",{className:"statusYou"},React.createElement("section",{className:"statusPosition"},React.createElement("h3",null,e.poolAmountFromDecimals),React.createElement("h6",{className:"statusUni"},"🦄 ",React.createElement("a",{href:"javascript:;"},"Uniswap-V2")),React.createElement("h6",null,React.createElement("b",null,t.props.stakingData.pairs[e.poolPosition].symbol,"-",t.props.stakingData.mainToken.symbol)),React.createElement("br",null),React.createElement("h6",null,"Locked Balance:"),React.createElement("h6",null,React.createElement("b",null,window.fromDecimals(e.myBalance,t.props.stakingData.mainToken.decimals)," ",t.props.stakingData.mainToken.symbol)),React.createElement("h6",null,React.createElement("b",null,window.fromDecimals(e.otherBalance,t.props.stakingData.pairs[e.poolPosition].decimals)," ",t.props.stakingData.pairs[e.poolPosition].symbol)),t.props.stakingData.endBlock&&React.createElement("section",null,t.state&&t.state.tryUnlock===r&&!t.state.rewardApproved&&React.createElement("a",{"data-target":"reward",href:"javascript:;",className:"switchAction switchActionMMINI"+(t.state.rewardApproved?"":" active"),onClick:t.approve},t.state.loadingApprove&&React.createElement(GhostLoader,null),!t.state.loadingApprove&&"Approve "+t.props.stakingData.rewardToken.symbol),t.state&&t.state.tryUnlock===r&&t.state.rewardApproved&&React.createElement("a",{className:"ActiveRedeem UnlockButton UnlockButtonPP"+(t.state.rewardApproved?"":" UnlockButtonDisabled"),href:"javascript:;",onClick:function(r){return t.controller.unlock(r,e.tier,e.position)}},t.state.unlocking&&React.createElement("img",{width:"25",src:"assets/img/ghostload.gif"}),!t.state.unlocking&&React.createElement("span",null,"🔓")),(!t.state||t.state.tryUnlock!==r)&&React.createElement("a",{className:"ActiveRedeem UnlockButton UnlockButtonPP",href:"javascript:;",onClick:function(o){return t.setState({tryUnlock:r},function(){return n.state.rewardApproved&&n.controller.unlock(o,e.tier,e.position)})}},"🔓"))),React.createElement("section",{className:"statusPosition"},React.createElement("h5",null,window.fromDecimals(e.reward,t.props.stakingData.rewardToken.decimals)," ",React.createElement("img",{src:window.formatLink(t.props.stakingData.rewardToken.logo)})),React.createElement("h6",null,"Locked Reward"),React.createElement("h5",null,React.createElement("b",null,window.fromDecimals(e.cumulativeReward,t.props.stakingData.rewardToken.decimals))," ",React.createElement("img",{src:window.formatLink(t.props.stakingData.rewardToken.logo)})),React.createElement("h6",null,"🎁 Redeemable"),React.createElement("a",{className:e.cumulativeReward!=="0"&&!e.canWithdraw?"ActiveRedeem":"NoRedeem",href:"javascript:;",onClick:function(r){return t.controller.redeem(r,e.tier,e.position)}},"Redeem")),React.createElement("section",{className:"statusPosition"},React.createElement("h4",null,"for ",React.createElement("b",null,n.getTierKey(e.tier))),React.createElement("h5",null,"⏳ ",React.createElement("a",{target:"_Bloank",href:window.getNetworkElement("etherscanURL")+"block/countdown/"+e.endBlock},e.endBlock)),React.createElement("h6",null,"Position End Block"),React.createElement("a",{className:e.canWithdraw?"ActiveRedeem":"NoRedeem",href:"javascript:;",onClick:function(r){return t.controller.withdraw(r,e.tier,e.position)}},"Withdraw Position")))}),(!this.state||!this.state.loadingPosition)&&this.state&&this.state.stakingPositions&&this.state.stakingPositions.length===0&&React.createElement("h3",null,"There are no opened staking positions for you right now")),React.createElement("section",{className:"statusBox"},React.createElement("h2",null,"🥩 Status:"),React.createElement("section",{className:"statusAll"},this.props.stakingData.tiers.map(function(e,t){return React.createElement(StakingInfo,{tier:t,title:e.tierKey,stake:n.props.stakingData.stakingManager,element:n.props.element,mainToken:n.props.stakingData.mainToken,rewardToken:n.props.stakingData.rewardToken})}))),React.createElement("section",{className:"ExpTop"},React.createElement("h1",null,"Instructions:"),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"This Liquidity Mining Mechanism is designed to reward ",React.createElement("a",{className:"FancyUni",href:"https://uniswap.info/token/0x7b123f53421b1bf8533339bfbdc7c98aa94163db"},"Uniswap V2")," liquidity Providers to lock long-term liquidity in Uniswap V2 ",React.createElement("a",{className:"FancyUni",href:"https://uniswap.info/pair/0xb0fb35cc576034b01bed6f4d0333b1bd3859615c"}),".")),React.createElement("h1",null,"🎁 Reward System"),React.createElement("h2",null,"The reward system is independent from the ",this.props.stakingData.rewardToken.symbol," price!"),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"Rewards are calculated based on how much ",this.props.stakingData.rewardToken.symbol," a holder provides to a liquidity pool, without any change in or dependency from other assets.")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"The reward amount is fixed, and depends on the locking period selected. The total reward of the staking position is divided and redeemable once a week!")),React.createElement("section",{className:"ExpPar"},React.createElement("h1",null,"🥩 Staking Rules"),React.createElement("p",null,"The ",this.props.stakingData.mainToken.symbol," staking reward is fixed and dependent on the lock tier selected. To ensure a fixed reward system for stakers, we have included a max ",this.props.stakingData.mainToken.symbol," cap of simultaneous staking positions that can be opened.")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"There are no individual staking limitations, and there is a minimum amount of ",this.props.stakingData.mainToken.symbol," to open a staking position (view the status Section).")),React.createElement("section",{className:"ExpPar"},React.createElement("h1",null,"⏩ How to Stake"),React.createElement("p",null,"Before you stake ",this.props.stakingData.mainToken.symbol,", consider that during the staking process you're actually adding liquidity to Uniswap V2, and so you'll receive back Uniswap V2 Pool tokens at the end of the staking period. What happens in the background is that you're adding liquidity to Uniswap V2 just as you would via the Uniswap GUI, but you're also locking the Uniswap V2 Tokens to receive ",this.props.stakingData.rewardToken.symbol," rewards. We kindly recommend that you read all of the Uniswap Liquidity Providers Documentation before staking, so that you can make an informed decision:"),React.createElement("p",null,React.createElement("a",{href:"https://docs.ethhub.io/guides/graphical-guide-for-understanding-uniswap/",target:"_Blank"},"Ethhub Uniswap Guide")," | ",React.createElement("a",{href:"https://uniswap.org/docs/v2/advanced-topics/understanding-returns/",target:"_Blank"},"Uniswap Returns Guide")," | ",React.createElement("a",{href:"https://medium.com/@pintail/understanding-uniswap-returns-cc593f3499ef",target:"_Blank"},"Advanced Uniswap Guide")," Keep in mind that staking buidl is an irreversible action. Do it at your own risk!")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,'To Stake Liquidity, all you have to do is to scroll up to the "Stake" Section and follow these steps:')),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,'#1 Connect you wallet, by clicking the "Connect" button'),React.createElement("p",null,"#2 Choose the quantity of ",this.props.stakingData.mainToken.symbol," you want to stake"),React.createElement("p",null,"#3 Select between the tier pool, and be sure you have the ammount required"),React.createElement("p",null,"#4 Select the lock duration"),React.createElement("p",null,'#5 If you haven’t already, click the "Approve" button'),React.createElement("p",null,"#6 Wait for the “Approval” transaction to confirm"),React.createElement("p",null,'#7 Start your staking transaction by clicking "Stake"'),React.createElement("p",null,"#8 Wait for the Staking Transaction to confirm..."),React.createElement("p",null,"... ",React.createElement("b",null,"Done!")," You have successfully Staked ",this.props.stakingData.mainToken.symbol,'. Now, you can manage your position in the "Status" page.')),React.createElement("section",{className:"ExpPar"},React.createElement("h1",null,"💰 How to reedem Staking and Rewards"),React.createElement("p",null,'Once you have successfully created a Staking Position, you can manage it on the "Your Positions" section:')),React.createElement("section",{className:"ExpPar"},React.createElement("h2",null,"Weekly Reward Withdraw"),React.createElement("p",null,"To Withdraw your weekly Reward from your position, just click the Withdraw Reward button. This button is designed to let you Withdraw all of your available unlocked rewards.")),React.createElement("section",{className:"ExpPar"},React.createElement("h2",null,"Position Withdraw"),React.createElement("p",null,'At the end of the Staking Period, you can use the "Withdraw Position" button to Withdraw all of your staked Uniswap V2 Pool Tokens, as well as your remaining rewards (if any).'),React.createElement("p",null,"To Withdraw your liquidity using your Uniswap V2 Liquidity Pool Tokens, you just have to go to the ",React.createElement("a",{href:"https://app.uniswap.org/#/pool",target:"_Blank"},"Uniswap GUI"),", select your Liquidity Pool and choose the amount to Withdraw.")))))}});var StakeOldController=function(t){var n=this;n.view=t,n.slippage=new UniswapFraction(window.context.slippageNumerator,window.context.slippageDenominator),n.calculateBalance=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 2:return t=s.sent,s.next=5,n.getSecondTokenData(e===undefined?n.pool.value.split("_")[0]:e);case 5:i=s.sent.balance,n.view.setState({firstBalance:t,secondBalance:i});case 7:case"end":return s.stop()}},r,this)}));return t}(),n.calculateApprove=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u,a,f,l,c;return regeneratorRuntime.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.t0=parseInt,h.next=3,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 3:return h.t1=h.sent,t=(0,h.t0)(h.t1),h.t2=parseInt,h.next=8,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.allowance,window.walletAddress,n.view.props.stakingData.stakingManager.options.address);case 8:h.t3=h.sent,i=(0,h.t2)(h.t3),s=i===0||i<t,o=!1,u=n.view.props.stakingData.pairs[e];if(u.symbol==="ETH"){h.next=25;break}return h.t4=parseInt,h.next=17,n.getSecondTokenData(e);case 17:return h.t5=h.sent.balance,a=(0,h.t4)(h.t5),h.t6=parseInt,h.next=22,window.blockchainCall(u.token.methods.allowance,window.walletAddress,n.view.props.stakingData.stakingManager.options.address);case 22:h.t7=h.sent,f=(0,h.t6)(h.t7),o=f===0||f<a?u.symbol:!1;case 25:return n.view.setState({approveFirst:s,approveSecond:o}),n.calculateBalance(e),h.t8=parseInt,h.next=30,window.blockchainCall(n.view.props.stakingData.rewardToken.token.methods.balanceOf,window.walletAddress);case 30:return h.t9=h.sent,l=(0,h.t8)(h.t9),h.t10=parseInt,h.next=35,window.blockchainCall(n.view.props.stakingData.rewardToken.token.methods.allowance,window.walletAddress,n.view.props.stakingData.stakingManager.options.address);case 35:h.t11=h.sent,c=(0,h.t10)(h.t11),n.view.setState({rewardApproved:c>=l});case 38:case"end":return h.stop()}},r,this)}));return t}(),n.approve=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.view.setState({loadingStake:!1,loadingApprove:!0}),i.prev=1,t=e==="reward"?n.view.props.stakingData.rewardToken.token:e==="mine"?n.view.props.stakingData.mainToken.token:n.view.props.stakingData.pairs[n.view.pool.value.split("_")[0]].token,i.t0=window,i.t1=t.methods.approve,i.t2=n.view.props.stakingData.stakingManager.options.address,i.next=8,window.blockchainCall(t.methods.totalSupply);case 8:return i.t3=i.sent,i.next=11,i.t0.blockchainCall.call(i.t0,i.t1,i.t2,i.t3);case 11:n.calculateApprove(parseInt(n.view.pool.value.split("_")[0])),i.next=16;break;case 14:i.prev=14,i.t4=i["catch"](1);case 16:n.view.setState({loadingStake:!1,loadingApprove:!1});case 17:case"end":return i.stop()}},r,this,[[1,14]])}));return t}(),n.max=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 2:s=a.sent;if(e!=="firstAmount"){a.next=8;break}return a.next=6,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.getStakingInfo,i);case 6:o=a.sent[1],parseInt(s)>parseInt(o)&&(s=o);case 8:return s=(new UniswapFraction(s,1)).divide(Math.pow(10,18)).toSignificant(6),a.t0=UniswapFraction,a.next=12,n.getSecondTokenData(t=t||0);case 12:a.t1=a.sent.balance,a.t2=Math.pow(10,t)===1?6:18,u=(new a.t0(a.t1,1)).divide(a.t2).toSignificant(6),n.view[e].value=e==="firstAmount"?s:u,e==="firstAmount"&&n.calculateReward(i),n.calculateOther(e,t,i);case 18:case"end":return a.stop()}},r,this)}));return t}(),n.changeSecond=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s=n.view.props.stakingData.pairs[t],a.next=3,window.blockchainCall(window.uniswapV2Factory.methods.getPair,n.view.props.stakingData.mainToken.address,s.address);case 3:o=a.sent,u=o!==window.voidEthereumAddress,n.view.setState({secondHasPair:u}),u&&n.calculateOther(e,t,i);case 7:case"end":return a.stop()}},r,this)}));return t}(),n.calculateOther=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n.view.state.secondHasPair){a.next=4;break}return s=new UniswapFraction(window.toDecimals(n.view[e==="firstAmount"?"secondAmount":"firstAmount"].value.split(",").join(""),(e==="firstAmount"?n.view.props.stakingData.pairs[t]:n.view.props.stakingData.mainToken).decimals)),e==="firstAmount"&&n.calculateReward(i),a.abrupt("return",s);case 4:return a.t0=n,a.next=7,n.getSecondTokenData(t,!0);case 7:return a.t1=a.sent.token,a.t2=t,a.next=11,a.t0.calculateReserves.call(a.t0,a.t1,a.t2);case 11:return o=a.sent,s=o[e==="firstAmount"?"secondPerBuidl":"buidlPerSecond"].multiply(window.toDecimals(n.view[e].value.split(",").join("")||"0",t===1?n.view.props.stakingData.pairs[t].decimals:n.view.props.stakingData.mainToken.decimals)),s=new UniswapFraction(s.toSignificant(100).split(".")[0]),u=(e!=="firstAmount"?s:s.divide(Math.pow(10,n.view.props.stakingData.pairs[t].decimals))).toSignificant(6),n.view[e==="firstAmount"?"secondAmount":"firstAmount"].value=window.formatMoney(u,u.split(".")[1]&&u.split(".")[1].length),e==="firstAmount"&&n.calculateReward(i),a.abrupt("return",s);case 18:case"end":return a.stop()}},r,this)}));return t}(),n.calculateReserves=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.t0=window,d.t1=window.context.uniSwapV2PairAbi,d.next=4,window.blockchainCall(window.uniswapV2Factory.methods.getPair,n.view.props.stakingData.mainToken.address,e.options.address);case 4:return d.t2=d.sent,i=d.t0.newContract.call(d.t0,d.t1,d.t2),d.next=8,window.blockchainCall(i.methods.token0);case 8:d.t3=d.sent.toLowerCase(),d.t4=n.view.props.stakingData.mainToken.address.toLowerCase();if(d.t3!==d.t4){d.next=14;break}d.t5=0,d.next=15;break;case 14:d.t5=1;case 15:return s=d.t5,o=s==0?1:0,d.next=19,window.blockchainCall(i.methods.getReserves);case 19:return u=d.sent,d.t6=parseInt,d.next=23,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.decimals);case 23:d.t7=d.sent,a=(0,d.t6)(d.t7);if(t!==0){d.next=29;break}d.t8=18,d.next=34;break;case 29:return d.t9=parseInt,d.next=32,window.blockchainCall(e.methods.decimals);case 32:d.t10=d.sent,d.t8=(0,d.t9)(d.t10);case 34:f=d.t8;if(a>f){l=a-f,c=(new UniswapFraction(u[s],1)).divide(Math.pow(10,l)).toSignificant(6);while(c.indexOf(".")!==-1)l--,c=(new UniswapFraction(u[s],1)).divide(Math.pow(10,l)).toSignificant(6);u[s]=c}return h=new UniswapFraction(u[s],u[o]),p=new UniswapFraction(u[o],u[s]),d.abrupt("return",{buidlPerSecond:h,secondPerBuidl:p});case 39:case"end":return d.stop()}},r,this)}));return t}(),n.calculateReward=function(t){setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,n.getTierData();case 3:e=o.sent,e=[e[1][t],e[2][t],e[3][t]],i=window.web3.utils.toBN(window.toDecimals(n.view.firstAmount.value.split(",").join(""),18)).mul(window.web3.utils.toBN(e[0])).div(window.web3.utils.toBN(e[1])).toString(),n.view.reward.innerText=window.formatMoney(window.fromDecimals(i,n.view.props.stakingData.mainToken.decimals,!0),18),s=window.web3.utils.toBN(i).div(window.web3.utils.toBN(e[2])),n.view.splittedReward.innerText=window.formatMoney(window.fromDecimals(s,n.view.props.stakingData.mainToken.decimals,!0),18),o.next=13;break;case 11:o.prev=11,o.t0=o["catch"](0);case 13:case"end":return o.stop()}},r,this,[[0,11]])})))},n.getSecondTokenData=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:i=n.view.props.stakingData.pairs[e],o.t0=i.token;if(t!==!0){o.next=6;break}o.t1="0",o.next=9;break;case 6:return o.next=8,i.symbol==="ETH"?window.web3.eth.getBalance(window.walletAddress):window.blockchainCall(i.token.methods.balanceOf,window.walletAddress);case 8:o.t1=o.sent;case 9:return o.t2=o.t1,s={token:o.t0,balance:o.t2},isNaN(parseInt(s.balance))&&(s.balance="0"),o.abrupt("return",s);case 13:case"end":return o.stop()}},r,this)}));return t}(),n.getTierData=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0;if(n.view.tierData){t.next=5;break}return t.next=4,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.tierData);case 4:n.view.tierData=t.sent;case 5:return t.abrupt("return",JSON.parse(JSON.stringify(n.view.tierData)));case 8:return t.prev=8,t.t0=t["catch"](0),t.abrupt("return",[]);case 11:case"end":return t.stop()}},r,this,[[0,8]])}));return t}(),n.stake=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o,u,a,f,l,c,h;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return i=window.toDecimals(n.view.firstAmount.value.split(",").join(""),n.view.props.stakingData.mainToken.decimals),p.next=3,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.getStakingInfo,t);case 3:return s=p.sent,p.next=6,window.blockchainCall(n.view.props.stakingData.mainToken.token.methods.balanceOf,window.walletAddress);case 6:o=p.sent;if(!(parseInt(i)<parseInt(s[0]))){p.next=9;break}return p.abrupt("return",alert("Amount to stake is less than the current min cap"));case 9:if(!(parseInt(i)>parseInt(s[2]))){p.next=11;break}return p.abrupt("return",alert("Amount to stake must be less than the current remaining one"));case 11:if(!(parseInt(i)>parseInt(o))){p.next=13;break}return p.abrupt("return",alert("You don't have enough "+n.view.props.stakingData.mainToken.symbol+" balance to stake!"));case 13:return n.view.setState({staked:null,loadingStake:!0,loadingApprove:!1}),i=new UniswapFraction(i,1),p.next=17,n.calculateOther("firstAmount",e,t);case 17:return u=p.sent,a=i.subtract(i.multiply(n.slippage)).toSignificant(100).split(".")[0],f=u.subtract(u.multiply(n.slippage)).toSignificant(100).split(".")[0],i=i.toSignificant(100).split(".")[0],u=u.toSignificant(100).split(".")[0],p.t0=parseInt(u),p.t1=parseInt,p.next=26,n.getSecondTokenData(e);case 26:p.t2=p.sent,p.t3=(0,p.t1)(p.t2).balance;if(!(p.t0>p.t3)){p.next=30;break}return p.abrupt("return",alert("You don't have enough "+n.view.props.stakingData.pairs[e].symbol+" balance to stake!"));case 30:return p.t4=window.web3.utils,p.next=33,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.tokens);case 33:return p.t5=e,p.t6=p.sent[p.t5],l=p.t4.toChecksumAddress.call(p.t4,p.t6),c=l===window.wethAddress?u:undefined,h=l===window.wethAddress?"0":u,p.prev=38,p.next=41,window.blockchainCall(c,n.view.props.stakingData.stakingManager.methods.stake,t,e+"",i,a,h,f);case 41:n.view.setState({staked:{amount:n.view.firstAmount.value,period:n.view.props.stakingData.tiers[t].tierKey}},function(){n.view.emit("ethereum/ping"),n.view.emit("staking/refresh")}),p.next=47;break;case 44:p.prev=44,p.t7=p["catch"](38),(p.t7.message||p.t7).toLowerCase().indexOf("user denied")===-1&&alert(p.t7.message||p.t7);case 47:n.view.setState({loadingStake:!1,loadingApprove:!1});case 48:case"end":return p.stop()}},r,this,[[38,44]])}));return t}(),n.load=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a,f,l,c,h,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(window.walletAddress){d.next=2;break}return d.abrupt("return");case 2:n.view.setState({loadingPosition:!0}),d.t0=n.view.pool;if(!d.t0){d.next=7;break}return d.next=7,n.changeSecond("firstAmount",parseInt(n.view.pool.value.split("_")[0]),n.view.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier);case 7:return d.next=9,n.calculateApprove(parseInt(n.view.pool?n.view.pool.value.split("_")[0]:0));case 9:return d.next=11,window.web3.eth.getBlockNumber();case 11:e=d.sent,t=[],i=0;case 14:if(!(i<n.view.props.stakingData.tiers.length)){d.next=60;break}return d.t1=parseInt,d.next=18,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.length,i);case 18:d.t2=d.sent,s=(0,d.t1)(d.t2),o=0;case 21:if(!(o<s)){d.next=57;break}return d.next=24,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.stakeInfo,i,o);case 24:u=d.sent;if(window.walletAddress.toLowerCase()===u[0].toLowerCase()){d.next=27;break}return d.abrupt("continue",54);case 27:a={position:o,tier:i,sender:u[0],poolPosition:u[1],firstAmount:u[2],secondAmount:u[3],poolAmount:u[4],reward:u[5],endBlock:u[6],partialRewardBlockTimes:u[7],splittedReward:u[8],cumulativeReward:"0"},a.poolAmountFromDecimals=(new UniswapFraction(a.poolAmount,1)).divide(Math.pow(10,18)).toSignificant(6),a.canWithdraw=e>=parseInt(a.endBlock),f=a.partialRewardBlockTimes,l=Array.isArray(f),c=0,f=l?f:f[Symbol.iterator]();case 31:if(!l){d.next=37;break}if(!(c>=f.length)){d.next=34;break}return d.abrupt("break",50);case 34:h=f[c++],d.next=41;break;case 37:c=f.next();if(!c.done){d.next=40;break}return d.abrupt("break",50);case 40:h=c.value;case 41:p=h;if(p!=="0"){d.next=44;break}return d.abrupt("continue",48);case 44:a.nextPartialReward=a.nextPartialReward||p;if(!(e<parseInt(p))){d.next=47;break}return d.abrupt("continue",48);case 47:a.cumulativeReward=window.web3.utils.toBN(a.cumulativeReward).add(window.web3.utils.toBN(a.splittedReward)).toString();case 48:d.next=31;break;case 50:return a.cumulativeReward=parseInt(a.cumulativeReward)>parseInt(a.reward)?a.reward:a.cumulativeReward,d.next=53,n.loadUniswapPoolAmounts(a);case 53:t.push(a);case 54:o++,d.next=21;break;case 57:i++,d.next=14;break;case 60:n.view.setState({loadingPosition:!1,stakingPositions:t});case 61:case"end":return d.stop()}},r,this)}));return t}(),n.loadUniswapPoolAmounts=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u,a,f,l;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=n.view.props.stakingData.pairs[e.poolPosition].address,c.t0=window,c.t1=window.context.uniSwapV2PairAbi,c.next=5,window.blockchainCall(window.uniswapV2Factory.methods.getPair,t,n.view.props.stakingData.mainToken.address);case 5:return c.t2=c.sent,i=c.t0.newContract.call(c.t0,c.t1,c.t2),c.next=9,window.blockchainCall(i.methods.token0);case 9:return s=c.sent,c.next=12,window.blockchainCall(i.methods.getReserves);case 12:return o=c.sent,c.next=15,window.blockchainCall(i.methods.totalSupply);case 15:u=c.sent,a=parseInt(e.poolAmount)/parseInt(u),f=window.numberToString(parseInt(o[0])*a).split(",").join("").split(".")[0],l=window.numberToString(parseInt(o[1])*a).split(",").join("").split(".")[0],s===n.view.props.stakingData.mainToken.address?(e.myBalance=f,e.otherBalance=l):(e.myBalance=l,e.otherBalance=f);case 20:case"end":return c.stop()}},r,this)}));return t}(),n.redeem=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0);if(!$(e.currentTarget).hasClass("NoRedeem")){s.next=3;break}return s.abrupt("return");case 3:return s.next=5,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.partialReward,t,i);case 5:n.load();case 6:case"end":return s.stop()}},r,this)}));return t}(),n.withdraw=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0);if(!$(e.currentTarget).hasClass("NoRedeem")){s.next=3;break}return s.abrupt("return");case 3:return s.next=5,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.withdraw,t,i);case 5:n.load();case 6:case"end":return s.stop()}},r,this)}));return t}(),n.unlock=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:e&&e.preventDefault&&e.preventDefault(!0)&&e.stopPropagation&&e.stopPropagation(!0);if(!$(e.currentTarget).hasClass("UnlockButtonDisabled")){s.next=3;break}return s.abrupt("return");case 3:return n.view.setState({unlocking:!0}),s.prev=4,s.next=7,window.blockchainCall(n.view.props.stakingData.stakingManager.methods.unlock,t,i);case 7:n.load(),s.next=13;break;case 10:s.prev=10,s.t0=s["catch"](4),(s.t0.message||s.t0).toLowerCase().indexOf("user denied")===-1&&alert("Transaction fail ("+(s.t0.message||s.t0)+"), maybe an old version of the Liquidity Mining Contract");case 13:n.view.setState({unlocking:!1});case 14:case"end":return s.stop()}},r,this,[[4,10]])}));return t}()};var StakeOld=React.createClass({displayName:"StakeOld",requiredScripts:["spa/loader.jsx","spa/bigLoader.jsx","spa/ghostLoader.jsx","spa/loaderMini.jsx"],requiredModules:["spa/stakingInfo"],getDefaultSubscriptions:function(){return{"ethereum/ping":this.controller.load}},getInitialState:function(){return{approveFirst:!0,approveSecond:!0}},onTier:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),$($(t.currentTarget).parent()).children("a").each(function(){$(this).removeClass("SelectedDutrationStake")}),$(t.currentTarget).addClass("SelectedDutrationStake"),this.controller.calculateReward(parseInt(t.currentTarget.dataset.tier))},changeSecond:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget.value.split("_");this.logo.src=window.formatLink(this.props.stakingData.pairs[n[0]].logo),this.controller.changeSecond("firstAmount",parseInt(this.pool.value.split("_")[0]),this.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier),this.controller.calculateApprove(parseInt(this.pool.value.split("_")[0]))},max:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.controller.max(t.currentTarget.dataset.target,parseInt(this.pool.value.split("_")[0]),this.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier)},onChangeAmount:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this,r=t.currentTarget;n.changeTimeout&&clearTimeout(n.changeTimeout),n.changeTimeout=setTimeout(function(){n.controller.calculateOther(r.dataset.target,parseInt(n.pool.value.split("_")[0]),n.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier)},window.context.inputChangeTimeout||300)},approve:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(!$(t.currentTarget).hasClass("active")||this.state.loadingStake||this.state.loadingApprove)return;this.controller.approve(t.currentTarget.dataset.target)},stake:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(!$(t.currentTarget).hasClass("active")||this.state.loadingStake||this.state.loadingApprove)return;this.controller.stake(parseInt(this.pool.value.split("_")[0]),this.domRoot.children().find(".TimetoStake.SelectedDutrationStake")[0].dataset.tier)},componentDidMount:function(){window.history.pushState({},"",window.getLink()+"?staking="+this.props.stakingData.stakingManager.options.address),this.controller.load()},firstTier:function(t){$(t).children(".SelectedDutrationStake").length===0&&$($(t).children()[0]).addClass("SelectedDutrationStake")},getTierKey:function(t){var n=this.props.stakingData.tiers[t];return n.tierKey==="Custom"?n.blockNumber+" blocks":n.tierKey},close:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),window.history.pushState({},"",window.getLink()),this.emit("stake/close")},render:function(){var t=this,n=this;return React.createElement("section",{className:"StakeBigBoss STAKEALL",style:{position:"fixed"}},React.createElement("a",{className:"NoStakeBro",href:"javascript:;",onClick:this.close},"Close"),this.state&&this.state.staked&&React.createElement("section",{className:"boxAYORT"},React.createElement("section",{className:"boxAYORTTEXT"},React.createElement("h2",null,"🎉 🥩 Staked! 🥩 🎉"),React.createElement("p",null,"You have succesfully staked ",React.createElement("b",null,this.state.staked.amount)," ",this.props.stakingData.mainToken.symbol," for ",React.createElement("b",null,this.state.staked.period,"!")," Check the ",React.createElement("a",{href:"javascript:;",onClick:function(){return t.emit("view/change","Status")}},"Status")," page to manage your Staking Position. "))),this.props.stakingData.active&&React.createElement("section",{className:"switchBox"},React.createElement("h3",null,"Stake"),React.createElement("section",{className:"switchTools"},React.createElement("a",{"data-target":"firstAmount",href:"javascript:;",className:"switchAll",onClick:this.max},"Max"),React.createElement("input",{ref:function(n){return t.firstAmount=n},type:"text",placeholder:"0.00",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$","data-target":"firstAmount",onChange:this.onChangeAmount}),React.createElement("aside",{className:"switchLink",target:"_blank"},this.props.stakingData.mainToken.symbol),React.createElement("img",{src:window.formatLink(this.props.stakingData.mainToken.logo||this.props.stakingData.mainToken.logoURI)}),this.state&&this.state.firstBalance&&[React.createElement("br",null),React.createElement("br",null),React.createElement("section",{className:"BalanceLabel"},React.createElement("span",null,"Balance:"),React.createElement("span",null,window.fromDecimals(this.state.firstBalance,this.props.stakingData.mainToken.decimals)),React.createElement("span",null,this.props.stakingData.mainToken.symbol))]),React.createElement("section",{className:"switchTools switchTools2"},!this.state.secondHasPair&&React.createElement("a",{"data-target":"secondAmount",href:"javascript:;",className:"switchAll",onClick:this.max},"Max"),React.createElement("input",{className:"ETHUSDBLOW",ref:function(n){return t.secondAmount=n},type:"text",placeholder:"0.00",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$","data-target":"secondAmount",disabled:this.state.secondHasPair}),React.createElement("select",{ref:function(n){return t.pool=n},className:"switchLink",target:"_blank",onChange:this.changeSecond},this.props.stakingData.pairs.map(function(e,t){return React.createElement("option",{key:e.address,"data-index":t,value:t+"_"+e.symbol},e.symbol)})),React.createElement("img",{ref:function(n){return t.logo=n},src:window.formatLink(this.props.stakingData.pairs[0].logo)}),this.state&&this.state.secondBalance&&this.pool&&[React.createElement("br",null),React.createElement("br",null),React.createElement("section",{className:"BalanceLabel"},React.createElement("span",null,"Balance:"),React.createElement("span",null,window.fromDecimals(this.state.secondBalance,this.props.stakingData.pairs[this.pool.value.split("_")[0]].decimals)),React.createElement("span",null,this.props.stakingData.pairs[this.pool.value.split("_")[0]].symbol))]),!this.state.secondHasPair&&React.createElement("h3",null,"You are the first putting liquidity in this pair!"),React.createElement("h3",null,"⏳ Duration"),React.createElement("section",{className:"switchTools",ref:this.firstTier},this.props.stakingData.tiers.map(function(e,n){return React.createElement("a",{key:e.tierKey,"data-tier":n,className:"TimetoStake",href:"javascript:;",onClick:t.onTier},e.tierKey!=="Custom"?e.tierKey:"For "+e.blockNumber+" blocks")})),React.createElement("h3",null,"🎁 Total Reward"),React.createElement("section",{className:"switchTools"},React.createElement("span",{ref:function(n){return t.reward=n},className:"switchFinal"},window.formatMoney(0)),React.createElement("aside",{className:"switchLink"},this.props.stakingData.rewardToken.symbol),React.createElement("img",{src:window.formatLink(this.props.stakingData.rewardToken.logo||this.props.stakingData.rewardToken.logoURI)})),React.createElement("h3",{className:"switchWeek"},"Weekly"),React.createElement("section",{className:"switchTools switchToolsWeek"},React.createElement("span",{ref:function(n){return t.splittedReward=n},className:"switchFinal"},window.formatMoney(0)),React.createElement("aside",{className:"switchLink"},this.props.stakingData.rewardToken.symbol),React.createElement("img",{src:window.formatLink(this.props.stakingData.rewardToken.logo||this.props.stakingData.rewardToken.logoURI)})),React.createElement("section",{className:"switchActions"},window.walletAddress&&(this.state.approveFirst||!this.state.approveSecond)&&React.createElement("a",{"data-target":"mine",href:"javascript:;",className:"switchAction"+(this.state.approveFirst?" active":""),onClick:this.approve},this.state.loadingApprove&&React.createElement(GhostLoader,null),!this.state.loadingApprove&&"Approve "+this.props.stakingData.mainToken.symbol),window.walletAddress&&!this.state.approveFirst&&this.state.approveSecond&&React.createElement("a",{"data-target":"other",href:"javascript:;",className:"switchAction active",onClick:this.approve},this.state.loadingApprove&&React.createElement(GhostLoader,null),!this.state.loadingApprove&&"Approve "+this.state.approveSecond),window.walletAddress&&React.createElement("a",{href:"javascript:;",className:"switchAction"+(!this.state.approveFirst&&!this.state.approveSecond?" active":""),onClick:this.stake},this.state.loadingStake&&React.createElement(GhostLoader,null),!this.state.loadingStake&&"Stake"),!window.walletAddress&&React.createElement("a",{href:"javascript:;",onClick:function(){return window.ethereum.enable().then(function(){return window.getAddress()}).then(function(){return n.emit("ethereum/ping")})},className:"switchAction active"},"Connect")),React.createElement("p",null,"By Staking ",this.props.stakingData.mainToken.symbol," you'll earn from the Uniswap V2 Trading fees + the Staking Reward. Staking ",this.props.stakingData.mainToken.symbol," you're adding liquidity to Uniswap V2 and you'll recevie Pool Tokens."),React.createElement("p",null,"Disclamer: Staking ",this.props.stakingData.mainToken.symbol," is an irreversible action, you'll be able to redeem your locked Uniswap V2 tokens only after the selected locking period. Do it at your own risk")),React.createElement("section",null,React.createElement("section",{className:"statusBox"},React.createElement("h2",null,"Your Positions"),!window.walletAddress&&React.createElement("a",{href:"javascript:;",onClick:function(){return window.ethereum.enable().then(function(){return window.getAddress()}).then(function(){return n.emit("ethereum/ping")}).then(n.controller.load)},className:"switchAction active"},"Connect your Wallet"),window.walletAddress&&(!this.state||this.state.loadingPosition)&&React.createElement(LoaderMini,null),window.walletAddress&&(!this.state||!this.state.loadingPosition)&&this.state&&this.state.stakingPositions&&this.state.stakingPositions.map(function(e,r){return React.createElement("section",{className:"statusYou"},React.createElement("section",{className:"statusPosition"},React.createElement("h3",null,e.poolAmountFromDecimals),React.createElement("h6",{className:"statusUni"},"🦄 ",React.createElement("a",{href:"javascript:;"},"Uniswap-V2")),React.createElement("h6",null,React.createElement("b",null,t.props.stakingData.pairs[e.poolPosition].symbol,"-",t.props.stakingData.mainToken.symbol)),React.createElement("br",null),React.createElement("h6",null,"Locked Balance:"),React.createElement("h6",null,React.createElement("b",null,window.fromDecimals(e.myBalance,t.props.stakingData.mainToken.decimals)," ",t.props.stakingData.mainToken.symbol)),React.createElement("h6",null,React.createElement("b",null,window.fromDecimals(e.otherBalance,t.props.stakingData.pairs[e.poolPosition].decimals)," ",t.props.stakingData.pairs[e.poolPosition].symbol)),t.props.stakingData.endBlock&&React.createElement("section",null,t.state&&t.state.tryUnlock===r&&!t.state.rewardApproved&&React.createElement("a",{"data-target":"reward",href:"javascript:;",className:"switchAction switchActionMMINI"+(t.state.rewardApproved?"":" active"),onClick:t.approve},t.state.loadingApprove&&React.createElement(GhostLoader,null),!t.state.loadingApprove&&"Approve "+t.props.stakingData.rewardToken.symbol),t.state&&t.state.tryUnlock===r&&t.state.rewardApproved&&React.createElement("a",{className:"ActiveRedeem UnlockButton UnlockButtonPP"+(t.state.rewardApproved?"":" UnlockButtonDisabled"),href:"javascript:;",onClick:function(r){return t.controller.unlock(r,e.tier,e.position)}},t.state.unlocking&&React.createElement("img",{width:"25",src:"assets/img/ghostload.gif"}),!t.state.unlocking&&React.createElement("span",null,"🔓")),(!t.state||t.state.tryUnlock!==r)&&React.createElement("a",{className:"ActiveRedeem UnlockButton UnlockButtonPP",href:"javascript:;",onClick:function(o){return t.setState({tryUnlock:r},function(){return n.state.rewardApproved&&n.controller.unlock(o,e.tier,e.position)})}},"🔓"))),React.createElement("section",{className:"statusPosition"},React.createElement("h5",null,window.fromDecimals(e.reward,t.props.stakingData.rewardToken.decimals)," ",React.createElement("img",{src:window.formatLink(t.props.stakingData.rewardToken.logo)})),React.createElement("h6",null,"Locked Reward"),React.createElement("h5",null,React.createElement("b",null,window.fromDecimals(e.cumulativeReward,t.props.stakingData.rewardToken.decimals))," ",React.createElement("img",{src:window.formatLink(t.props.stakingData.rewardToken.logo)})),React.createElement("h6",null,"🎁 Redeemable"),React.createElement("a",{className:e.cumulativeReward!=="0"&&!e.canWithdraw?"ActiveRedeem":"NoRedeem",href:"javascript:;",onClick:function(r){return t.controller.redeem(r,e.tier,e.position)}},"Redeem")),React.createElement("section",{className:"statusPosition"},React.createElement("h4",null,"for ",React.createElement("b",null,n.getTierKey(e.tier))),React.createElement("h5",null,"⏳ ",React.createElement("a",{target:"_Bloank",href:window.getNetworkElement("etherscanURL")+"block/countdown/"+e.endBlock},e.endBlock)),React.createElement("h6",null,"Position End Block"),React.createElement("a",{className:e.canWithdraw?"ActiveRedeem":"NoRedeem",href:"javascript:;",onClick:function(r){return t.controller.withdraw(r,e.tier,e.position)}},"Withdraw Position")))}),(!this.state||!this.state.loadingPosition)&&this.state&&this.state.stakingPositions&&this.state.stakingPositions.length===0&&React.createElement("h3",null,"There are no opened staking positions for you right now")),React.createElement("section",{className:"statusBox"},React.createElement("h2",null,"🥩 Status:"),React.createElement("section",{className:"statusAll"},this.props.stakingData.tiers.map(function(e,t){return React.createElement(StakingInfo,{tier:t,title:e.tierKey,stake:n.props.stakingData.stakingManager,element:n.props.element,mainToken:n.props.stakingData.mainToken,rewardToken:n.props.stakingData.rewardToken})}))),React.createElement("section",{className:"ExpTop"},React.createElement("h1",null,"Instructions:"),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"This Liquidity Mining Mechanism is designed to reward ",React.createElement("a",{className:"FancyUni",href:"https://uniswap.info/token/0x7b123f53421b1bf8533339bfbdc7c98aa94163db"},"Uniswap V2")," liquidity Providers to lock long-term liquidity in Uniswap V2 ",React.createElement("a",{className:"FancyUni",href:"https://uniswap.info/pair/0xb0fb35cc576034b01bed6f4d0333b1bd3859615c"}),".")),React.createElement("h1",null,"🎁 Reward System"),React.createElement("h2",null,"The reward system is independent from the ",this.props.stakingData.rewardToken.symbol," price!"),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"Rewards are calculated based on how much ",this.props.stakingData.rewardToken.symbol," a holder provides to a liquidity pool, without any change in or dependency from other assets.")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"The reward amount is fixed, and depends on the locking period selected. The total reward of the staking position is divided and redeemable once a week!")),React.createElement("section",{className:"ExpPar"},React.createElement("h1",null,"🥩 Staking Rules"),React.createElement("p",null,"The ",this.props.stakingData.mainToken.symbol," staking reward is fixed and dependent on the lock tier selected. To ensure a fixed reward system for stakers, we have included a max ",this.props.stakingData.mainToken.symbol," cap of simultaneous staking positions that can be opened.")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,"There are no individual staking limitations, and there is a minimum amount of ",this.props.stakingData.mainToken.symbol," to open a staking position (view the status Section).")),React.createElement("section",{className:"ExpPar"},React.createElement("h1",null,"⏩ How to Stake"),React.createElement("p",null,"Before you stake ",this.props.stakingData.mainToken.symbol,", consider that during the staking process you're actually adding liquidity to Uniswap V2, and so you'll receive back Uniswap V2 Pool tokens at the end of the staking period. What happens in the background is that you're adding liquidity to Uniswap V2 just as you would via the Uniswap GUI, but you're also locking the Uniswap V2 Tokens to receive ",this.props.stakingData.rewardToken.symbol," rewards. We kindly recommend that you read all of the Uniswap Liquidity Providers Documentation before staking, so that you can make an informed decision:"),React.createElement("p",null,React.createElement("a",{href:"https://docs.ethhub.io/guides/graphical-guide-for-understanding-uniswap/",target:"_Blank"},"Ethhub Uniswap Guide")," | ",React.createElement("a",{href:"https://uniswap.org/docs/v2/advanced-topics/understanding-returns/",target:"_Blank"},"Uniswap Returns Guide")," | ",React.createElement("a",{href:"https://medium.com/@pintail/understanding-uniswap-returns-cc593f3499ef",target:"_Blank"},"Advanced Uniswap Guide")," Keep in mind that staking buidl is an irreversible action. Do it at your own risk!")),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,'To Stake Liquidity, all you have to do is to scroll up to the "Stake" Section and follow these steps:')),React.createElement("section",{className:"ExpPar"},React.createElement("p",null,'#1 Connect you wallet, by clicking the "Connect" button'),React.createElement("p",null,"#2 Choose the quantity of ",this.props.stakingData.mainToken.symbol," you want to stake"),React.createElement("p",null,"#3 Select between the tier pool, and be sure you have the ammount required"),React.createElement("p",null,"#4 Select the lock duration"),React.createElement("p",null,'#5 If you haven’t already, click the "Approve" button'),React.createElement("p",null,"#6 Wait for the “Approval” transaction to confirm"),React.createElement("p",null,'#7 Start your staking transaction by clicking "Stake"'),React.createElement("p",null,"#8 Wait for the Staking Transaction to confirm..."),React.createElement("p",null,"... ",React.createElement("b",null,"Done!")," You have successfully Staked ",this.props.stakingData.mainToken.symbol,'. Now, you can manage your position in the "Status" page.')),React.createElement("section",{className:"ExpPar"},React.createElement("h1",null,"💰 How to reedem Staking and Rewards"),React.createElement("p",null,'Once you have successfully created a Staking Position, you can manage it on the "Your Positions" section:')),React.createElement("section",{className:"ExpPar"},React.createElement("h2",null,"Weekly Reward Withdraw"),React.createElement("p",null,"To Withdraw your weekly Reward from your position, just click the Withdraw Reward button. This button is designed to let you Withdraw all of your available unlocked rewards.")),React.createElement("section",{className:"ExpPar"},React.createElement("h2",null,"Position Withdraw"),React.createElement("p",null,'At the end of the Staking Period, you can use the "Withdraw Position" button to Withdraw all of your staked Uniswap V2 Pool Tokens, as well as your remaining rewards (if any).'),React.createElement("p",null,"To Withdraw your liquidity using your Uniswap V2 Liquidity Pool Tokens, you just have to go to the ",React.createElement("a",{href:"https://app.uniswap.org/#/pool",target:"_Blank"},"Uniswap GUI"),", select your Liquidity Pool and choose the amount to Withdraw.")))))}});var StakingInfoController=function(t){var n=this;n.view=t,n.load=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function n(e,t){var r;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e.setState({loading:!0}),i.next=3,window.blockchainCall(e.props.stake.methods.getStakingInfo,t);case 3:r=i.sent,e.setState({loading:!1,minCap:r[0],staked:window.web3.utils.toBN(r[1]).sub(window.web3.utils.toBN(r[2])).toString(),available:r[2]});case 5:case"end":return i.stop()}},n,this)}));return t}()};var StakingInfo=React.createClass({displayName:"StakingInfo",requiredScripts:["spa/loader.jsx","spa/bigLoader.jsx"],getDefaultSubscriptions:function(){return{"ethereum/ping":this.componentDidMount}},componentDidMount:function(){this.controller.load(this,this.props.tier)},render:function(){return!this.state||this.state.loading?React.createElement(Loader,null):React.createElement("section",{className:"statusTier"},React.createElement("h3",null,this.props.title),React.createElement("h4",{className:"TierStaked"},React.createElement("b",null,window.fromDecimals(this.state.minCap,this.props.mainToken.decimals))," ",React.createElement("img",{src:window.formatLink(this.props.mainToken.logo||this.props.mainToken.logoURI)})),React.createElement("h6",{className:"TierStaked"},"Min Stake"),React.createElement("h4",{className:"TierStaked"},window.fromDecimals(this.state.staked,this.props.mainToken.decimals)," ",React.createElement("img",{src:window.formatLink(this.props.mainToken.logo||this.props.mainToken.logoURI)})),React.createElement("h6",{className:"TierStaked"},"Staked"),React.createElement("h4",{className:"TierFree"},React.createElement("b",null,window.fromDecimals(this.state.available,this.props.rewardToken.decimals))," ",React.createElement("img",{src:window.formatLink(this.props.rewardToken.logo||this.props.rewardToken.logoURI)})),React.createElement("h6",{className:"TierFree"},"Available"))}});var StateController=function(t){var n=this;n.view=t,n.load=function(t){t=t||n.view,t.setState({stateElements:null,stateElementsAmount:null},_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,i,s,o,u;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e=[],a.t0=t,a.t1=e,a.t2=parseInt,a.next=7,window.blockchainCall(t.props.element.stateHolder.methods.getStateSize);case 7:return a.t3=a.sent,a.t4=(0,a.t2)(a.t3),a.t5={stateElements:a.t1,stateElementsAmount:a.t4},a.t0.setState.call(a.t0,a.t5),a.next=13,window.blockchainCall(t.props.element.stateHolder.methods.toJSON);case 13:i=a.sent;if(t===n.view){a.next=16;break}return a.abrupt("return");case 16:i=JSON.parse(i.endsWith(",]")?i.substring(0,i.lastIndexOf(",]"))+"]":i),a.t6=regeneratorRuntime.keys(i);case 18:if((a.t7=a.t6()).done){a.next=31;break}return s=a.t7.value,o=i[s],u="get"+o.type.substring(0,1).toUpperCase()+o.type.substring(1),a.next=24,window.blockchainCall(t.props.element.stateHolder.methods[u],o.name);case 24:o.value=a.sent;if(t===n.view){a.next=27;break}return a.abrupt("return");case 27:e.push(o),t.setState({stateElements:e}),a.next=18;break;case 31:a.next=36;break;case 33:a.prev=33,a.t8=a["catch"](0),t.setState({unsupportedRnDVersion:!0});case 36:case"end":return a.stop()}},r,this,[[0,33]])})))},n.proposeStateElement=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u,a;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:s=n.view;if(t!==undefined&&t!==null&&t!==""){f.next=3;break}throw"You must insert a valid value for "+e.name;case 3:if(e.value!==t){f.next=5;break}return f.abrupt("return");case 5:if(e.type!=="address"||!!window.isEthereumAddress(t)){f.next=7;break}throw"Value for "+e.name+" must be a valid Ethereum address";case 7:if(e.type!=="uint256"||!(isNaN(parseInt(t))||parseInt(t)<0)){f.next=9;break}throw"Value for "+e.name+" must be a valid number greater or equal to 0";case 9:t=e.type!=="bool"?t:t+""=="true",o=e.type==="string"?'"':"",u="holder.set"+e.type.firstLetterToUpperCase()+'("'+e.name+'", '+o+t+o+");",a="Changing "+e.name+" value from "+e.value+" to "+t;if(!i){f.next=15;break}return f.abrupt("return",{line:u,description:a});case 15:window.sendGeneratedProposal(s.props.element,{title:"Proposal for "+a.firstLetterToLowerCase()},window.context.stateHolderProposalTemplate,[u],[a]);case 16:case"end":return f.stop()}},r,this)}));return t}(),n.clearStateElement=function(){function t(t,n){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t){var i,s,o;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:i=n.view,s='holder.clear("'+e.name+'");',o="Clearing "+e.name+" value";if(t!==!0){u.next=5;break}return u.abrupt("return",{line:s,description:o});case 5:window.sendGeneratedProposal(i.props.element,{title:"Proposal for "+o.firstLetterToLowerCase()},window.context.stateHolderProposalTemplate,[s],[o]);case 6:case"end":return u.stop()}},r,this)}));return t}(),n.changeAll=function(){function t(t){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e){var t,i,s,o,u,a,f;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:t=n.view,i=[],s=[],o=[],l.t0=regeneratorRuntime.keys(e);case 5:if((l.t1=l.t0()).done){l.next=20;break}return u=l.t1.value,a=e[u],l.prev=8,l.next=11,a.clear?n.clearStateElement(a.stateElement,!0):n.saveStateElement(a.stateElement,a.value,!0);case 11:f=l.sent,f&&(s.push(f.line),o.push(f.description)),l.next=18;break;case 15:l.prev=15,l.t2=l["catch"](8),i.push(l.t2.message||l.t2);case 18:l.next=5;break;case 20:if(!(i.length>0)){l.next=22;break}throw i.join("\n").trim();case 22:if(s.length!==0){l.next=24;break}return l.abrupt("return");case 24:window.sendGeneratedProposal(t.props.element,{title:o.length>1?"StateHolder change":"Proposal for "+o[0].firstLetterToLowerCase()},window.context.stateHolderProposalTemplate,s,o);case 25:case"end":return l.stop()}},r,this,[[8,15]])}));return t}(),n.addNew=function(){function t(t,n,r){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(e,t,i){var s,o,u,a,f;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:s=n.view;if(i!==undefined&&i!==null&&i!==""){l.next=3;break}return l.abrupt("return");case 3:e=e?e.trim():e;if(e){l.next=6;break}throw"Name is mandatory";case 6:l.t0=regeneratorRuntime.keys(s.state.stateElements);case 7:if((l.t1=l.t0()).done){l.next=13;break}o=l.t1.value;if(e!==s.state.stateElements[o].name){l.next=11;break}throw e+" is already used for another state name";case 11:l.next=7;break;case 13:if(t!=="address"||!!window.isEthereumAddress(i)){l.next=15;break}throw"Value for "+e+" must be a valid Ethereum address";case 15:if(t!=="uint256"||!(isNaN(parseInt(i))||parseInt(i)<0)){l.next=17;break}throw"Value for "+e+" must be a valid number greater or equal to 0";case 17:i=t!=="bool"?i:i+""=="true",u=t==="string"?'"':"",a="holder.set"+t.firstLetterToUpperCase()+'("'+e+'", '+u+i+u+");",f="Setting "+e+" using value "+i,window.sendGeneratedProposal(s.props.element,{title:"Proposal for "+f.firstLetterToLowerCase()},window.context.stateHolderProposalTemplate,[a],[f]);case 22:case"end":return l.stop()}},r,this)}));return t}()};var State=React.createClass({displayName:"State",componentDidMount:function(){this.controller.load()},extractData:function(t){t=$($(t).parent());var n=t.children().find("input");return n.length>1&&(n=t.children().find('input[type="radio"]:checked')),n=n.val(),{stateElement:this.state.stateElements[t[0].dataset.i],value:n,clear:this.state.changeAll&&(t.children().find(".Editing").length>0||t.children(".Editing").length>0)}},changeStateElement:function(t){t&&t.preventDefault&&t.preventDefault(!0),t&&t.stopPropagation&&t.stopPropagation(!0);var n=this;if(n.state.changeAll)return $(t.currentTarget).toggleClass("Editing");var r=n.extractData($($(t.currentTarget).parent()));n.controller[t.currentTarget.innerHTML.toLowerCase()+"StateElement"](r.stateElement,r.value).then(function(){return n.setState({change:null})}).catch(function(e){return n.emit("message",e.message||e,"error")})},changeAll:function(t){t&&t.preventDefault&&t.preventDefault(!0),t&&t.stopPropagation&&t.stopPropagation(!0);var n=this,r=[];$(t.currentTarget).parent().children().find("li").each(function(e,t){return r.push(n.extractData(t.children[0]))}),n.controller.changeAll(r).then(function(){return n.setState({changeAll:n.state&&n.state.changeAll?null:!0,change:null})}).catch(function(e){return n.emit("message",e.message||e,"error")})},onTypeChange:function(t){t&&t.preventDefault&&t.preventDefault(!0),t&&t.stopPropagation&&t.stopPropagation(!0),this.addNewInput&&this.onInputRef(this.addNewInput[0]),this.addNewRadio&&this.onRadioRef(this.addNewRadio[0])},onInputRef:function(t){this.addNewInput=$(t).show().attr("type","text");if(!t||!this.addNewType)return;if(this.addNewType.value==="bool")return this.addNewInput.hide();this.addNewType.value==="uint256"&&this.addNewInput.attr("type","number"),this.addNewType.value==="uint256"&&this.addNewInput.attr("min","0")},onRadioRef:function(t){this.addNewRadio=$(t).show();if(!t||!this.addNewType||this.addNewType.value!=="bool")return this.addNewRadio.hide()},addNew:function(t){t&&t.preventDefault&&t.preventDefault(!0),t&&t.stopPropagation&&t.stopPropagation(!0);var n=this,r=this.addNewName.value,i=this.addNewType.value,s=this.addNewInput.val(),o=this.addNewRadio.children().find('input[type="radio"]:checked').val()==="true";this.controller.addNew(r,i,i==="bool"?o:s).catch(function(e){return n.emit("message",e.message||e,"error")})},renderStateElement:function(t,n){var r=this;return React.createElement("section",{className:"DFOSingleState","data-i":n},React.createElement("div",{className:"DFOSingleStateTN"},React.createElement("h5",{className:"DFOSingleStateN"},t.name),React.createElement("aside",{className:"DFOSingleStateT"},"💾 ",t.type)),r.props.edit&&(!r.state||!r.state.changeAll)&&React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB"+(r.state&&r.state.change===t.name?" Editing":""),href:"javascript:;",onClick:function(){return r.setState({change:r.state&&r.state.change===t.name?null:t.name})}},"Change"),React.createElement("h6",{className:"DFOSingleStateV"},(!r.props.edit||!r.state||r.state.change!==t.name&&!r.state.changeAll)&&(t.type!=="address"?React.createElement("span",null,t.value===!0?"true":t.value===!1?"false":t.value):React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"address/"+t.value,target:"_blank"},t.value)),r.props.edit&&r.state&&(r.state.change===t.name||r.state.changeAll)&&t.type!=="bool"&&React.createElement("input",{type:t.type==="uint256"?"number":"text",min:"0",ref:function(n){return n&&(n.value=t.value)}}),r.props.edit&&r.state&&(r.state.change===t.name||r.state.changeAll)&&t.type==="bool"&&React.createElement("form",null,React.createElement("label",null,React.createElement("input",{name:t.name,type:"radio",value:"true",ref:function(n){return n&&(n.checked=t.value===n.value)}}),"true"),React.createElement("label",null,React.createElement("input",{name:t.name,type:"radio",value:"false",ref:function(n){return n&&(n.checked=t.value===n.value)}}),"false")),r.props.edit&&(!r.state||!r.state.changeAll)&&r.state&&r.state.change===t.name&&React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB",href:"javascript:;",onClick:r.changeStateElement},"Propose"),r.props.edit&&r.state&&(r.state.change===t.name||r.state.changeAll)&&React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB",href:"javascript:;",onClick:r.changeStateElement},"Clear")))},render:function(){var t=this;return React.createElement("section",{className:"DFOOverview"},t.state&&t.state.stateElements&&React.createElement("ul",{className:"DFOStateList"},t.state.stateElements.map(function(e,n){return React.createElement("li",{key:e.name},t.renderStateElement(e,n))})),t.state&&t.state.stateElementsAmount===0&&React.createElement("h2",null,"This DFO does not contain any State Element"),t.state&&t.state.unsupportedRnDVersion&&React.createElement("h2",null,"This R&D version is no longer supported because it is lower than 0.1."),(!t.state||!t.state.stateElements||t.state.stateElements.length!==t.state.stateElementsAmount)&&(!t.state||!t.state.unsupportedRnDVersion)&&React.createElement(LoaderMini,{message:"Loading Elements"}))}});var TokenController=function(t){var n=this;n.view=t};var Token=React.createClass({displayName:"Token",requiredModules:["spa/editor"],requiredScripts:["spa/loaderMini.jsx","spa/okBoomer.jsx","spa/loaderMinimino.jsx","assets/scripts/uniswapOps.js"],uploadFile:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget.files[0],r=this,i=new FileReader;i.addEventListener("load",function(){r.indexValue.value=i.result},!1),i.readAsDataURL(n)},changeElementInfo:function(t){if(!t)return;t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=window.getData($($(t.currentTarget).parent()).parent());this.controller[this.state.change+"Change"](n)},componentDidMount:function(){var t=this;window.blockchainCall(t.props.element.dFO.methods.read,"getMinimumBlockNumberForSurvey","0x").then(function(e){t.props.element.blocks=window.web3.eth.abi.decodeParameters(["uint256"],e)[0],t.forceUpdate()});var n=!t.props.element.logo;t.props.element.logo=t.props.element.logo||t.props.element.logoUri||t.props.element.logoURI,t.props.element.logo&&n&&t.forceUpdate(),!t.props.element.logo&&window.loadLogo(t.props.element.token.options.address).then(function(e){t.props.element.logo=e,t.forceUpdate()}),window.loadUniswapPairs(this,t.props.element.token.options.address)},renderChangeButton:function(t){var n=this;if(!n.props.edit)return;return React.createElement("a",{className:"LinkVisualButton LinkVisualButtonB"+(n.state&&n.state.change===t?" Editing":""),href:"javascript:;",onClick:function(){return n.setState({change:n.state&&n.state.change===t?null:t})}},"Change")},renderChanger:function(t){var n=this;if(!n.props.edit||!n.state||!n.state.change)return;for(var r in t){var i=t[r];if(n.state.change===i){var s=n["render"+i.substring(0,1).toUpperCase()+i.substring(1)+"Changer"];return React.createElement("section",{className:"DFOFunctionIndexIcon"},s&&s(),React.createElement("aside",null,React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualButtonB",onClick:n.changeElementInfo},"Propose")))}}},renderDefaultChanger:function(t,n,r,i){return React.createElement("ul",null,React.createElement("li",null,React.createElement("p",{ref:function(n){return n&&(n.innerHTML=t)}},t)),React.createElement("li",null,React.createElement("section",null,React.createElement("label",{htmlFor:r,ref:function(t){return t&&(t.innerHTML=n)}},n),React.createElement("input",{className:"DFOFunctionIndexIconText",id:r,type:"number",min:"0",ref:function(t){return t&&(t.value=i)}}))))},toggleMintBurn:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.setState({mintBurnMethod:t.currentTarget.dataset.function,mintBurn:this.state&&this.state.mintBurn===t.currentTarget.innerText?null:t.currentTarget.innerText})},render:function(){var t=this,n=this;return React.createElement("section",{className:"DFOOverview"},React.createElement("ul",{className:"DFOHosting DFOHostingY"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Voting Token")),React.createElement("li",{className:"TheDappInfo05 TheDappInfoYY"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("figure",{className:"VerifiedIcon"},React.createElement("img",{src:this.props.element.logoUri?window.formatLink(this.props.element.logoUri):this.props.element.logo})))),React.createElement("li",{className:"TheDappInfo05"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle"},"Name:"),React.createElement(AsyncValue,null,n.props.element.name&&React.createElement("p",{className:"DFOLabelTitleInfo"},React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"token/"+n.props.element.token.options.address,target:"_blank"},n.props.element.name))),React.createElement("h5",{className:"DFOHostingTitle"},"Ticker:"),React.createElement(AsyncValue,null,n.props.element.symbol&&React.createElement("p",{className:"DFOLabelTitleInfo"},React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"token/"+n.props.element.token.options.address,target:"_blank"},n.props.element.symbol))))),React.createElement("li",{className:"TheDappInfo05 TheDappInfoX"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle"},"Voting Power:"),React.createElement(AsyncValue,null,"+1")),React.createElement("section",{className:"DFOTitleSection"})),React.createElement("li",{className:"TheDappInfo1 TheDappInfoX"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle"},"Existing Supply:  "),React.createElement(AsyncValue,null,n.props.element.symbol&&n.props.element.totalSupply&&React.createElement("p",{className:"DFOLabelTitleInfo"},React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"token/tokenholderchart/"+n.props.element.token.options.address,target:"_blank"},window.fromDecimals(n.props.element.totalSupply,n.props.element.decimals)))),React.createElement("h5",{className:"DFOHostingTitle"},"DFO Wallet Supply: "),React.createElement(AsyncValue,null,n.props.element.symbol&&n.props.element.balanceOf&&React.createElement("p",{className:"DFOLabelTitleInfo"}," ",React.createElement("a",{className:"LinkVisualStandard",href:window.getNetworkElement("etherscanURL")+"token/tokenholderchart/"+n.props.element.token.options.address,target:"_blank"},window.fromDecimals(n.props.element.communityTokens,n.props.element.decimals)))),this.props.edit&&React.createElement("a",{href:"javascript:;","data-function":"mintNewTokens",onClick:this.toggleMintBurn,className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"+(this.state&&this.state.mintBurn==="Mint"?"EditDFOYo Editing":"")},"Mint"),this.props.edit&&React.createElement("a",{href:"javascript:;","data-function":"burn",onClick:this.toggleMintBurn,className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"+(this.state&&this.state.mintBurn==="Burn"?"EditDFOYo Editing":"")},"Burn"),this.props.edit&&this.state&&this.state.mintBurn&&React.createElement("section",{className:"BravPicciot"},React.createElement("label",null,React.createElement("p",null,"Propose to ",this.state.mintBurn),React.createElement("input",{type:"text",placeholder:"Amount",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$",min:"0",ref:function(n){return t.input=n}})),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB",onClick:function(){return window[t.state.mintBurnMethod](t,t.input.value)}},this.state.mintBurn)))),React.createElement("li",{className:"TheDappInfo025"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("a",{href:window.context.uniSwapInfoURL+this.props.element.token.options.address,target:"_blank",className:"LinkVisualButton LinkVisualUni"},"🦄 Info"),React.createElement("a",{href:window.context.uniSwapSwapURLTemplate.format(n.props.element.token.options.address,""),target:"_blank",className:"LinkVisualButton LinkVisualUni"},"🦄 Swap"),React.createElement("a",{href:window.context.penSwapSwapURLTemplate.format(n.props.element.token.options.address,""),target:"_blank",className:"LinkVisualButton LinkVisualUni LinkVisualUniPEN"},"🐧 Swap"),React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"token/"+n.props.element.token.options.address,target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"💎 Info"),React.createElement("a",{href:window.getNetworkElement("etherscanURL")+"address/"+n.props.element.token.options.address+"#code",target:"_blank",className:"LinkVisualButton LinkVisualEthscan"},"💎 Contract")))),React.createElement("ul",{className:"DFOHosting"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,"Dex Liquidity")),!this.state||!this.state.uniswapPairs&&React.createElement(LoaderMinimino,null),this.state&&this.state.uniswapPairs&&this.state.uniswapPairs.length===0&&React.createElement("p",null,"No Uniswap V2 pair found"),this.state&&this.state.uniswapPairs&&this.state.uniswapPairs.filter(function(e){return e!==undefined&&e!==null&&e.pairToken!==undefined&&e.pairToken!==null}).map(function(e){return React.createElement("li",{key:e.pairToken.options.address,className:"TheDappInfo1 TheDappInfoY TheDappInfoSub"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("h5",{className:"DFOHostingTitle"},"🦄 V2 ",React.createElement("b",null,n.props.element.symbol," - ",e.symbol)),React.createElement("span",{className:"DFOLabelTitleInfosmall"},window.fromDecimals(e.mainReserve,n.props.element.decimals)," ",n.props.element.symbol)," ","-"," ",React.createElement("span",{className:"DFOLabelTitleInfosmall"}," ",window.fromDecimals(e.otherReserve,e.decimals)," ",e.symbol),!1,React.createElement("br",null),React.createElement("a",{href:window.context.uniSwapSwapURLTemplate.format(n.props.element.token.options.address,e.address===window.wethAddress?"":e.address),target:"_blank",className:"LinkVisualButton LinkVisualUni"},"🦄 Swap"),React.createElement("a",{href:window.context.penSwapSwapURLTemplate.format(n.props.element.token.options.address,e.address===window.wethAddress?"":e.address),target:"_blank",className:"LinkVisualButton LinkVisualUni LinkVisualUniPEN"},"🐧 Swap"),React.createElement("a",{href:window.context.uniSwapPoolURLTemplate.format(n.props.element.token.options.address,e.address===window.wethAddress?"":e.address),target:"_blank",className:"LinkVisualButton LinkVisualUni"},"🦄 Pool")))})))}});var TokenPickerController=function(t){var n=this;n.view=t};var TokenPicker=React.createClass({displayName:"TokenPicker",onType:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.onTypeTimeout&&clearTimeout(this.onTypeTimeout);var n=this,r=t.currentTarget,i=r.value;this.onTypeTimeout=setTimeout(function(){n.setState({search:i,selected:null},function(){n.props.tokenAddress&&window.isEthereumAddress(n.state.search)&&window.loadUniswapPairs(n,n.props.tokenAddress,n.state.search)})},600)},toggle:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);if(t.relatedTarget&&t.relatedTarget.tagName==="INPUT")return;if(t.type==="click"||t.type==="blur"&&t.relatedTarget&&t.relatedTarget.tagName==="A"&&t.relatedTarget.dataset.item){var n=this,r=JSON.parse((t.type==="click"?t.currentTarget:t.relatedTarget).dataset.item);this.input.value=r.address,this.setState({selected:r,show:null,search:null},function(){n.props.onChange&&n.props.onChange(r)});return}t.type==="blur"&&this.setState({show:null});if(this.state&&this.state.show&&(t.type==="focus"||t.relatedTarget!==undefined&&t.relatedTarget!==null))return;((!this.state||!this.state.show)&&t.type==="focus"||this.state&&this.state.show&&t.type==="blur")&&this.setState({show:t.type==="focus"})},getList:function(){var t=this;if(!this.state||!this.state.uniswapPairs)return null;var n=this.props.tokenAddress?Object.values(window.loadedUniswapPairs).map(function(e){return e.token0.address!==t.props.tokenAddress?e.token0:e.token1}):this.state.uniswapPairs;if(!this.state.search)return n;var r=[],i=this.state.search.trim().toLowerCase();for(var s=n,o=Array.isArray(s),u=0,s=o?s:s[Symbol.iterator]();;){var a;if(o){if(u>=s.length)break;a=s[u++]}else{u=s.next();if(u.done)break;a=u.value}var f=a;(f.address.trim().toLowerCase().indexOf(i)!==-1||f.name.trim().toLowerCase().indexOf(i)!==-1||f.symbol.trim().toLowerCase().indexOf(i)!==-1)&&r.push(f)}return r},componentDidMount:function(){this.props.tokenAddress&&window.loadUniswapPairs(this,this.props.tokenAddress);var t=this;this.props.element&&window.loadWallets(t.props.element,function(e){return t.setState({uniswapPairs:e})},!0)},cloneToken:function(t){var n={};return Object.entries(t).forEach(function(e){return e[0]!=="token"&&(n[e[0]]=e[1])}),JSON.stringify(n)},renderSelection:function(){var t=this,n,r,i=this.getList();return React.createElement("section",{className:"PikaPikaYaYa",tabindex:"-1",onBlur:this.toggle},React.createElement("section",{className:"PikaPikaSearch"},React.createElement("input",{onFocus:this.toggle,ref:function(n){return(t.input=n)&&(n.value=t.state&&t.state.search||"")},type:"text",placeholder:"Search Name/Address",onKeyUp:this.onType,onChange:this.onType})),React.createElement("section",{className:"PikaPikaFind"},!i||i.length==0&&((n=this.state)==null?void 0:n.loadingUniswapPairs)&&React.createElement("h4",null,"Loading tokens..."),i&&i.length===0&&((r=this.state)==null?!void 0:!r.loadingUniswapPairs)&&React.createElement("h4",null,"No results found"),i&&i.map(function(e){return React.createElement("a",{className:"PikaPikaFindaaaaaaaaa",key:e.address,onClick:t.toggle,href:"javascript:;","data-item":t.cloneToken(e)},React.createElement("img",{src:e.logo}),React.createElement("p",null,e.name," (",e.symbol,")"))})))},render:function(){return this.state&&this.state.show?this.renderSelection():React.createElement("section",{tabindex:"-1",onFocus:this.toggle},(!this.state||!this.state.selected)&&React.createElement("section",null,React.createElement("a",{className:"tokenpickerSelector",href:"javascript:;"},"Select")),this.state&&this.state.selected&&React.createElement("section",{className:"PikaPikaSelectedBoomer"},React.createElement("img",{src:this.state.selected.logo}),React.createElement("p",null,this.state.selected.name," ",React.createElement("b",null,"(",this.state.selected.symbol,")"))))}});function _instanceof(e,t){return t!=null&&typeof Symbol!="undefined"&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}var UniswapTokenPicker=React.createClass({displayName:"UniswapTokenPicker",getDefaultSubscriptions:function(){var t=this;return{"ethereum/update":function(){return t.setState({key:null,selected:null})}}},onSectionChange:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=t.currentTarget.dataset.key,r=this;this.setState({key:n,selected:null},function(){r.props.onChange&&setTimeout(function(){return r.props.onChange(null)})})},close:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.setState({opened:null})},open:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this;if(n.props.readOnly)return;var r=t.currentTarget;this.setState({opened:!0},function(){n.opened&&(n.opened.onblur=n.opened.onblur||function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),t.relatedTarget&&t.relatedTarget!==r&&t.relatedTarget.click(),t.relatedTarget&&t.relatedTarget!==r&&n.opened&&n.opened.focus(),(!t.relatedTarget||t.relatedTarget!==r&&!t.relatedTarget.dataset.key)&&n.setState({opened:null})})&&n.opened.focus()})},onClick:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this;this.setState({opened:null,key:this.getKey(),selected:parseInt(t.currentTarget.dataset.index)},function(){n.props.onChange&&setTimeout(function(){return n.props.onChange(n.props.tokensList[n.state.key][n.state.selected])})})},getKey:function(){var t=null;try{t=this.state&&this.state.key||Object.keys(this.props.tokensList)[0]}catch(n){}return t},exceptFor:function(t){if(this.props.exceptFor&&this.props.exceptFor.length>0){if(typeof this.props.exceptFor=="string"&&window.web3.utils.toChecksumAddress(t)===window.web3.utils.toChecksumAddress(this.props.exceptFor))return!0;if(_instanceof(this.props.exceptFor,Array))for(var n=this.props.exceptFor,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();;){var s;if(r){if(i>=n.length)break;s=n[i++]}else{i=n.next();if(i.done)break;s=i.value}var o=s;if(window.web3.utils.toChecksumAddress(t)===window.web3.utils.toChecksumAddress(o))return!0}}return!1},renderOpened:function(){var t=this,n=this,r=this.getKey();return React.createElement("section",{className:"BazSelectorContainer",tabIndex:"-1",ref:function(n){return t.opened=n}},React.createElement("section",{className:"BazSelectorContainerMenu"},React.createElement("section",{className:"BazSelectorContainerMenuintern"},this.props.tokensList&&Object.keys(this.props.tokensList).map(function(e){return React.createElement("li",{key:e,className:r===e?"Selected":undefined},React.createElement("a",{href:"javascript;","data-key":e,onClick:n.onSectionChange},e))}))),r&&React.createElement("section",{className:"BazSelectorContainerObjects"},this.props.tokensList[r].map(function(e,r){if(!e||n.exceptFor(e.address))return;return React.createElement("li",{key:e.address,className:t.state.selected===r?"Selected":undefined},t.renderInput(e,t.onClick,r))})))},renderInput:function(t,n,r){var i=this.getKey();return React.createElement("a",{href:"javascript;","data-index":r,onClick:n},i!=="Indexes"&&React.createElement("img",{width:"20",src:t.logo||t.logoURI||window.context.trustwalletImgURLTemplate.format(t.address)}),React.createElement("p",null,t.symbol))},renderClosed:function(){var t=undefined;try{t=this.props.tokensList[this.state.key][this.state.selected]}catch(n){}return React.createElement("section",null,t&&this.renderInput(t,this.open),!t&&React.createElement("a",{href:"javascript:;",onClick:this.open},"Select"))},render:function(){return React.createElement("section",{className:"BazTokenSelector"},this.state&&this.state.opened&&this.renderOpened(),(!this.state||!this.state.opened)&&this.renderClosed())}});var WalletController=function(t){var n=this;n.view=t,n.pairCreatedTopic=window.web3.utils.sha3("PairCreated(address,address,address,uint256)"),n.transferTopic=window.web3.utils.sha3("Transfer(address,address,uint256)"),n.loadWallets=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n.view.setState({tokens:null,cumulativeAmountDollar:null,tokenAmounts:null,loading:!0}),i.prev=1,i.next=4,window.loadOffChainWallets();case 4:e=i.sent,t=[{i:0,address:window.voidEthereumAddress,name:"Ethereum",symbol:"ETH",decimals:"18",logo:"assets/img/eth-logo.png"}],Object.values(e).forEach(function(e){e.forEach(function(e){try{e.i=t.length,t.push(e)}catch(n){}})}),n.view.setState({tokens:t}),i.next=14;break;case 10:return i.prev=10,i.t0=i["catch"](1),i.next=14,window.loadWallets(n.view.props.element,function(e){return n.view.setState({tokens:e})});case 14:n.view.state.tokens&&n.view.setState({tokenAmounts:n.view.state.tokens.map(function(e){return{i:e.i,amount:"0",amountDollars:0}})}),n.view.state.tokens&&n.calculateAmounts();case 16:case"end":return i.stop()}},r,this,[[1,10]])}));return t}(),n.calculateAmounts=function(){function t(){return e.apply(this,arguments)}var e=_asyncToGenerator(regeneratorRuntime.mark(function r(){var e,t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return e=0,t=n.view.state&&n.view.state.tokens||[],i=n.view.state&&n.view.state.tokenAmounts||[],x.next=5,window.getEthereumPrice();case 5:s=x.sent;if(n.view.mounted){x.next=8;break}return x.abrupt("return");case 8:return x.prev=8,x.next=11,window.web3.eth.getBalance(n.view.props.element.walletAddress);case 11:i[0].amount=x.sent;if(n.view.mounted){x.next=14;break}return x.abrupt("return");case 14:x.next=19;break;case 16:x.prev=16,x.t0=x["catch"](8),i[0].amount="0";case 19:e+=i[0].amountDollars=s*parseFloat(window.fromDecimals(i[0].amount,18,!0)),o=t.filter(function(e){return e!==!0&&e!==!1}).map(function(e){return window.web3.utils.toChecksumAddress(e.address)}),u=window.toSubArrays(o),a=u,f=Array.isArray(a),l=0,a=f?a:a[Symbol.iterator]();case 23:if(!f){x.next=29;break}if(!(l>=a.length)){x.next=26;break}return x.abrupt("break",93);case 26:c=a[l++],x.next=33;break;case 29:l=a.next();if(!l.done){x.next=32;break}return x.abrupt("break",93);case 32:c=l.value;case 33:return h=c,x.next=36,window.getLogs({address:h,topics:[n.transferTopic,[],window.web3.eth.abi.encodeParameter("address",n.view.props.element.walletAddress)],fromBlock:n.view.props.element.startBlock,toBlock:"latest"});case 36:p=x.sent;if(n.view.mounted){x.next=39;break}return x.abrupt("return");case 39:d=function(t,n,r){return r.indexOf(t)===n},v=p.map(function(e){return window.web3.utils.toChecksumAddress(e.address)}).filter(d),m=v,g=Array.isArray(m),y=0,m=g?m:m[Symbol.iterator]();case 42:if(!g){x.next=48;break}if(!(y>=m.length)){x.next=45;break}return x.abrupt("break",91);case 45:b=m[y++],x.next=52;break;case 48:y=m.next();if(!y.done){x.next=51;break}return x.abrupt("break",91);case 51:b=y.value;case 52:w=b;if(n.view.mounted){x.next=55;break}return x.abrupt("return");case 55:E=t.filter(function(e){return e!==!0&&e!==!1&&window.web3.utils.toChecksumAddress(e.address)===w})[0],S=i[E.i],x.prev=57;if(E.address!==window.voidEthereumAddress){x.next=64;break}return x.next=61,window.web3.eth.getBalance(n.view.props.element.walletAddress);case 61:x.t1=x.sent,x.next=67;break;case 64:return x.next=66,window.blockchainCall(E.token.methods.balanceOf,n.view.props.element.walletAddress);case 66:x.t1=x.sent;case 67:S.amount=x.t1;if(n.view.mounted){x.next=70;break}return x.abrupt("return");case 70:if(E.address!==window.voidEthereumAddress){x.next=74;break}x.t2="1",x.next=79;break;case 74:return x.t3=window,x.next=77,window.blockchainCall(window.uniswapV2Router.methods.getAmountsOut,window.toDecimals("1",E.decimals),[E.address,window.wethAddress]);case 77:x.t4=x.sent[1],x.t2=x.t3.fromDecimals.call(x.t3,x.t4,18,!0);case 79:S.amountDollars=x.t2;if(n.view.mounted){x.next=82;break}return x.abrupt("return");case 82:S.amountDollars=parseFloat(window.fromDecimals(S.amount,E.decimals,!0))*parseFloat(S.amountDollars)*s,x.next=87;break;case 85:x.prev=85,x.t5=x["catch"](57);case 87:e+=S.amountDollars,n.view.setState({cumulativeAmountDollar:e,tokenAmounts:i});case 89:x.next=42;break;case 91:x.next=23;break;case 93:n.view.setState({cumulativeAmountDollar:e,tokenAmounts:i,loading:!1});case 94:case"end":return x.stop()}},r,this,[[8,16],[57,85]])}));return t}()};var Wallet=React.createClass({displayName:"Wallet",requiredScripts:["spa/loaderMinimino.jsx","assets/scripts/uniswapOps.js"],requiredModules:["spa/tokenPicker"],componentDidMount:function(){if(this.called)return;this.called=!0,this.controller.loadWallets()},toggleProposal:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=this,r=t&&t.currentTarget.dataset.address,i=t&&t.currentTarget.dataset.type,s=this.state&&this.state[i+"Proposal"];this.setState({swapProposal:null,poolProposal:null,transferProposal:null},function(){if(!r||!i||s===r)return;var e={tos:[]};e[i+"Proposal"]=r,n.setState(e)})},renderSwapProposal:function(t){var n=this;return React.createElement("section",{className:"BravPicciot"},React.createElement("p",null,"Propose to swap:"),React.createElement("label",null,React.createElement("input",{ref:function(t){return n.amount=t},type:"text",placeholder:"0.0",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$"}),React.createElement("span",null,t.symbol)),React.createElement("label",null,React.createElement("p",null,"for:"),React.createElement(TokenPicker,{ref:function(t){return n.tokenPicker=t},tokenAddress:t.address===window.voidEthereumAddress?window.wethAddress:t.address})),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB LinkVisualButtonBIGGA",onClick:function(){return window.swap(n,n.amount.value,t.address,n.tokenPicker.state&&n.tokenPicker.state.selected&&n.tokenPicker.state.selected.address)}},"Swap"))},addTos:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0),this.emit("message");var n=this.to.value;if(!window.isEthereumAddress(n))return this.emit("message","You must insert a valid ethereum address","error");var r=window.formatMoney(this.amount.value.split(",").join(""));if(parseFloat(r.split(",").join(""))<=0)return this.emit("message","Amount must be greater than zero","error");var i=this.state&&this.state.tos||[];i.push({address:n,amount:r});var s=this;s.setState({tos:i},function(){s.amount.value="",s.to.value=""})},deleteTo:function(t){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var n=parseInt(t.currentTarget.dataset.index),r=this.state.tos[n];this.state.tos.splice(n,1);var i=this;i.setState({tos:this.state.tos},function(){i.amount.value=r.amount,i.to.value=r.address})},transfer:function(t,n){t&&t.preventDefault&&t.preventDefault(!0)&&t.stopPropagation&&t.stopPropagation(!0);var r=[],i=[];this.emit("message");if(this.state.tos.length===0)return this.emit("message","You Must insert at least a recipient","error");this.state.tos.forEach(function(e){r.push(e.amount),i.push(e.address)}),window.transfer(this,n.address,r,i)},renderTransferProposal:function(t){var n=this,r=this;return React.createElement("section",{className:"BravPicciot"},React.createElement("p",null,"Propose to Transfer:"),React.createElement("section",null,React.createElement("label",null,React.createElement("input",{ref:function(t){return n.amount=t},type:"text",placeholder:"Amount",spellcheck:"false",autocomplete:"off",autocorrect:"off",inputmode:"decimal",pattern:"^[0-9][.,]?[0-9]$"}),React.createElement("span",null,t.symbol))),React.createElement("section",null,React.createElement("label",null,React.createElement("span",null,"To:"),React.createElement("input",{className:"MarioTorginiProposal",ref:function(t){return n.to=t},type:"text",placeholder:"Address"}))),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonG LinkVisualButtonBIGGA",onClick:this.addTos},"Add"),this.state&&this.state.tos&&React.createElement("section",null,this.state.tos.map(function(e,n){return React.createElement("section",{className:"DFOHostingTag",key:e.address+"_"+e.amount},React.createElement("a",{className:"ChiudiQuella ChiudiQuellaGigi",href:"javascript:;","data-index":n,onClick:r.deleteTo},"X"),React.createElement("p",null,"Send ",React.createElement("b",null,e.amount)," ",t.symbol),React.createElement("p",null,"to ",React.createElement("aside",{className:"LuiQuelloLi"},e.address)))})),React.createElement("a",{href:"javascript:;",className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB LinkVisualButtonBIGGA",onClick:function(r){return n.transfer(r,t)}},"Transfer"),!1)},render:function(){var t=this;return React.createElement("section",{className:"DFOOverview"},React.createElement("ul",{className:"DFOHosting"},React.createElement("section",{className:"HostingCategoryTitle"},React.createElement("h2",null,t.props.element.name," Balances ",!t.state||t.state.cumulativeAmountDollar===undefined||t.state.cumulativeAmountDollar===null?React.createElement(LoaderMinimino,null):React.createElement("span",null,"(Tracked: $",window.formatMoney(t.state.cumulativeAmountDollar),")")," ",React.createElement("a",{className:"LinkVisualButton LinkVisualEthscan",target:"_blank",href:window.getNetworkElement("etherscanURL")+"tokenHoldings?a="+t.props.element.walletAddress},"💎 Etherscan"))),t.state&&t.state.tokenAmounts&&t.state.tokens&&t.state.tokens.map(function(e){return t.state.tokenAmounts[e.i].amount!==undefined&&t.state.tokenAmounts[e.i].amount!=="0"&&React.createElement("li",{key:e.address,className:"TheDappInfo1 TheDappInfoY TheDappInfoSub"},React.createElement("section",{className:"DFOTitleSection"},React.createElement("section",{className:"DFOWalletBalanceSingleT"},React.createElement("img",{src:e.logo,alt:e.symbol.substring(0,1).toUpperCase()}),React.createElement("h3",null,e.symbol," ",t.state.tokenAmounts[e.i].amountDollars===undefined?React.createElement(LoaderMinimino,null):t.state.tokenAmounts[e.i].amountDollars?React.createElement("span",{className:"DFOLabelTitleInfosmall"}," ($",window.formatMoney(t.state.tokenAmounts[e.i].amountDollars),")"):undefined)),t.state.tokenAmounts[e.i].amount!==undefined&&React.createElement("h5",{className:"DFOLabelTitleInfoM"},React.createElement("b",null,window.fromDecimals(t.state.tokenAmounts[e.i].amount,e.decimals))),t.state.tokenAmounts[e.i].amount===undefined&&React.createElement(LoaderMinimino,null),React.createElement("br",null),t.props.edit&&React.createElement("a",{href:"javascript:;","data-address":e.address,"data-type":"swap",onClick:t.toggleProposal,className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"+(t.state&&t.state.swapProposal===e.address?"EditDFOYo Editing":"")},"Swap"),t.props.edit&&React.createElement("a",{href:"javascript:;","data-address":e.address,"data-type":"transfer",onClick:t.toggleProposal,className:"LinkVisualButton LinkVisualPropose LinkVisualButtonB"+(t.state&&t.state.transferProposal===e.address?"EditDFOYo Editing":"")},"Transfer"),t.state&&t.state.swapProposal===e.address&&t.renderSwapProposal(e),t.state&&t.state.poolProposal===e.address&&t.renderPoolProposal(e),t.state&&t.state.transferProposal===e.address&&t.renderTransferProposal(e)))}),this.state&&this.state.loading&&React.createElement("section",null,React.createElement("br",null),React.createElement(LoaderMinimino,null))))}});var WalletEnablerButton=React.createClass({displayName:"WalletEnablerButton",getDefaultSubscriptions:function(){return{"ethereum/ping":this.forceUpdate}},onClick:function(t){var n=t,r=t.target,i=this;if(window.walletAddress)return i.props.onClick&&i.props.onClick.apply(i.domRoot.parent().findReactComponent(),[t]);window.ethereum.enable().then(function(){n.target=r;try{var e=i.props.onUnlock?i.props.onUnlock==="false"?undefined:i.props.onUnlock:i.props.onClick;e=e&&e.apply(i.domRoot.parent().findReactComponent(),[t]);if(e&&e.then)return e.then(function(){return i.forceUpdate()}).catch(console.error);if(!e)try{n&&n.preventDefault(!0)&&n.stopPropagation(!0)}catch(t){}}catch(t){console.error(t)}i.forceUpdate()}).catch(function(){})},render:function(){var t=this,n=this;if(!window.walletAddress||!this.props.childOnly){var r=React.createElement("a",{ref:function(n){return t.props.ref&&t.props.ref(n)},className:!window.walletAddress&&this.props.inactiveClassName||this.props.className,onClick:this.onClick,href:"javascript:;",type:"button"},!window.walletAddress&&this.props.inactiveText||this.props.children);return r.props=r.props||{},Object.keys(this.props).forEach(function(e){e.indexOf("data-")===0&&(r.props[e]=n.props[e])}),r}return this.props.children}});